Search.setIndex({docnames:["index","torchrec","torchrec.datasets","torchrec.datasets.scripts","torchrec.distributed","torchrec.distributed.planner","torchrec.examples","torchrec.examples.dlrm","torchrec.examples.dlrm.data","torchrec.examples.dlrm.modules","torchrec.fx","torchrec.models","torchrec.modules","torchrec.optim","torchrec.quant","torchrec.sparse"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,sphinx:56},filenames:["index.rst","torchrec.rst","torchrec.datasets.rst","torchrec.datasets.scripts.rst","torchrec.distributed.rst","torchrec.distributed.planner.rst","torchrec.examples.rst","torchrec.examples.dlrm.rst","torchrec.examples.dlrm.data.rst","torchrec.examples.dlrm.modules.rst","torchrec.fx.rst","torchrec.models.rst","torchrec.modules.rst","torchrec.optim.rst","torchrec.quant.rst","torchrec.sparse.rst"],objects:{"":[[1,0,0,"-","torchrec"]],"torchrec.datasets":[[2,0,0,"-","criteo"],[2,0,0,"-","movielens"],[2,0,0,"-","random"],[3,0,0,"-","scripts"],[2,0,0,"-","utils"]],"torchrec.datasets.criteo":[[2,1,1,"","BinaryCriteoUtils"],[2,1,1,"","CriteoIterDataPipe"],[2,1,1,"","InMemoryBinaryCriteoIterDataPipe"],[2,3,1,"","criteo_kaggle"],[2,3,1,"","criteo_terabyte"]],"torchrec.datasets.criteo.BinaryCriteoUtils":[[2,2,1,"","get_file_idx_to_row_range"],[2,2,1,"","get_shape_from_npy"],[2,2,1,"","load_npy_range"],[2,2,1,"","tsv_to_npys"]],"torchrec.datasets.movielens":[[2,3,1,"","movielens_20m"],[2,3,1,"","movielens_25m"]],"torchrec.datasets.random":[[2,1,1,"","RandomRecDataset"]],"torchrec.datasets.scripts":[[3,0,0,"-","preprocess_criteo"]],"torchrec.datasets.scripts.preprocess_criteo":[[3,3,1,"","main"],[3,3,1,"","parse_args"]],"torchrec.datasets.utils":[[2,1,1,"","Batch"],[2,1,1,"","Limit"],[2,1,1,"","LoadFiles"],[2,1,1,"","ParallelReadConcat"],[2,1,1,"","ReadLinesFromCSV"],[2,3,1,"","idx_split_train_val"],[2,3,1,"","rand_split_train_val"],[2,3,1,"","safe_cast"],[2,3,1,"","train_filter"],[2,3,1,"","val_filter"]],"torchrec.datasets.utils.Batch":[[2,4,1,"","dense_features"],[2,4,1,"","labels"],[2,2,1,"","pin_memory"],[2,2,1,"","record_stream"],[2,4,1,"","sparse_features"],[2,2,1,"","to"]],"torchrec.distributed":[[4,0,0,"-","collective_utils"],[4,0,0,"-","comm"],[4,0,0,"-","comm_ops"],[4,0,0,"-","cw_sharding"],[4,0,0,"-","dist_data"],[4,0,0,"-","dp_sharding"],[4,0,0,"-","embedding"],[4,0,0,"-","embedding_lookup"],[4,0,0,"-","embedding_sharding"],[4,0,0,"-","embedding_types"],[4,0,0,"-","embeddingbag"],[4,0,0,"-","grouped_position_weighted"],[4,0,0,"-","model_parallel"],[5,0,0,"-","planner"],[4,0,0,"-","quant_embeddingbag"],[4,0,0,"-","rw_sharding"],[4,0,0,"-","train_pipeline"],[4,0,0,"-","tw_sharding"],[4,0,0,"-","twcw_sharding"],[4,0,0,"-","twrw_sharding"],[4,0,0,"-","types"],[4,0,0,"-","utils"]],"torchrec.distributed.collective_utils":[[4,3,1,"","invoke_on_rank_and_broadcast_result"],[4,3,1,"","is_leader"],[4,3,1,"","run_on_leader"]],"torchrec.distributed.comm":[[4,3,1,"","get_group_rank"],[4,3,1,"","get_local_rank"],[4,3,1,"","get_local_size"],[4,3,1,"","get_num_groups"],[4,3,1,"","intra_and_cross_node_pg"]],"torchrec.distributed.comm_ops":[[4,1,1,"","All2AllPooledInfo"],[4,1,1,"","All2AllSequenceInfo"],[4,1,1,"","All2AllVInfo"],[4,1,1,"","All2All_Pooled_Req"],[4,1,1,"","All2All_Pooled_Wait"],[4,1,1,"","All2All_Seq_Req"],[4,1,1,"","All2All_Seq_Req_Wait"],[4,1,1,"","All2Allv_Req"],[4,1,1,"","All2Allv_Wait"],[4,1,1,"","ReduceScatterInfo"],[4,1,1,"","ReduceScatter_Req"],[4,1,1,"","ReduceScatter_Wait"],[4,1,1,"","Request"],[4,3,1,"","alltoall_pooled"],[4,3,1,"","alltoall_sequence"],[4,3,1,"","alltoallv"],[4,3,1,"","reduce_scatter_pooled"],[4,3,1,"","set_gradient_division"]],"torchrec.distributed.comm_ops.All2AllPooledInfo":[[4,4,1,"id0","B_local"],[4,4,1,"id1","D"],[4,4,1,"id2","cumsum_dim_sum_per_rank_tensor"],[4,4,1,"id3","dim_sum_per_rank"],[4,4,1,"id4","dim_sum_per_rank_tensor"],[4,4,1,"id5","mixed_dim"]],"torchrec.distributed.comm_ops.All2AllSequenceInfo":[[4,4,1,"id6","backward_recat_tensor"],[4,4,1,"id7","embedding_dim"],[4,4,1,"id8","forward_recat_tensor"],[4,4,1,"id9","input_splits"],[4,4,1,"id10","lengths_after_sparse_data_all2all"],[4,4,1,"","lengths_sparse_before_features_all2all"],[4,4,1,"id11","output_splits"],[4,4,1,"","permuted_lengths_after_sparse_data_all2all"]],"torchrec.distributed.comm_ops.All2AllVInfo":[[4,4,1,"id12","B_global"],[4,4,1,"id13","B_local"],[4,4,1,"id14","B_local_list"],[4,4,1,"id15","D_local_list"],[4,4,1,"","dim_sum_per_rank"],[4,4,1,"","dims_sum_per_rank"],[4,4,1,"id16","input_split_sizes"],[4,4,1,"id17","output_split_sizes"]],"torchrec.distributed.comm_ops.All2All_Pooled_Req":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.comm_ops.All2All_Pooled_Wait":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.comm_ops.All2All_Seq_Req":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.comm_ops.All2All_Seq_Req_Wait":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.comm_ops.All2Allv_Req":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.comm_ops.All2Allv_Wait":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.comm_ops.ReduceScatterInfo":[[4,4,1,"id18","input_sizes"]],"torchrec.distributed.comm_ops.ReduceScatter_Req":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.comm_ops.ReduceScatter_Wait":[[4,2,1,"","backward"],[4,2,1,"","forward"]],"torchrec.distributed.cw_sharding":[[4,1,1,"","CwEmbeddingSharding"]],"torchrec.distributed.cw_sharding.CwEmbeddingSharding":[[4,2,1,"","create_train_pooled_output_dist"],[4,2,1,"","embedding_dims"],[4,2,1,"","embedding_names"]],"torchrec.distributed.dist_data":[[4,1,1,"","KJTAllToAll"],[4,1,1,"","KJTAllToAllIndicesAwaitable"],[4,1,1,"","KJTAllToAllLengthsAwaitable"],[4,1,1,"","KJTOneToAll"],[4,1,1,"","PooledEmbeddingsAllToAll"],[4,1,1,"","PooledEmbeddingsAllToOne"],[4,1,1,"","PooledEmbeddingsAwaitable"],[4,1,1,"","PooledEmbeddingsReduceScatter"],[4,1,1,"","SequenceEmbeddingAllToAll"],[4,1,1,"","SequenceEmbeddingsAwaitable"]],"torchrec.distributed.dist_data.KJTAllToAll":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dist_data.KJTOneToAll":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dist_data.PooledEmbeddingsAllToAll":[[4,5,1,"","callbacks"],[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dist_data.PooledEmbeddingsAllToOne":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dist_data.PooledEmbeddingsAwaitable":[[4,5,1,"","callbacks"]],"torchrec.distributed.dist_data.PooledEmbeddingsReduceScatter":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dist_data.SequenceEmbeddingAllToAll":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dp_sharding":[[4,1,1,"","DpEmbeddingSharding"],[4,1,1,"","DpPooledEmbeddingDist"],[4,1,1,"","DpSequenceEmbeddingDist"],[4,1,1,"","DpSparseFeaturesDist"]],"torchrec.distributed.dp_sharding.DpEmbeddingSharding":[[4,2,1,"","create_infer_input_dist"],[4,2,1,"","create_infer_lookup"],[4,2,1,"","create_infer_pooled_output_dist"],[4,2,1,"","create_train_input_dist"],[4,2,1,"","create_train_lookup"],[4,2,1,"","create_train_pooled_output_dist"],[4,2,1,"","create_train_sequence_output_dist"],[4,2,1,"","embedding_dims"],[4,2,1,"","embedding_names"],[4,2,1,"","embedding_shard_metadata"],[4,2,1,"","id_list_feature_names"],[4,2,1,"","id_score_list_feature_names"]],"torchrec.distributed.dp_sharding.DpPooledEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dp_sharding.DpSequenceEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.dp_sharding.DpSparseFeaturesDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.embedding":[[4,1,1,"","EmbeddingCollectionAwaitable"],[4,1,1,"","EmbeddingCollectionContext"],[4,1,1,"","EmbeddingCollectionSharder"],[4,1,1,"","ShardedEmbeddingCollection"],[4,3,1,"","create_embedding_sharding"]],"torchrec.distributed.embedding.EmbeddingCollectionContext":[[4,2,1,"","record_stream"],[4,4,1,"","sharding_contexts"]],"torchrec.distributed.embedding.EmbeddingCollectionSharder":[[4,5,1,"","module_type"],[4,2,1,"","shard"],[4,2,1,"","shardable_parameters"]],"torchrec.distributed.embedding.ShardedEmbeddingCollection":[[4,2,1,"","compute"],[4,2,1,"","compute_and_output_dist"],[4,2,1,"","create_context"],[4,5,1,"","fused_optimizer"],[4,2,1,"","input_dist"],[4,2,1,"","load_state_dict"],[4,2,1,"","named_buffers"],[4,2,1,"","named_modules"],[4,2,1,"","named_parameters"],[4,2,1,"","output_dist"],[4,2,1,"","sharded_parameter_names"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"],[4,4,1,"","training"]],"torchrec.distributed.embedding_lookup":[[4,1,1,"","GroupedEmbeddingsLookup"],[4,1,1,"","GroupedPooledEmbeddingsLookup"],[4,1,1,"","InferGroupedPooledEmbeddingsLookup"]],"torchrec.distributed.embedding_lookup.GroupedEmbeddingsLookup":[[4,2,1,"","forward"],[4,2,1,"","load_state_dict"],[4,2,1,"","named_buffers"],[4,2,1,"","named_parameters"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"],[4,4,1,"","training"]],"torchrec.distributed.embedding_lookup.GroupedPooledEmbeddingsLookup":[[4,2,1,"","forward"],[4,2,1,"","load_state_dict"],[4,2,1,"","named_buffers"],[4,2,1,"","named_parameters"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"],[4,4,1,"","training"]],"torchrec.distributed.embedding_lookup.InferGroupedPooledEmbeddingsLookup":[[4,2,1,"","forward"],[4,2,1,"","load_state_dict"],[4,2,1,"","named_buffers"],[4,2,1,"","named_parameters"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"],[4,4,1,"","training"]],"torchrec.distributed.embedding_sharding":[[4,1,1,"","BasePooledEmbeddingDist"],[4,1,1,"","BaseSequenceEmbeddingDist"],[4,1,1,"","BaseSparseFeaturesDist"],[4,1,1,"","EmbeddingSharding"],[4,1,1,"","ListOfSparseFeaturesListAwaitable"],[4,1,1,"","SequenceShardingContext"],[4,1,1,"","SparseFeaturesAllToAll"],[4,1,1,"","SparseFeaturesIndices"],[4,1,1,"","SparseFeaturesLengths"],[4,1,1,"","SparseFeaturesListAwaitable"],[4,1,1,"","SparseFeaturesListIndicesAwaitable"],[4,1,1,"","SparseFeaturesOneToAll"],[4,3,1,"","bucketize_kjt_before_all2all"],[4,3,1,"","group_tables"]],"torchrec.distributed.embedding_sharding.BasePooledEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.embedding_sharding.BaseSequenceEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.embedding_sharding.BaseSparseFeaturesDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.embedding_sharding.EmbeddingSharding":[[4,2,1,"","create_infer_input_dist"],[4,2,1,"","create_infer_lookup"],[4,2,1,"","create_infer_pooled_output_dist"],[4,2,1,"","create_train_input_dist"],[4,2,1,"","create_train_lookup"],[4,2,1,"","create_train_pooled_output_dist"],[4,2,1,"","create_train_sequence_output_dist"],[4,2,1,"","embedding_dims"],[4,2,1,"","embedding_names"],[4,2,1,"","embedding_shard_metadata"],[4,2,1,"","id_list_feature_names"],[4,2,1,"","id_score_list_feature_names"]],"torchrec.distributed.embedding_sharding.SequenceShardingContext":[[4,4,1,"","features_before_input_dist"],[4,4,1,"","input_splits"],[4,4,1,"","lengths_after_input_dist"],[4,4,1,"","output_splits"],[4,2,1,"","record_stream"],[4,4,1,"","unbucketize_permute_tensor"]],"torchrec.distributed.embedding_sharding.SparseFeaturesAllToAll":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.embedding_sharding.SparseFeaturesOneToAll":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.embedding_types":[[4,1,1,"","BaseEmbeddingLookup"],[4,1,1,"","BaseEmbeddingSharder"],[4,1,1,"","BaseGroupedFeatureProcessor"],[4,1,1,"","EmbeddingAttributes"],[4,1,1,"","EmbeddingComputeKernel"],[4,1,1,"","GroupedEmbeddingConfig"],[4,1,1,"","ListOfSparseFeaturesList"],[4,1,1,"","OptimType"],[4,1,1,"","ShardedConfig"],[4,1,1,"","ShardedEmbeddingTable"],[4,1,1,"","ShardedMetaConfig"],[4,1,1,"","SparseFeatures"],[4,1,1,"","SparseFeaturesList"]],"torchrec.distributed.embedding_types.BaseEmbeddingLookup":[[4,2,1,"","forward"],[4,2,1,"","sparse_grad_parameter_names"],[4,4,1,"","training"]],"torchrec.distributed.embedding_types.BaseEmbeddingSharder":[[4,2,1,"","compute_kernels"],[4,5,1,"","fused_params"],[4,2,1,"","sharding_types"],[4,2,1,"","storage_usage"]],"torchrec.distributed.embedding_types.BaseGroupedFeatureProcessor":[[4,2,1,"","forward"],[4,2,1,"","sparse_grad_parameter_names"],[4,4,1,"","training"]],"torchrec.distributed.embedding_types.EmbeddingAttributes":[[4,4,1,"","compute_kernel"]],"torchrec.distributed.embedding_types.EmbeddingComputeKernel":[[4,4,1,"","BATCHED_DENSE"],[4,4,1,"","BATCHED_FUSED"],[4,4,1,"","BATCHED_FUSED_UVM"],[4,4,1,"","BATCHED_FUSED_UVM_CACHING"],[4,4,1,"","BATCHED_QUANT"],[4,4,1,"","DENSE"],[4,4,1,"","SPARSE"]],"torchrec.distributed.embedding_types.GroupedEmbeddingConfig":[[4,4,1,"","compute_kernel"],[4,4,1,"","data_type"],[4,2,1,"","dim_sum"],[4,2,1,"","embedding_dims"],[4,2,1,"","embedding_names"],[4,2,1,"","embedding_shard_metadata"],[4,4,1,"","embedding_tables"],[4,2,1,"","feature_hash_sizes"],[4,2,1,"","feature_names"],[4,4,1,"","has_feature_processor"],[4,4,1,"","is_weighted"],[4,2,1,"","num_features"],[4,4,1,"","pooling"]],"torchrec.distributed.embedding_types.ListOfSparseFeaturesList":[[4,2,1,"","record_stream"]],"torchrec.distributed.embedding_types.OptimType":[[4,4,1,"","ADAGRAD"],[4,4,1,"","ADAM"],[4,4,1,"","LAMB"],[4,4,1,"","LARS_SGD"],[4,4,1,"","PARTIAL_ROWWISE_ADAM"],[4,4,1,"","PARTIAL_ROWWISE_LAMB"],[4,4,1,"","ROWWISE_ADAGRAD"],[4,4,1,"","SGD"]],"torchrec.distributed.embedding_types.ShardedConfig":[[4,4,1,"","local_cols"],[4,4,1,"","local_rows"]],"torchrec.distributed.embedding_types.ShardedMetaConfig":[[4,4,1,"","global_metadata"],[4,4,1,"","local_metadata"]],"torchrec.distributed.embedding_types.SparseFeatures":[[4,4,1,"","id_list_features"],[4,4,1,"","id_score_list_features"],[4,2,1,"","record_stream"]],"torchrec.distributed.embedding_types.SparseFeaturesList":[[4,2,1,"","record_stream"]],"torchrec.distributed.embeddingbag":[[4,1,1,"","EmbeddingAwaitable"],[4,1,1,"","EmbeddingBagCollectionSharder"],[4,1,1,"","EmbeddingBagSharder"],[4,1,1,"","EmbeddingCollectionAwaitable"],[4,1,1,"","ShardedEmbeddingBag"],[4,1,1,"","ShardedEmbeddingBagCollection"],[4,1,1,"","ShardedEmbeddingBagCollectionBase"],[4,3,1,"","create_embedding_sharding"],[4,3,1,"","filter_state_dict"],[4,3,1,"","replace_placement_with_meta_device"]],"torchrec.distributed.embeddingbag.EmbeddingBagCollectionSharder":[[4,5,1,"","module_type"],[4,2,1,"","shard"],[4,2,1,"","shardable_parameters"]],"torchrec.distributed.embeddingbag.EmbeddingBagSharder":[[4,5,1,"","module_type"],[4,2,1,"","shard"],[4,2,1,"","shardable_parameters"]],"torchrec.distributed.embeddingbag.ShardedEmbeddingBag":[[4,2,1,"","compute"],[4,5,1,"","fused_optimizer"],[4,2,1,"","input_dist"],[4,2,1,"","load_state_dict"],[4,2,1,"","named_buffers"],[4,2,1,"","named_modules"],[4,2,1,"","named_parameters"],[4,2,1,"","output_dist"],[4,2,1,"","sharded_parameter_names"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"],[4,4,1,"","training"]],"torchrec.distributed.embeddingbag.ShardedEmbeddingBagCollection":[[4,5,1,"","fused_optimizer"],[4,4,1,"","training"]],"torchrec.distributed.embeddingbag.ShardedEmbeddingBagCollectionBase":[[4,2,1,"","compute"],[4,2,1,"","compute_and_output_dist"],[4,2,1,"","input_dist"],[4,2,1,"","load_state_dict"],[4,2,1,"","named_buffers"],[4,2,1,"","named_modules"],[4,2,1,"","named_parameters"],[4,2,1,"","output_dist"],[4,2,1,"","sharded_parameter_names"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"],[4,4,1,"","training"]],"torchrec.distributed.grouped_position_weighted":[[4,1,1,"","GroupedPositionWeightedModule"]],"torchrec.distributed.grouped_position_weighted.GroupedPositionWeightedModule":[[4,2,1,"","forward"],[4,2,1,"","named_buffers"],[4,2,1,"","named_parameters"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"],[4,4,1,"","training"]],"torchrec.distributed.model_parallel":[[4,1,1,"","DataParallelWrapper"],[4,1,1,"","DefaultDataParallelWrapper"],[4,1,1,"","DistributedModelParallel"],[4,3,1,"","get_default_sharders"]],"torchrec.distributed.model_parallel.DataParallelWrapper":[[4,2,1,"","wrap"]],"torchrec.distributed.model_parallel.DefaultDataParallelWrapper":[[4,2,1,"","wrap"]],"torchrec.distributed.model_parallel.DistributedModelParallel":[[4,4,1,"","SHARED_SHARDED_MODULE"],[4,4,1,"","SHARE_SHARDED"],[4,5,1,"","dmp_module"],[4,2,1,"","forward"],[4,5,1,"","fused_optimizer"],[4,2,1,"","init_data_parallel"],[4,2,1,"","load_state_dict"],[4,2,1,"","named_buffers"],[4,2,1,"","named_parameters"],[4,5,1,"","plan"],[4,2,1,"","sparse_grad_parameter_names"],[4,2,1,"","state_dict"]],"torchrec.distributed.planner":[[5,0,0,"-","constants"],[5,0,0,"-","enumerators"],[5,0,0,"-","partitioners"],[5,0,0,"-","perf_models"],[5,0,0,"-","planners"],[5,0,0,"-","proposers"],[5,0,0,"-","shard_estimators"],[5,0,0,"-","stats"],[5,0,0,"-","storage_reservations"],[5,0,0,"-","types"],[5,0,0,"-","utils"]],"torchrec.distributed.planner.constants":[[5,3,1,"","kernel_bw_lookup"]],"torchrec.distributed.planner.enumerators":[[5,1,1,"","EmbeddingEnumerator"],[5,3,1,"","calculate_shard_sizes_and_offsets"],[5,3,1,"","get_partition_by_type"]],"torchrec.distributed.planner.enumerators.EmbeddingEnumerator":[[5,2,1,"","enumerate"]],"torchrec.distributed.planner.partitioners":[[5,1,1,"","GreedyPerfPartitioner"],[5,3,1,"","greedy_partition"],[5,3,1,"","uniform_partition"]],"torchrec.distributed.planner.partitioners.GreedyPerfPartitioner":[[5,2,1,"","partition"]],"torchrec.distributed.planner.perf_models":[[5,1,1,"","NoopPerfModel"]],"torchrec.distributed.planner.perf_models.NoopPerfModel":[[5,2,1,"","rate"]],"torchrec.distributed.planner.planners":[[5,1,1,"","EmbeddingShardingPlanner"]],"torchrec.distributed.planner.planners.EmbeddingShardingPlanner":[[5,2,1,"","collective_plan"],[5,2,1,"","plan"]],"torchrec.distributed.planner.proposers":[[5,1,1,"","GreedyProposer"],[5,1,1,"","UniformProposer"]],"torchrec.distributed.planner.proposers.GreedyProposer":[[5,2,1,"","feedback"],[5,2,1,"","load"],[5,2,1,"","propose"]],"torchrec.distributed.planner.proposers.UniformProposer":[[5,2,1,"","feedback"],[5,2,1,"","load"],[5,2,1,"","propose"]],"torchrec.distributed.planner.shard_estimators":[[5,1,1,"","EmbeddingPerfEstimator"],[5,1,1,"","EmbeddingStorageEstimator"],[5,3,1,"","calculate_shard_storages"],[5,3,1,"","perf_func_emb_wall_time"]],"torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator":[[5,2,1,"","estimate"]],"torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator":[[5,2,1,"","estimate"]],"torchrec.distributed.planner.stats":[[5,1,1,"","EmbeddingStats"]],"torchrec.distributed.planner.stats.EmbeddingStats":[[5,2,1,"","log"]],"torchrec.distributed.planner.storage_reservations":[[5,1,1,"","FixedPercentageReservation"],[5,1,1,"","HeuristicalStorageReservation"]],"torchrec.distributed.planner.storage_reservations.FixedPercentageReservation":[[5,2,1,"","reserve"]],"torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation":[[5,2,1,"","reserve"]],"torchrec.distributed.planner.types":[[5,1,1,"","DeviceHardware"],[5,1,1,"","Enumerator"],[5,1,1,"","ParameterConstraints"],[5,1,1,"","PartitionByType"],[5,1,1,"","Partitioner"],[5,1,1,"","PerfModel"],[5,6,1,"","PlannerError"],[5,1,1,"","Proposer"],[5,1,1,"","Shard"],[5,1,1,"","ShardEstimator"],[5,1,1,"","ShardingOption"],[5,1,1,"","Stats"],[5,1,1,"","Storage"],[5,1,1,"","StorageReservation"],[5,1,1,"","Topology"]],"torchrec.distributed.planner.types.DeviceHardware":[[5,4,1,"","perf"],[5,4,1,"","rank"],[5,4,1,"","storage"]],"torchrec.distributed.planner.types.Enumerator":[[5,2,1,"","enumerate"]],"torchrec.distributed.planner.types.ParameterConstraints":[[5,4,1,"","caching_ratio"],[5,4,1,"","compute_kernels"],[5,4,1,"","min_partition"],[5,4,1,"","pooling_factors"],[5,4,1,"","sharding_types"]],"torchrec.distributed.planner.types.PartitionByType":[[5,4,1,"","DEVICE"],[5,4,1,"","HOST"],[5,4,1,"","UNIFORM"]],"torchrec.distributed.planner.types.Partitioner":[[5,2,1,"","partition"]],"torchrec.distributed.planner.types.PerfModel":[[5,2,1,"","rate"]],"torchrec.distributed.planner.types.Proposer":[[5,2,1,"","feedback"],[5,2,1,"","load"],[5,2,1,"","propose"]],"torchrec.distributed.planner.types.Shard":[[5,4,1,"","offset"],[5,4,1,"","perf"],[5,4,1,"","rank"],[5,4,1,"","size"],[5,4,1,"","storage"]],"torchrec.distributed.planner.types.ShardEstimator":[[5,2,1,"","estimate"]],"torchrec.distributed.planner.types.ShardingOption":[[5,4,1,"","batch_size"],[5,4,1,"","compute_kernel"],[5,4,1,"","downstream_modules"],[5,5,1,"","fqn"],[5,4,1,"","input_lengths"],[5,4,1,"","module"],[5,4,1,"","name"],[5,5,1,"","num_inputs"],[5,5,1,"","num_shards"],[5,4,1,"","partition_by"],[5,5,1,"","path"],[5,4,1,"","sharding_type"],[5,4,1,"","shards"],[5,4,1,"","tensor"],[5,4,1,"","upstream_modules"]],"torchrec.distributed.planner.types.Stats":[[5,2,1,"","log"]],"torchrec.distributed.planner.types.Storage":[[5,4,1,"","ddr"],[5,4,1,"","hbm"]],"torchrec.distributed.planner.types.StorageReservation":[[5,2,1,"","reserve"]],"torchrec.distributed.planner.types.Topology":[[5,5,1,"","batch_size"],[5,5,1,"","compute_device"],[5,5,1,"","devices"],[5,5,1,"","inter_host_bw"],[5,5,1,"","intra_host_bw"],[5,5,1,"","local_world_size"],[5,5,1,"","world_size"]],"torchrec.distributed.planner.utils":[[5,3,1,"","bytes_to_gb"],[5,3,1,"","gb_to_bytes"],[5,3,1,"","prod"],[5,3,1,"","sharder_name"]],"torchrec.distributed.quant_embeddingbag":[[4,1,1,"","QuantEmbeddingBagCollectionSharder"],[4,1,1,"","ShardedQuantEmbeddingBagCollection"]],"torchrec.distributed.quant_embeddingbag.QuantEmbeddingBagCollectionSharder":[[4,2,1,"","compute_kernels"],[4,5,1,"","module_type"],[4,2,1,"","shard"],[4,2,1,"","shardable_parameters"],[4,2,1,"","sharding_types"],[4,2,1,"","storage_usage"]],"torchrec.distributed.quant_embeddingbag.ShardedQuantEmbeddingBagCollection":[[4,2,1,"","input_dist"],[4,4,1,"","training"]],"torchrec.distributed.rw_sharding":[[4,1,1,"","RwEmbeddingSharding"],[4,1,1,"","RwPooledEmbeddingDist"],[4,1,1,"","RwSequenceEmbeddingDist"],[4,1,1,"","RwSparseFeaturesDist"]],"torchrec.distributed.rw_sharding.RwEmbeddingSharding":[[4,2,1,"","create_train_input_dist"],[4,2,1,"","create_train_lookup"],[4,2,1,"","create_train_pooled_output_dist"],[4,2,1,"","create_train_sequence_output_dist"],[4,2,1,"","embedding_dims"],[4,2,1,"","embedding_names"],[4,2,1,"","embedding_shard_metadata"],[4,2,1,"","id_list_feature_names"],[4,2,1,"","id_score_list_feature_names"]],"torchrec.distributed.rw_sharding.RwPooledEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.rw_sharding.RwSequenceEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.rw_sharding.RwSparseFeaturesDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.train_pipeline":[[4,1,1,"","ArgInfo"],[4,1,1,"","PipelinedForward"],[4,1,1,"","Tracer"],[4,1,1,"","TrainPipeline"],[4,1,1,"","TrainPipelineBase"],[4,1,1,"","TrainPipelineContext"],[4,1,1,"","TrainPipelineSparseDist"]],"torchrec.distributed.train_pipeline.ArgInfo":[[4,4,1,"","input_attrs"],[4,4,1,"","name"]],"torchrec.distributed.train_pipeline.PipelinedForward":[[4,5,1,"","args"],[4,5,1,"","name"]],"torchrec.distributed.train_pipeline.Tracer":[[4,4,1,"","graph"],[4,2,1,"","is_leaf_module"]],"torchrec.distributed.train_pipeline.TrainPipeline":[[4,2,1,"","progress"]],"torchrec.distributed.train_pipeline.TrainPipelineBase":[[4,2,1,"","progress"]],"torchrec.distributed.train_pipeline.TrainPipelineContext":[[4,4,1,"","input_dist_requests"],[4,4,1,"","module_contexts"]],"torchrec.distributed.train_pipeline.TrainPipelineSparseDist":[[4,2,1,"","progress"]],"torchrec.distributed.tw_sharding":[[4,1,1,"","TwEmbeddingSharding"],[4,1,1,"","TwInferencePooledEmbeddingDist"],[4,1,1,"","TwInferenceSparseFeaturesDist"],[4,1,1,"","TwPooledEmbeddingDist"],[4,1,1,"","TwSequenceEmbeddingDist"],[4,1,1,"","TwSparseFeaturesDist"]],"torchrec.distributed.tw_sharding.TwEmbeddingSharding":[[4,2,1,"","create_infer_input_dist"],[4,2,1,"","create_infer_lookup"],[4,2,1,"","create_infer_pooled_output_dist"],[4,2,1,"","create_train_input_dist"],[4,2,1,"","create_train_lookup"],[4,2,1,"","create_train_pooled_output_dist"],[4,2,1,"","create_train_sequence_output_dist"],[4,2,1,"","embedding_dims"],[4,2,1,"","embedding_names"],[4,2,1,"","embedding_shard_metadata"],[4,2,1,"","id_list_feature_names"],[4,2,1,"","id_score_list_feature_names"]],"torchrec.distributed.tw_sharding.TwInferencePooledEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.tw_sharding.TwInferenceSparseFeaturesDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.tw_sharding.TwPooledEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.tw_sharding.TwSequenceEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.tw_sharding.TwSparseFeaturesDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.twcw_sharding":[[4,1,1,"","TwCwEmbeddingSharding"]],"torchrec.distributed.twrw_sharding":[[4,1,1,"","TwRwEmbeddingDist"],[4,1,1,"","TwRwEmbeddingSharding"],[4,1,1,"","TwRwSparseFeaturesDist"]],"torchrec.distributed.twrw_sharding.TwRwEmbeddingDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.twrw_sharding.TwRwEmbeddingSharding":[[4,2,1,"","create_train_input_dist"],[4,2,1,"","create_train_lookup"],[4,2,1,"","create_train_pooled_output_dist"],[4,2,1,"","create_train_sequence_output_dist"],[4,2,1,"","embedding_dims"],[4,2,1,"","embedding_names"],[4,2,1,"","embedding_shard_metadata"],[4,2,1,"","id_list_feature_names"],[4,2,1,"","id_score_list_feature_names"]],"torchrec.distributed.twrw_sharding.TwRwSparseFeaturesDist":[[4,2,1,"","forward"],[4,4,1,"","training"]],"torchrec.distributed.types":[[4,1,1,"","Awaitable"],[4,1,1,"","ComputeKernel"],[4,1,1,"","EmptyContext"],[4,1,1,"","GenericMeta"],[4,1,1,"","LazyAwaitable"],[4,1,1,"","LazyNoWait"],[4,1,1,"","ModuleSharder"],[4,1,1,"","NoWait"],[4,1,1,"","ParameterSharding"],[4,1,1,"","ParameterStorage"],[4,1,1,"","ShardedModule"],[4,1,1,"","ShardedModuleContext"],[4,1,1,"","ShardingEnv"],[4,1,1,"","ShardingPlan"],[4,1,1,"","ShardingPlanner"],[4,1,1,"","ShardingType"],[4,3,1,"","scope"]],"torchrec.distributed.types.Awaitable":[[4,5,1,"","callbacks"],[4,2,1,"","wait"]],"torchrec.distributed.types.ComputeKernel":[[4,4,1,"","DEFAULT"]],"torchrec.distributed.types.EmptyContext":[[4,2,1,"","record_stream"]],"torchrec.distributed.types.ModuleSharder":[[4,2,1,"","compute_kernels"],[4,5,1,"","module_type"],[4,2,1,"","shard"],[4,2,1,"","shardable_parameters"],[4,2,1,"","sharding_types"],[4,2,1,"","storage_usage"]],"torchrec.distributed.types.ParameterSharding":[[4,4,1,"","compute_kernel"],[4,4,1,"","ranks"],[4,4,1,"","sharding_spec"],[4,4,1,"","sharding_type"]],"torchrec.distributed.types.ParameterStorage":[[4,4,1,"","DDR"],[4,4,1,"","HBM"]],"torchrec.distributed.types.ShardedModule":[[4,2,1,"","compute"],[4,2,1,"","compute_and_output_dist"],[4,2,1,"","create_context"],[4,2,1,"","forward"],[4,2,1,"","input_dist"],[4,2,1,"","output_dist"],[4,2,1,"","sharded_parameter_names"],[4,2,1,"","sparse_grad_parameter_names"],[4,4,1,"","training"]],"torchrec.distributed.types.ShardingEnv":[[4,2,1,"","from_local"],[4,2,1,"","from_process_group"]],"torchrec.distributed.types.ShardingPlan":[[4,2,1,"","get_plan_for_module"],[4,4,1,"","plan"]],"torchrec.distributed.types.ShardingPlanner":[[4,2,1,"","collective_plan"],[4,2,1,"","plan"]],"torchrec.distributed.types.ShardingType":[[4,4,1,"","COLUMN_WISE"],[4,4,1,"","DATA_PARALLEL"],[4,4,1,"","ROW_WISE"],[4,4,1,"","TABLE_COLUMN_WISE"],[4,4,1,"","TABLE_ROW_WISE"],[4,4,1,"","TABLE_WISE"]],"torchrec.distributed.utils":[[4,3,1,"","append_prefix"],[4,3,1,"","filter_state_dict"],[4,3,1,"","get_unsharded_module_names"],[4,1,1,"","sharded_model_copy"]],"torchrec.fx":[[10,0,0,"-","tracer"]],"torchrec.fx.tracer":[[10,1,1,"","Tracer"],[10,3,1,"","symbolic_trace"]],"torchrec.fx.tracer.Tracer":[[10,2,1,"","create_arg"],[10,4,1,"","graph"]],"torchrec.models":[[11,0,0,"-","deepfm"],[11,0,0,"-","dlrm"]],"torchrec.models.deepfm":[[11,1,1,"","DenseArch"],[11,1,1,"","FMInteractionArch"],[11,1,1,"","OverArch"],[11,1,1,"","SimpleDeepFMNN"],[11,1,1,"","SparseArch"]],"torchrec.models.deepfm.DenseArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.deepfm.FMInteractionArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.deepfm.OverArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.deepfm.SimpleDeepFMNN":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.deepfm.SparseArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.dlrm":[[11,1,1,"","DLRM"],[11,1,1,"","DenseArch"],[11,1,1,"","InteractionArch"],[11,1,1,"","OverArch"],[11,1,1,"","SparseArch"],[11,3,1,"","choose"]],"torchrec.models.dlrm.DLRM":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.dlrm.DenseArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.dlrm.InteractionArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.dlrm.OverArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.models.dlrm.SparseArch":[[11,2,1,"","forward"],[11,4,1,"","training"]],"torchrec.modules":[[12,0,0,"-","activation"],[12,0,0,"-","crossnet"],[12,0,0,"-","deepfm"],[12,0,0,"-","embedding_configs"],[12,0,0,"-","embedding_modules"],[12,0,0,"-","feature_processor"],[12,0,0,"-","lazy_extension"],[12,0,0,"-","mlp"],[12,0,0,"-","score_learning"],[12,0,0,"-","utils"]],"torchrec.modules.activation":[[12,1,1,"","SwishLayerNorm"]],"torchrec.modules.activation.SwishLayerNorm":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.crossnet":[[12,1,1,"","CrossNet"],[12,1,1,"","LowRankCrossNet"],[12,1,1,"","LowRankMixtureCrossNet"],[12,1,1,"","VectorCrossNet"]],"torchrec.modules.crossnet.CrossNet":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.crossnet.LowRankCrossNet":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.crossnet.LowRankMixtureCrossNet":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.crossnet.VectorCrossNet":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.deepfm":[[12,1,1,"","DeepFM"],[12,1,1,"","FactorizationMachine"]],"torchrec.modules.deepfm.DeepFM":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.deepfm.FactorizationMachine":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.embedding_configs":[[12,1,1,"","BaseEmbeddingConfig"],[12,1,1,"","DataType"],[12,1,1,"","EmbeddingBagConfig"],[12,1,1,"","EmbeddingConfig"],[12,1,1,"","EmbeddingTableConfig"],[12,1,1,"","PoolingType"]],"torchrec.modules.embedding_configs.BaseEmbeddingConfig":[[12,4,1,"","data_type"],[12,4,1,"","embedding_dim"],[12,4,1,"","feature_names"],[12,2,1,"","get_weight_init_max"],[12,2,1,"","get_weight_init_min"],[12,4,1,"","name"],[12,4,1,"","num_embeddings"],[12,2,1,"","num_features"],[12,4,1,"","weight_init_max"],[12,4,1,"","weight_init_min"]],"torchrec.modules.embedding_configs.DataType":[[12,4,1,"","FP16"],[12,4,1,"","FP32"],[12,4,1,"","INT2"],[12,4,1,"","INT4"],[12,4,1,"","INT8"]],"torchrec.modules.embedding_configs.EmbeddingBagConfig":[[12,4,1,"","pooling"]],"torchrec.modules.embedding_configs.EmbeddingConfig":[[12,4,1,"","embedding_dim"],[12,4,1,"","feature_names"],[12,4,1,"","num_embeddings"]],"torchrec.modules.embedding_configs.EmbeddingTableConfig":[[12,4,1,"","embedding_names"],[12,4,1,"","has_feature_processor"],[12,4,1,"","is_weighted"],[12,4,1,"","pooling"]],"torchrec.modules.embedding_configs.PoolingType":[[12,4,1,"","MEAN"],[12,4,1,"","NONE"],[12,4,1,"","SUM"]],"torchrec.modules.embedding_modules":[[12,1,1,"","EmbeddingBagCollection"],[12,1,1,"","EmbeddingBagCollectionInterface"],[12,1,1,"","EmbeddingCollection"]],"torchrec.modules.embedding_modules.EmbeddingBagCollection":[[12,5,1,"","embedding_bag_configs"],[12,2,1,"","forward"],[12,5,1,"","is_weighted"],[12,4,1,"","training"]],"torchrec.modules.embedding_modules.EmbeddingBagCollectionInterface":[[12,5,1,"","embedding_bag_configs"],[12,2,1,"","forward"],[12,5,1,"","is_weighted"],[12,4,1,"","training"]],"torchrec.modules.embedding_modules.EmbeddingCollection":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.feature_processor":[[12,1,1,"","BaseFeatureProcessor"],[12,1,1,"","PositionWeightedModule"]],"torchrec.modules.feature_processor.BaseFeatureProcessor":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.feature_processor.PositionWeightedModule":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.lazy_extension":[[12,1,1,"","LazyModuleExtensionMixin"],[12,3,1,"","lazy_apply"]],"torchrec.modules.lazy_extension.LazyModuleExtensionMixin":[[12,2,1,"","apply"]],"torchrec.modules.mlp":[[12,1,1,"","MLP"],[12,1,1,"","Perceptron"]],"torchrec.modules.mlp.MLP":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.mlp.Perceptron":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.score_learning":[[12,1,1,"","PositionWeightsAttacher"],[12,3,1,"","lengths_range_fill"]],"torchrec.modules.score_learning.PositionWeightsAttacher":[[12,2,1,"","forward"],[12,4,1,"","training"]],"torchrec.modules.utils":[[12,3,1,"","check_module_output_dimension"],[12,3,1,"","construct_modulelist_from_single_module"],[12,3,1,"","convert_list_of_modules_to_modulelist"],[12,3,1,"","extract_module_or_tensor_callable"],[12,3,1,"","get_module_output_dimension"],[12,3,1,"","init_mlp_weights_xavier_uniform"]],"torchrec.optim":[[13,0,0,"-","clipping"],[13,0,0,"-","fused"],[13,0,0,"-","keyed"],[13,0,0,"-","warmup"]],"torchrec.optim.clipping":[[13,1,1,"","GradientClipping"],[13,1,1,"","GradientClippingOptimizer"]],"torchrec.optim.clipping.GradientClipping":[[13,4,1,"","NONE"],[13,4,1,"","NORM"],[13,4,1,"","VALUE"]],"torchrec.optim.clipping.GradientClippingOptimizer":[[13,2,1,"","step"]],"torchrec.optim.fused":[[13,1,1,"","FusedOptimizer"],[13,1,1,"","FusedOptimizerModule"]],"torchrec.optim.fused.FusedOptimizer":[[13,2,1,"","step"],[13,2,1,"","zero_grad"]],"torchrec.optim.fused.FusedOptimizerModule":[[13,5,1,"","fused_optimizer"]],"torchrec.optim.keyed":[[13,1,1,"","CombinedOptimizer"],[13,1,1,"","KeyedOptimizer"],[13,1,1,"","KeyedOptimizerWrapper"],[13,1,1,"","OptimizerWrapper"]],"torchrec.optim.keyed.CombinedOptimizer":[[13,5,1,"","optimizers"],[13,5,1,"","param_groups"],[13,5,1,"","params"],[13,2,1,"","post_load_state_dict"],[13,5,1,"","state"],[13,2,1,"","step"],[13,2,1,"","zero_grad"]],"torchrec.optim.keyed.KeyedOptimizer":[[13,2,1,"","add_param_group"],[13,2,1,"","init_state"],[13,2,1,"","load_state_dict"],[13,2,1,"","post_load_state_dict"],[13,2,1,"","save_param_groups"],[13,2,1,"","state_dict"]],"torchrec.optim.keyed.KeyedOptimizerWrapper":[[13,2,1,"","step"],[13,2,1,"","zero_grad"]],"torchrec.optim.keyed.OptimizerWrapper":[[13,2,1,"","add_param_group"],[13,2,1,"","load_state_dict"],[13,2,1,"","post_load_state_dict"],[13,2,1,"","save_param_groups"],[13,2,1,"","state_dict"],[13,2,1,"","step"],[13,2,1,"","zero_grad"]],"torchrec.optim.warmup":[[13,1,1,"","WarmupOptimizer"],[13,1,1,"","WarmupPolicy"],[13,1,1,"","WarmupStage"]],"torchrec.optim.warmup.WarmupOptimizer":[[13,2,1,"","post_load_state_dict"],[13,2,1,"","step"]],"torchrec.optim.warmup.WarmupPolicy":[[13,4,1,"","CONSTANT"],[13,4,1,"","INVSQRT"],[13,4,1,"","LINEAR"],[13,4,1,"","NONE"],[13,4,1,"","POLY"],[13,4,1,"","STEP"]],"torchrec.optim.warmup.WarmupStage":[[13,4,1,"","decay_iters"],[13,4,1,"","lr_scale"],[13,4,1,"","max_iters"],[13,4,1,"","policy"],[13,4,1,"","value"]],"torchrec.quant":[[14,0,0,"-","embedding_modules"]],"torchrec.quant.embedding_modules":[[14,1,1,"","EmbeddingBagCollection"]],"torchrec.quant.embedding_modules.EmbeddingBagCollection":[[14,5,1,"","embedding_bag_configs"],[14,2,1,"","forward"],[14,2,1,"","from_float"],[14,5,1,"","is_weighted"],[14,2,1,"","named_buffers"],[14,2,1,"","state_dict"],[14,4,1,"","training"]],"torchrec.sparse":[[15,0,0,"-","jagged_tensor"]],"torchrec.sparse.jagged_tensor":[[15,1,1,"","JaggedTensor"],[15,1,1,"","JaggedTensorMeta"],[15,1,1,"","KeyedJaggedTensor"],[15,1,1,"","KeyedTensor"]],"torchrec.sparse.jagged_tensor.JaggedTensor":[[15,2,1,"","empty"],[15,2,1,"","from_dense_lengths"],[15,2,1,"","lengths"],[15,2,1,"","offsets"],[15,2,1,"","record_stream"],[15,2,1,"","to"],[15,2,1,"","values"],[15,2,1,"","weights"],[15,2,1,"","weights_or_none"]],"torchrec.sparse.jagged_tensor.KeyedJaggedTensor":[[15,2,1,"","concat"],[15,2,1,"","device"],[15,2,1,"","empty"],[15,2,1,"","empty_like"],[15,2,1,"","from_lengths_sync"],[15,2,1,"","from_offsets_sync"],[15,2,1,"","keys"],[15,2,1,"","length_per_key"],[15,2,1,"","lengths"],[15,2,1,"","offset_per_key"],[15,2,1,"","offsets"],[15,2,1,"","permute"],[15,2,1,"","pin_memory"],[15,2,1,"","record_stream"],[15,2,1,"","split"],[15,2,1,"","stride"],[15,2,1,"","sync"],[15,2,1,"","to"],[15,2,1,"","to_dict"],[15,2,1,"","values"],[15,2,1,"","weights"],[15,2,1,"","weights_or_none"]],"torchrec.sparse.jagged_tensor.KeyedTensor":[[15,2,1,"","from_tensor_list"],[15,2,1,"","key_dim"],[15,2,1,"","keys"],[15,2,1,"","length_per_key"],[15,2,1,"","offset_per_key"],[15,2,1,"","record_stream"],[15,2,1,"","regroup"],[15,2,1,"","to"],[15,2,1,"","to_dict"],[15,2,1,"","values"]],"torchrec.streamable":[[1,1,1,"","Multistreamable"],[1,1,1,"","Pipelineable"]],"torchrec.streamable.Multistreamable":[[1,2,1,"","record_stream"]],"torchrec.streamable.Pipelineable":[[1,2,1,"","to"]],torchrec:[[2,0,0,"-","datasets"],[4,0,0,"-","distributed"],[10,0,0,"-","fx"],[11,0,0,"-","models"],[12,0,0,"-","modules"],[13,0,0,"-","optim"],[14,0,0,"-","quant"],[15,0,0,"-","sparse"],[1,0,0,"-","streamable"]]},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","function","Python function"],"4":["py","attribute","Python attribute"],"5":["py","property","Python property"],"6":["py","exception","Python exception"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:function","4":"py:attribute","5":"py:property","6":"py:exception"},terms:{"0":[2,4,5,11,12,13,14,15],"0000":12,"00091":11,"0399":12,"0409":12,"04247":[11,12],"0499":12,"05123":12,"0697":12,"0724":12,"0s":13,"1":[2,4,5,10,11,12,13,14,15],"10":[5,11,12,14],"100":[2,5,11,12],"100_000":2,"1024":2,"12":5,"1279":12,"13":2,"1315":12,"13535":12,"137438953472":5,"15":11,"16":[2,12],"1703":[11,12],"1708":12,"1756":12,"1797":12,"1823":12,"1906":11,"192":12,"1tb":2,"1tb_binari":2,"2":[2,4,5,11,12,13,14,15],"20":[2,5,11,12],"200":5,"2008":12,"2050":12,"20m":2,"2249":12,"25":2,"25m":2,"2767":12,"2nd":12,"3":[4,5,11,12,13,14,15],"30":[5,12],"300":5,"3176":12,"32":12,"3210":12,"3823":12,"4":[2,4,5,11,12,14,15],"40":[5,12],"4130":12,"4206":12,"4341":12,"4697":12,"5":[4,11,12,14,15],"50":2,"512":5,"5478":12,"5606":12,"59923":12,"6":[4,11,12,14],"600":5,"6054":12,"6149":12,"64":12,"6805":12,"6810":12,"7":[11,12,14],"7352":12,"75":2,"7519":12,"8":[11,12,14,15],"8095":12,"8864":12,"8876":12,"9":11,"90":12,"9329":12,"9965":12,"abstract":[1,4,5,12,13],"boolean":4,"case":[4,10,12,13,15],"class":[1,2,4,5,10,11,12,13,14,15],"default":[2,4,10,12,13,14,15],"do":[4,12,13],"enum":[4,5,12,13],"final":[4,5,11,15],"float":[2,4,5,10,12,13],"function":[2,3,4,5,10,11,12,13,14],"import":12,"int":[2,4,5,10,11,12,13,15],"long":[4,12],"public":[4,12],"return":[1,2,3,4,5,10,11,12,13,14,15],"static":[2,4,15],"switch":13,"true":[2,4,5,12,13,14],"while":[2,4,10,11,12,14],A:[2,4,10,13,15],By:4,For:[0,4,11,12,13,15],If:[4,5,12,13],In:[4,12,13],It:[0,4,12,13,14],No:4,On:12,One:[5,12],The:[2,4,5,10,11,12,13,15],Then:4,These:12,To:[4,12],_:2,__getattr__:4,__torch_function__:4,__warmup:13,_c:[4,5],_call_impl:12,_default_dp_selector:2,_default_key_fn:2,_default_row_mapp:2,_distributed_c10d:[4,5],_incompatiblekei:4,_infer_paramet:12,_intern:4,_memcpy_stream:4,_recat:4,_recat_pooled_embedding_grad_out:4,_shard:[4,13],_symbolic_trac:[4,10,15],a2a:4,a2a_pooled_embs_tensor:4,a2a_sequence_embs_tensor:4,a2ai:4,ab:[11,12],abc:[1,4,5,12,13,15],abcmeta:15,abl:15,about:4,abov:[12,15],accept:[4,12],access:[4,13,15],accoard:[1,2,15],accord:[4,5,11,13],accuraci:12,achiev:4,across:[0,1,2,4],act:5,activ:[0,1,14],actual:[2,4,12],ad:[2,4,13],adagrad:4,adam:4,adapt:[2,12],add:[2,10,13],add_param_group:13,addit:[10,12,13],adjust:13,advanc:13,advertis:2,affect:2,after:[4,5,12],afterward:[4,11,12,14],again:4,ailab:2,alia:4,all2al:4,all2all_pooled_req:4,all2all_pooled_wait:4,all2all_seq_req:4,all2all_seq_req_wait:4,all2allpooledinfo:4,all2allsequenceinfo:4,all2allv_req:4,all2allv_wait:4,all2allvinfo:4,all:[2,4,5,11,12,13,14],all_to_all_singl:4,alloc:[4,5],allocate_id:4,allow:[0,1,2,4,10,12,13],alltoal:4,alltoall_pool:4,alltoall_sequ:4,alltoallv:4,alltoon:4,along:[4,13,15],alreadi:[4,13],also:[4,11,12,13],although:[4,11,12,14],altogeth:13,alwai:12,among:[5,11],amount:2,an:[1,2,4,5,10,12,13,14,15],ani:[2,4,5,10,12,13,14,15],anoth:1,api:[4,10,13],appear:4,append:4,append_prefix:4,appli:[2,4,11,12],applic:1,appropri:10,ar:[1,2,4,5,12,13,14],arang:12,arbitari:4,arbitrari:4,arch:11,architectur:12,arg:[3,4,5,11,12,13,14,15],arginfo:4,argpars:3,argument:[2,4,10,12],argv:3,around:5,arrai:2,arxiv:[11,12],assert:12,assign:[1,2,5,15],associ:5,assum:[2,4,11,13],assumpt:4,async:4,atom:4,attach:12,attempt:5,attribut:[4,5,13],author:[0,4],autograd:4,automat:4,avail:4,averag:[4,5,14],avoid:[2,13],await:[4,10],awar:[1,2,15],b:[2,4,11,12,14,15],b_global:4,b_l:12,b_local:4,b_local_list:4,back:2,backend:4,backward:[4,5,13],backward_recat_tensor:4,bag:[4,11],bandwidth:5,bar:4,base:[1,2,4,5,10,11,12,13,14,15],basebatchedembeddingbag:12,baseembeddingconfig:12,baseembeddinglookup:4,baseembeddingshard:4,basefeatureprocessor:12,basegroupedfeatureprocessor:4,basepooledembeddingdist:4,basesequenceembeddingdist:4,basesparsefeaturesdist:4,basic:11,batch:[2,4,5,11,12,14,15],batch_siz:[2,4,5,12],batched_dens:4,batched_fus:4,batched_fused_uvm:4,batched_fused_uvm_cach:4,batched_qu:4,batcher:2,baz:4,becaus:[12,13],been:12,befor:[4,12,13],begin:[4,13],behav:13,behavior:[2,4,10,13],being:[4,12],below:4,best_plan:5,between:[4,5,11,12,15],beyond:5,bia:[4,12,14],binari:[2,3],binarycriteoutil:2,bit:12,bldm:5,block_siz:4,bool:[1,2,4,5,10,11,12,13,14,15],both:[4,11,12,14],broadcast:[4,5],bucket:4,bucketize_kjt_before_all2al:4,bucketize_po:4,buf:[4,14],buffer:[4,14],built:[0,12],bw_inter_host:5,bw_intra_host:5,bytes_to_gb:5,c:[2,4,15],c_l_i:12,cach:5,caching_ratio:5,calcul:5,calculate_shard_sizes_and_offset:5,calculate_shard_storag:5,call:[2,4,5,11,12,14],call_modul:4,callabl:[2,4,10,12,13],callback:4,caller:4,can:[1,2,4,5,11,12,13,15],capac:5,care:[4,11,12,14],cat:11,cat_dim:15,cat_feature_count:2,cat_fm_output:11,categor:2,caveat:4,certain:[12,13],challeng:2,chang:[4,12,13],channel:12,check:[4,12,13],check_module_output_dimens:12,checkpoint:13,children:12,choos:11,chosen:[5,12],chunk:4,clariti:5,classmethod:[4,14],click:2,clip:[0,1],closur:13,code:12,col_wise_shard_dim:5,collat:2,collect:[4,11,12,13,14],collective_plan:[4,5],collective_util:[0,1],column:[4,5],column_wis:4,com:[0,2,12],comb:11,combin:[12,13],combinedoptim:13,comm:[0,1],comm_op:[0,1],command:3,common:[0,2,15],common_spars:12,commun:4,compar:12,compat:[4,11,13],compin:4,complet:[4,5],compon:12,compound:1,compris:5,comput:[4,5,11,12,14],compute_and_output_dist:4,compute_devic:5,compute_device_typ:4,compute_kernel:[4,5],computekernel:4,concat:[12,15],concat_dens:11,concaten:[2,4,11,12,15],concret:4,concrete_arg:10,config:[11,12],consid:[4,5],consist:[2,4],constant:[0,1,4,13],constitu:4,constitut:2,constraint:[4,5],construct:[4,10,12,15],construct_modulelist_from_single_modul:12,constructor:[4,5,11,12,13,14,15],contain:[1,2,4,12,13,14],context:4,continu:2,control:[4,10],conveni:13,convert:[2,4,10],convert_list_of_modules_to_modulelist:12,coordin:5,copi:[1,2,4,12,13,15],core:2,correct:4,correspond:[2,4,5,14,15],cost:12,could:4,count:[2,12],cover:12,cpu:[4,5],creat:[4,10,12,13],create_arg:10,create_context:4,create_embedding_shard:4,create_infer_input_dist:4,create_infer_lookup:4,create_infer_pooled_output_dist:4,create_train_input_dist:4,create_train_lookup:4,create_train_pooled_output_dist:4,create_train_sequence_output_dist:4,criteo:[0,1,3],criteo_kaggl:2,criteo_terabyt:2,criteoiterdatapip:2,cross:[4,12],cross_pg:4,crossnet:[0,1],ctx:4,cuda:[1,2,4,15],cumsum_dim_sum_per_rank_tensor:4,cumul:4,current:[2,4,12],custom:[4,10,12],customer:12,cut:12,cw:5,cw_shard:[0,1],cwembeddingshard:4,d1:12,d2:12,d3:12,d:[4,11,12,14],d_local_list:4,d_local_sum:4,data:[2,4,5,10,12,14,15],data_dist:4,data_parallel:[4,5],data_parallel_wrapp:4,data_typ:[4,12],dataload:2,dataloader_it:4,dataparallelwrapp:4,datapip:2,dataset:[0,1],datatyp:[4,12,15],day_0:2,day_1:2,day_:2,dcn:12,ddp:4,ddr:[4,5],ddr_cap:5,deal:2,decay_it:13,decimal_plac:2,deep:[11,12],deep_fm:11,deep_fm_dimens:11,deep_fm_output:12,deepcopi:4,deepfm:[0,1],deepfm_output:12,deepfmnn:11,def:[4,12],defaultdataparallelwrapp:4,defin:[4,11,12,14],definit:4,delai:4,dens:[2,4,11,12,15],dense_arch:11,dense_arch_layer_s:11,dense_devic:11,dense_embed:11,dense_featur:[2,11,12],dense_in_featur:11,dense_modul:[11,12],dense_path:2,densearch:11,depend:[4,12],descend:4,describ:4,descript:5,design:[2,4],desir:2,dest_typ:2,destin:[4,14],detail:[4,5,12],determin:[2,4,5],determinist:2,devic:[1,2,4,5,10,11,12,14,15],devicehardwar:5,di:11,dict:[2,4,5,10,12,13,14,15],dictionari:[4,14],did:13,differ:[2,4,12,13,15],differenti:4,dim_0:15,dim_1:15,dim_2:15,dim_sum:4,dim_sum_per_nod:4,dim_sum_per_rank:4,dim_sum_per_rank_tensor:4,dimens:[4,5,11,12,14,15],dimension:11,dimes:15,dims_sum_per_rank:4,direct:[4,14],directli:[4,13],directori:2,disjoint:2,disk:2,displai:2,dist:4,dist_data:[0,1],dist_input:4,dist_stream:4,distibut:4,distin:4,distout:4,distribut:[0,1,2,13],distributeddataparallel:4,distributedmodelparallel:4,divid:5,dlrm:[0,1],dmp:4,dmp_modul:4,doc:[1,2,4,10,15],docstr:5,document:10,doe:[4,11,12,13],doesn:[4,12,13],domain:0,don:[4,12],done:[4,5,13],dot:[11,12],download:2,downstream_modul:5,dp:[2,5],dp_selector:2,dp_shard:[0,1],dpembeddingshard:4,dppooledembeddingdist:4,dpsequenceembeddingdist:4,dpsparsefeaturesdist:4,dtype:[10,14],dummi:[12,13],duplic:[4,13],dure:[4,13],e1_config:12,e2_config:12,e:[4,10,11,12,13,14],each:[2,4,5,11,12,14,15],eas:12,eb1_config:[11,14],eb2_config:[11,14],ebc:[11,12,14],ebc_config:11,ec:12,ec_config:12,effect:12,effici:12,either:[2,4,12],elast:4,element:12,elif:4,emb:4,embed:[0,1,5,11,12,14,15],embedding_bag_collect:11,embedding_bag_config:[12,14],embedding_config:[0,1,4,14],embedding_dim:[4,11,12,14],embedding_dimens:11,embedding_featur:12,embedding_lookup:[0,1],embedding_modul:[0,1,4,11],embedding_nam:[4,12],embedding_shard:[0,1],embedding_shard_metadata:4,embedding_t:4,embedding_typ:[0,1],embeddingattribut:4,embeddingawait:4,embeddingbackward:12,embeddingbag:[0,1,11,12,14],embeddingbagcollect:[1,4,11,12,14],embeddingbagcollectionconfig:11,embeddingbagcollectioninterfac:[4,12,14],embeddingbagcollectionshard:[4,5],embeddingbagconfig:[11,12,14],embeddingbagshard:4,embeddingcollect:[4,12],embeddingcollectionawait:4,embeddingcollectionconfig:12,embeddingcollectioncontext:4,embeddingcollectionshard:4,embeddingcomputekernel:4,embeddingconfig:12,embeddingenumer:5,embeddinglookup:4,embeddingperfestim:5,embeddingshard:4,embeddingshardingplann:[4,5],embeddingstat:5,embeddingstorageestim:5,embeddingtableconfig:[4,12],emit:10,empti:[13,15],empty_lik:15,emptycontext:4,enabl:[2,4,5],end:[5,12],enforc:4,ensur:[4,12],entir:[2,4],entri:4,enumer:[0,1,4,12,13],env:4,environ:4,equal:[4,12],equival:4,error:[5,12],essenti:4,estim:5,etc:[2,4],evalu:[5,12],evenli:4,everi:[4,11,12,14],exactli:[2,4],exampl:[1,2,4,5,11,12,13,14,15],except:[4,5,12],execut:5,exist:4,expand:10,expect:[2,3,5,11,12],experiment:4,expert:12,expert_i:12,expos:[4,13],exten:[11,12],extens:12,extra:5,extract_module_or_tensor_cal:12,f1:[11,12,14],f2:[11,12,14],f3:11,f:[2,4,11,12,14],factor:[5,12],factori:[4,5,12],factorizationmachin:12,fail:12,fake:13,fals:[2,4,12,13,14,15],fashion:[4,5],fast:4,fb:12,fbgemm:14,feat1:2,feat2:2,featur:[2,4,5,11,12,14],feature0:15,feature1:15,feature_embed:12,feature_hash_s:4,feature_nam:[4,11,12,14],feature_processor:[0,1,4],features_before_input_dist:4,features_max_length:12,features_per_rank:4,feedback:5,field:[4,12,13],file:[2,4],file_io:2,filesystem:2,fill:4,fill_:[4,12],filter:4,filter_state_dict:4,fine:13,first:[1,4,5,12,13,15],fixedpercentagereserv:5,flag:[4,13],flatten:12,flexibl:12,float32:2,flow:[4,10],fm:12,fm_in_featur:11,fm_inter_arch:11,fminteractionarch:11,fn:12,fname:2,follow:[4,12,13,15],foo:4,footprint:13,foreach:12,form:[12,14],format:[2,3],former:[4,11,12,14],formula:4,forward:[4,5,11,12,14],forward_recat_tensor:4,fp16:12,fp32:[4,12],fqn:5,framework:12,from:[1,2,4,10,11,12,13,15],from_dense_length:15,from_float:14,from_lengths_sync:15,from_loc:4,from_offsets_sync:[11,12,15],from_process_group:4,from_tensor_list:15,frozen:13,full:[12,13,15],fulli:[4,5,13],func:4,further:12,fuse:[0,1,4,12],fused_optim:[4,13],fused_param:4,fusedoptim:13,fusedoptimizermodul:[4,13],fusion:12,fx:[0,1,4,15],g:[4,12,13,14],gate:12,gb:5,gb_to_byt:5,gener:[1,2,4,5,10,11,12,13,15],genericmeta:4,get:[2,4,5],get_default_shard:4,get_file_idx_to_row_rang:2,get_group_rank:4,get_local_rank:4,get_local_s:4,get_module_output_dimens:12,get_num_group:4,get_partition_by_typ:5,get_plan_for_modul:4,get_rank:2,get_shape_from_npi:2,get_unsharded_module_nam:4,get_weight_init_max:12,get_weight_init_min:12,get_world_s:2,getattr:4,github:[0,12],given:[2,4,5,10,12],global:4,global_metadata:4,go:13,gpu:[0,4],grad:[4,13],grad_fn:12,grad_output:4,gradient:[4,5,13],gradientclip:13,gradientclippingoptim:13,graph:[4,10],graph_modul:10,graphmodul:10,greedi:5,greedy_partit:5,greedyperfpartition:5,greedypropos:5,group:[4,5,13,15],group_rank:4,group_tabl:4,grouped_config:4,grouped_configs_per_rank:4,grouped_position_weight:[0,1],grouped_score_config:4,grouped_score_configs_per_rank:4,groupedembeddingbag:12,groupedembeddingconfig:4,groupedembeddingslookup:4,groupedpooledembeddingslookup:4,groupedpositionweightedmodul:4,groupmemb:4,guarante:[2,4,13],ha:[4,12,15],handl:[2,4,10],happen:4,hardwar:5,has_feature_processor:[4,12],has_input_dist:5,has_output_dist:5,hash:[2,4],hash_siz:2,hasn:12,have:[4,5,10,11,12,13],hbm:[4,5],hbm_cap:5,header:2,help:4,here:[4,11],heurist:5,heuristicalstoragereserv:5,hidden:[11,12],hidden_layer_s:11,hide:4,hierarch:4,hierarchi:4,high:12,hold:[4,13,15],home:2,hook:[4,11,12,14],host:[4,5],how:[4,5,13],howev:13,html:[1,2,4,10,15],http:[0,1,2,4,10,11,12,15],i:[4,10,11,12],id:[2,4,12],id_list_featur:4,id_list_feature_hash_s:4,id_list_feature_nam:4,id_list_features_await:4,id_list_features_per_rank:4,id_score_list_featur:4,id_score_list_feature_hash_s:4,id_score_list_feature_nam:4,id_score_list_features_await:4,id_score_list_features_per_rank:4,ident:12,identifi:13,ids_per_featur:2,idx:[2,4],idx_split_train_v:2,ie:[4,5,15],ignor:[4,5,11,12,14],immedi:12,impl:12,implement:[1,4,11,12,13,15],implent:12,impli:4,improv:13,in_featur:[4,11,12],in_fil:2,in_lengths_per_work:4,in_siz:12,includ:[2,4,12,14,15],include_movies_data:2,inclus:2,index:[0,5,15],index_per_kei:15,indic:[2,4,5,13,15],indices_tensor:15,individu:4,infer:4,infer_f:4,infer_t:4,infergroupedpooledembeddingslookup:4,inherit:12,init:4,init_data_parallel:4,init_distribut:4,init_mlp_weights_xavier_uniform:12,init_paramet:4,init_st:13,init_weight:[4,12],initi:[4,12,13],inmemorybinarycriteoiterdatapip:[2,3],input:[1,2,4,5,10,11,12,14,15],input_attr:4,input_data_type_s:5,input_dim:12,input_dist:4,input_dist_request:4,input_embed:[4,12],input_length:5,input_s:4,input_split:4,input_split_s:4,instal:0,instanc:[2,4,10,11,12,14],instanti:4,instead:[4,11,12,13,14],instruct:0,int2:12,int32:2,int4:12,int8:12,intend:4,inter:4,inter_arch:11,inter_host_bw:5,interact:[11,12],interactionarch:11,interfac:[1,4,12],intra:4,intra_and_cross_node_pg:4,intra_host_bw:5,intra_pg:4,introduc:13,inv_sqrt:13,invoc:2,invok:4,invoke_on_rank_and_broadcast_result:4,invsqrt:13,io:2,iobas:2,iopath:2,ir:4,is_lead:4,is_leaf_modul:4,is_sequ:4,is_weight:[4,12,14,15],isinst:4,issu:[4,12],iter:[2,4,5,12,13,14],iterabledataset:2,iterdatapip:2,its:[2,4,12,13],itself:[4,11,12,14],jag:[12,14,15],jagged_tensor:[0,1,2,4,11,12,14],jaggedtensor:[1,4,12,15],jaggedtensormeta:15,jit:15,just:[4,5,11,12],jvp:4,k:[11,12],kaggl:2,kaiming_normal_:4,keep:12,keep_var:[4,14],kei:[0,1,2,4,11,12,14,15],kernel:[4,5,12],kernel_bw_lookup:5,key_dim:15,key_fn:2,keyed_tensor:15,keyedjaggedtensor:[2,4,11,12,14,15],keyedoptim:[4,13],keyedoptimizerwrapp:13,keyedtensor:[4,11,12,14,15],keyjaggedtensor:4,keyword:12,kjt:[4,5,15],kjta2a:4,kjtalltoal:4,kjtalltoallindicesawait:4,kjtalltoalllengthsawait:4,kjtonetoal:4,known:[4,5],kt:15,kw:2,kwarg:[4,12,15],kwd:4,l:[4,12,14],l_i:4,label:2,labels_path:2,lamb:4,larg:[0,2],lars_sgd:4,last:[12,15],late:4,latenc:4,later:[4,12],latter:[4,11,12,14],layer:[1,4,11,12,13],layer_s:[11,12],layernorm:12,layout:[4,10],lazi:[4,12,13],lazy_appli:12,lazy_extens:[0,1],lazyawait:4,lazylinear:12,lazymlp:12,lazymoduleextensionmixin:12,lazymodulemixin:12,lazynowait:4,leader:4,leader_rank:4,leaf:4,learn:[11,12,13],learnabl:12,learnt:12,len:[4,11],length:[2,4,5,11,12,14,15],length_per_kei:[11,15],lengths_after_input_dist:4,lengths_after_sparse_data_all2al:4,lengths_range_fil:12,lengths_sparse_before_features_all2al:4,level:4,leverag:12,lib:2,librari:[0,4],like:[4,5,12,13],limit:[2,12],line:[2,3],linear:[4,5,12,13],link:12,list:[2,3,4,5,10,11,12,13,14,15],listofsparsefeatureslist:4,listofsparsefeatureslistawait:4,littl:13,load:[2,5,13],load_checkpoint:13,load_npy_rang:2,load_state_dict:[4,13],loadfil:2,loadfilesfromdisk:2,local:[2,4],local_col:[4,5],local_emb:4,local_metadata:4,local_row:[4,5],local_world_s:5,locat:[4,12],log:[2,5],logit:11,look:4,lookup:[5,11],loss:13,low:12,low_rank:12,lower:[10,13,14],lowrankcrossnet:12,lowrankmixturecrossnet:12,lr:13,lr_param:13,lr_scale:13,m:[4,12],m_cpu:4,machin:[5,12],made:13,magic:4,mai:[4,15],main:3,make:[4,12,13],manag:2,mani:[0,1,4],manual:[4,11,13],manual_se:2,map:[2,4,12,13,14],margin:5,mark:1,match:[2,4,11,12],math:11,matrix:12,max:[2,13],max_feature_length:[4,12],max_gradi:13,max_it:13,max_length:12,max_nnod:4,maximum:12,mean:[4,12],meant:13,mechan:[4,12],mem_cap:5,member:[4,14],membership:2,memcpi:4,memo:4,memori:[2,4,5,13],memory_format:10,mention:12,merg:[2,4],meta:4,metadata:4,method:[1,4,10,12],might:[1,2,10,15],min_partit:5,miss:4,missing_kei:4,mix:4,mixed_dim:4,mixtur:12,ml:2,mlp:[0,1,11],mlp_modul:12,mode:[2,4],model:[0,1,4,5,10,12,13],model_parallel:[0,1],modestli:13,modifi:13,modul:0,module_context:4,module_or_cal:12,module_path:4,module_qualified_nam:4,module_typ:4,modulelist:12,moduleshard:[4,5],modulo:2,moe:12,more:[4,5,10],most:13,move:[1,4],movi:2,movielen:[0,1],movielens_20m:2,movielens_25m:2,much:[5,13],multi:12,multipl:[2,4,5,12,13],multistream:[1,4],must:[4,12],my:4,mymodel:4,myreq:4,n:[11,12,15],name:[2,4,5,11,12,13,14,15],named_buff:[4,14],named_modul:4,named_paramet:4,namedtupl:4,namespac:[3,4,15],nativ:12,native_embed:12,nccl:4,ndarrai:2,ndim:2,need:[0,2,4,5,10,11,12,13,14],needs_input_grad:4,nest:12,net:[4,12],network:[4,5,12,13],new_devic:[1,2,15],new_group:4,next:2,nn:[4,5,10,11,12,14],no_grad:[4,12],node:[4,10],non:[4,5,12],non_block:[1,2,15],none:[1,2,3,4,5,10,11,12,13,14,15],nonetyp:[4,12],noopperfmodel:5,norm:13,normal:12,note:[2,4,10,11,12,15],now:[10,12],nowait:[4,10],np:2,nproc_per_nod:4,npy:[2,3],num_bucket:4,num_byt:5,num_dens:2,num_dense_featur:11,num_embed:[4,11,12,14],num_expert:12,num_featur:[4,11,12],num_id_list_featur:4,num_id_score_list_featur:4,num_input:5,num_lay:12,num_partit:5,num_plan:5,num_propos:5,num_row:2,num_shard:5,num_sparse_featur:11,num_work:2,number:[2,4,5,11,12],numer:12,numpi:2,nx1:12,nxn:12,o:12,obj:4,object:[1,2,4,5,12,13],off:12,offset:[4,5,11,12,14,15],offset_per_kei:[12,15],often:1,old:13,onc:[4,12],one:[1,2,4,5,11,12,13,14],onetoal:4,onli:[2,4,5,12,14],op:[4,13,14],open:2,open_kw:2,oper:[1,2,4,10,12,15],optim:[0,1,4,5,12],optim_factori:13,optimizerwrapp:13,optimtyp:4,option:[2,4,5,10,11,12,13,14,15],option_idx:5,order:[4,12],ordereddict:4,org:[1,2,4,10,11,12,15],origin:4,other:[1,4,5,13],otherwis:[4,13,14],our:12,out:4,out_dense_fil:2,out_featur:[4,12],out_labels_fil:2,out_siz:12,out_sparse_fil:2,out_split:4,output:[2,4,5,11,12,14],output_data_type_s:5,output_dim:12,output_dist:4,output_permut:4,output_split:4,output_split_s:4,over:[2,4,11,12,14],over_arch:11,over_arch_layer_s:11,over_embedding_dim:11,overarch:11,overlap:4,overrid:4,overridden:[4,11,12,14],p2p:4,page:0,pair:11,pairwis:11,paper:[11,12],parallel:[0,2,4],parallelreadconcat:2,param:[2,4,13],param_group:13,param_nam:13,paramet:[2,3,4,5,10,12,13,14],parameterconstraint:5,parametershard:4,parameterstorag:4,pariti:12,paritit:5,parse_arg:3,part:[2,4,5,12,13],partial:10,partial_rowwise_adam:4,partial_rowwise_lamb:4,partit:[2,5],partition:[0,1,4],partition_0:5,partition_1:5,partition_2:5,partition_3:5,partition_bi:5,partition_by_devic:5,partition_sum:5,partitionbytyp:5,pass:[2,4,11,12,13,14],path:[2,4,5],path_manager_kei:2,pathmanag:2,pattern:4,pdf:[11,12],per:[2,4,5,12],per_rank_split_length:4,per_sample_weight:4,percentag:5,perceptron:12,perf:5,perf_func_emb_wall_tim:5,perf_model:[0,1,4],perf_rat:5,perfect:4,perfmodel:5,perform:[4,5,11,12,13,14],performance_model:5,permut:[4,15],permute_embed:4,permuted_lengths_after_sparse_data_all2al:4,perserv:12,persist:[4,14],person:11,pg:[4,5],physic:4,pin_memori:[2,15],pipelin:[1,2,4,15],pipelinedforward:4,place:[4,5,13],placeholderobserv:14,placement:[4,5],plan:[4,5,12],planner:[0,1,4],plannererror:5,pleas:[1,2,12,15],point:4,poli:13,polici:13,polynom:12,pool:[4,5,11,12,14,15],pooled_embed:12,pooledembed:5,pooledembeddingsalltoal:4,pooledembeddingsalltoon:4,pooledembeddingsawait:4,pooledembeddingsreducescatt:4,pooling_factor:5,poolingtyp:[4,12],popul:[5,12],portion:2,posit:[4,12],positionweightedmodul:12,positionweightsattach:12,possibl:4,post_load_state_dict:13,practic:4,pre:[12,13],precis:14,prefix:[4,14],prepar:[10,12],prepend:[4,14],preprocess:[2,3],preprocess_criteo:[0,1,2],present:13,preserv:4,prevent:2,primit:[0,4],print:[4,12,14],process:[4,5,11,12,14],processgroup:[4,5],processor:[4,12],processs:4,prod:5,produc:[2,4],product:11,program:4,progress:[4,13],prohibit:13,project:11,properti:[4,5,12,13,14],proport:2,propos:[0,1,4,11],prospos:5,provid:[0,4,5,12],proxyableclassmeta:15,publish:12,purpos:10,pw:12,py:2,python:[4,10,11],pytorch:[0,1,2,4,10,12,15],qconfig:14,qebc:14,qint8:14,qualifi:4,quant:[0,1,4],quant_embeddingbag:[0,1],quantembeddingbagcollect:14,quantembeddingbagcollectionshard:4,quantiz:14,quantized_embed:14,queri:[4,5],quickli:4,r:[4,12],rais:[4,5],rand:[4,11],rand_split_train_v:2,randn:[4,11,12],random:[0,1],random_se:2,randomrecdataset:2,rang:2,rank0_input:4,rank0_output:4,rank1_input:4,rank1_output:4,rank:[2,4,5,12,13],rate:[5,13],ratio:5,raw:[3,12],raw_embedding_featur:12,re:[4,13],read:2,readjust:4,readlinesfromcsv:2,readm:0,reason:13,recat:4,receiv:[4,13],recip:[4,11,12,14],recommend:[0,2,11],record:[4,10],record_stream:[1,2,4,15],recsi:[0,2,11],recurs:[4,12,14],redistribut:4,reduc:[2,4,12],reduce_scatter_pool:4,reducescatter_req:4,reducescatter_wait:4,reducescatterinfo:4,reevalu:13,refer:12,referenc:4,regist:[4,11,12,14],regroup:15,reiniti:12,rel:5,relat:5,relationship:11,relev:[4,5],reli:[4,12,14],relu:12,rememb:[1,2,4,15],remov:[4,10],remove_dupl:4,reorder:4,replac:[2,13],replace_placement_with_meta_devic:4,replic:4,repres:[2,4,5,12,14,15],represent:[4,5,10],request:[4,13],requir:[4,5,12,13],reserv:5,resourc:4,respons:[2,4],result:[4,5,12],retrict:12,retriev:4,reus:4,right:[10,12],root:[2,4,10],row:[2,4],row_mapp:2,row_wis:4,rowwise_adagrad:4,rsi:4,rubric:[4,5],run:[4,11,12,13,14],run_on_lead:4,running_var:[4,14],runtimeerror:4,rw:[4,5],rw_shard:[0,1],rwembeddingshard:4,rwpooledembeddingdist:4,rwsequenceembeddingdist:4,rwsparsefeaturesdist:4,s:[4,5,10,11,12,13,14],safe:4,safe_cast:2,same:[2,4,11,12],sampl:[2,12],save:[2,4,12,13],save_for_backward:4,save_for_forward:4,save_param_group:13,scale:0,scatter:4,scenario:4,schedul:13,scope:4,score:[4,12],score_learn:[0,1],script:[0,1,2,15],sd:13,search:0,search_spac:5,second:[4,15],see:[1,2,4,5,10,12,15],seed:2,seek:2,seen:[4,10],segment:15,select:[4,5],self:[1,2,4,5,12,14,15],send:4,sens:[4,12,13],separ:4,seq:12,sequenc:[2,4],sequenceembeddingalltoal:4,sequenceembeddingsawait:4,sequenceshardingcontext:4,sequenti:[4,12],set:[4,12,13,14],set_gradient_divis:4,set_to_non:13,setup:12,sever:10,sfa2a:4,sgd:4,shape:[2,4,12,15],shard:[0,4,5,13],shard_:2,shard_estim:[0,1,4],shard_idx:5,shard_siz:5,shardable_paramet:4,sharded_grad_output:4,sharded_input_embed:4,sharded_model_copi:4,sharded_output_embed:4,sharded_parameter_nam:4,sharded_tensor:[4,13],shardedconfig:4,shardedembeddingbag:4,shardedembeddingbagcollect:4,shardedembeddingbagcollectionbas:4,shardedembeddingcollect:4,shardedembeddingt:4,shardedmetaconfig:4,shardedmodul:4,shardedmodulecontext:4,shardedquantembeddingbagcollect:4,shardedtensor:13,shardedtensormetadata:4,sharder:[4,5],sharder_map:5,sharder_nam:5,shardestim:5,sharding_context:4,sharding_ctx:4,sharding_opt:5,sharding_plan:5,sharding_spec:4,sharding_typ:[4,5],shardingenv:4,shardingopt:5,shardingplan:[4,5],shardingplann:[4,5],shardingspec:4,shardingtyp:[4,5],shardmetadata:4,share:[4,12],share_shard:4,shared_sharded_modul:4,should:[1,2,4,5,11,12,13,14],shuffl:4,sigmoid:12,silent:[4,11,12,14],simpl:11,simpledeepfmnn:11,simplifi:12,sinc:[4,11,12,14],singl:[4,5,12,13],size:[2,4,5,11,12,14,15],skip:[12,13],skip_first_lin:2,slice:[4,10,15],sln:12,smartli:12,so:[1,2,11,12,13,15],some:[1,4],someth:2,soon:4,sourc:[2,11,12],space:[4,5,11],spars:[0,1,2,4,11,12,14],sparse_arch:11,sparse_featur:[2,4,11],sparse_feature_nam:11,sparse_grad_parameter_nam:[4,13],sparse_nn:11,sparse_path:2,sparsearch:11,sparsefeatur:4,sparsefeaturesalltoal:4,sparsefeaturesindic:4,sparsefeatureslength:4,sparsefeatureslist:4,sparsefeatureslistawait:4,sparsefeatureslistindicesawait:4,sparsefeaturesonetoal:4,sparsiti:0,spec:4,special:[10,12],specialized_spars:12,specif:[4,13],specifi:[2,4,5,10,11,12,13],speed:2,split:[2,4,5,15],squar:12,stabil:4,stabl:[1,2,4,10,15],stack:12,stage:[4,13],stagger:4,standard:4,start:[2,4,15],start_row:2,stat:[0,1,4],state:[4,13,14],state_dict:[4,13,14],statist:5,stdout:5,step:13,still:[4,15],storag:[5,15],storage_constraint:5,storage_reserv:[0,1,4],storage_usag:4,storagereserv:5,store:[4,5],str:[2,3,4,5,10,11,12,13,14,15],strategi:5,stream:[1,2,4,15],streamabl:[0,2,4,15],strict:[4,13],stricter:13,strictli:4,stride:15,string:[2,4,5,12,14],strip:4,structur:10,sub:4,subclass:[4,11,12,13,14],subject:4,submodul:0,subpackag:0,subset:[2,5],subspac:12,successfulli:5,sum:[4,12],suppli:2,support:[4,5,10,12],sure:13,swish:12,swish_layernorm:12,swishlayernorm:12,symbol:[4,10],symbolic_trac:10,sync:[4,15],synonym:5,system:[0,2,4,11],t0:4,t1:[4,11,12,14],t2:[11,12,14],t:[2,4,5,10,12,13],tabl:[4,5,11,12,14],table_0:[12,14],table_1:[12,14],table_column_wis:4,table_name_to_parameter_shard:4,table_name_to_quantized_weight:14,table_row_wis:4,table_wis:4,tables_per_rank:4,tabular:5,take:[1,4,5,11,12,13,14],taken:2,target:[2,4,11],templat:2,temporari:12,tensodr:11,tensor:[1,2,4,5,10,11,12,13,14,15],tensor_await:4,tensor_list:15,term:12,test:[2,12],test_datapip:2,testlazymoduleextensionmixin:12,than:13,thei:4,them:[4,11,12,13,14],thi:[1,2,3,4,10,11,12,13,14,15],those:[2,11,12],though:4,thread:5,three:2,through:[4,10,13],throughout:2,thu:[12,13],time:[4,5],to_dict:15,todai:5,todo:2,togeth:[4,12],top:[4,12],topolog:[4,5],tor:4,torch:[1,2,4,5,10,11,12,13,14,15],torchscript:10,total:[4,5],trace:[4,10],traceabl:4,tracer:[0,1,4],train:[0,2,4,5,11,12,13,14],train_batch:2,train_datapip:2,train_f:4,train_filt:2,train_perc:2,train_pipelin:[0,1],train_t:4,trainabl:13,trained_embed:12,trainpipelin:4,trainpipelinebas:4,trainpipelinecontext:4,trainpipelinesparsedist:4,transfer:[1,4],transform:[4,12],transmit:4,transposebackward0:12,tri:13,trigger:4,truncat:12,tsv:[2,3],tsv_to_npi:2,tune:13,tupl:[2,4,5,10,12,13,14],turn:1,tw:5,tw_shard:[0,1],twcw_shard:[0,1],twcwembeddingshard:4,twembeddingshard:4,twice:4,twinferencepooledembeddingdist:4,twinferencesparsefeaturesdist:4,two:[1,2,4,5,12],twpooledembeddingdist:4,twrw:[4,5],twrw_shard:[0,1],twrwembeddingdist:4,twrwembeddingshard:4,twrwsparsefeaturesdist:4,twsequenceembeddingdist:4,twsparsefeaturesdist:4,txt:2,type:[0,1,2,10,12,14],typic:[4,12,13,15],u_l_i:12,unbucket:4,unbucketize_permute_tensor:4,underli:2,unexpect:4,unexpected_kei:4,uniform:[2,5],uniform_partit:5,uniformpropos:5,uniniti:12,union:[4,5,10,12,13],unit:[4,12],unless:[4,13],unmatch:4,unscor:4,unshard:[4,5],unsharded_module_nam:4,until:4,unus:4,unweight:2,updat:[5,13],upstream:12,upstream_modul:5,us:[1,2,4,5,10,11,12,13,15],usabl:13,usag:[4,5],use_depth:5,user:[5,12,13],usual:[4,12],util:[0,1],uvm:5,v0:[4,15],v1:[4,12,15],v2:[4,12,15],v3:[4,15],v4:[4,15],v5:15,v6:15,v7:15,v:[12,15],v_l:12,v_l_i:12,val:[2,4],val_batch:2,val_datapip:2,val_filt:2,valid:5,valu:[2,4,5,10,11,12,13,14,15],valueerror:5,variabl:[12,15],varibl:4,vector:12,vectorcrossnet:12,verifi:12,versa:[4,13],version:[2,4,12],via:[2,4],view:5,vise:[4,13],visit:0,vjp:4,w0:15,w1:15,w2:15,w3:15,w4:15,w5:15,w6:15,w7:15,w:[4,12,15],w_l:12,wai:[2,5],wait:4,wall:5,warmup:[0,1],warmupoptim:13,warmuppolici:13,warmupstag:13,we:[1,4,5,10,12,13,15],weight:[2,4,5,12,13,14,15],weight_init_max:[4,12],weight_init_min:[4,12],weighted_featur:12,weights_or_non:15,well:[4,5,12,14],were:4,what:13,when:[2,4,10,12,13],where:[4,12,14],whether:[4,10,12,14],which:[1,2,4,5,12,13,15],whole:[4,14],whose:15,wise:[4,5,12],with_arg:14,within:[4,5,11,12,14],won:12,work:[4,12],worker:[2,4],world:[2,4],world_siz:[2,4,5],would:[2,4,5],wrap:[4,13],wrapper:[4,13],www:2,x:[4,11,12,14],x_0:12,x_:12,x_l:12,y:12,yet:[4,12],yield:[4,14],you:[4,10],your:10,z:12,zero:[13,15],zero_grad:13},titles:["Welcome to the TorchRec documentation!","torchrec","torchrec.datasets","torchrec.datasets.scripts","torchrec.distributed","torchrec.distributed.planner","torchrec.github.examples","torchrec.github.examples.dlrm","torchrec.github.examples.dlrm.data","torchrec.github.examples.dlrm.modules","torchrec.fx","torchrec.models","torchrec.modules","torchrec.optim","torchrec.quant","torchrec.sparse"],titleterms:{activ:12,clip:13,collective_util:4,comm:4,comm_op:4,constant:5,content:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],criteo:2,crossnet:12,cw_shard:4,data:8,dataset:[2,3],deepfm:[11,12],dist_data:4,distribut:[4,5],dlrm:[7,8,9,11],dlrm_dataload:8,dlrm_main:7,dlrm_train:9,document:0,dp_shard:4,embed:4,embedding_config:12,embedding_lookup:4,embedding_modul:[12,14],embedding_shard:4,embedding_typ:4,embeddingbag:4,enumer:5,exampl:[6,7,8,9],feature_processor:12,fuse:13,fx:10,github:[6,7,8,9],grouped_position_weight:4,indic:0,jagged_tensor:15,kei:13,lazy_extens:12,mlp:12,model:11,model_parallel:4,modul:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],movielen:2,optim:13,partition:5,perf_model:5,planner:5,preprocess_criteo:3,propos:5,quant:14,quant_embeddingbag:4,random:2,rw_shard:4,score_learn:12,script:3,shard_estim:5,spars:15,stat:5,storage_reserv:5,streamabl:1,submodul:[1,2,3,4,5,7,8,9,10,11,12,13,14,15],subpackag:[1,2,4,6,7,12,13,15],tabl:0,torchrec:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],tracer:10,train_pipelin:4,tw_shard:4,twcw_shard:4,twrw_shard:4,type:[4,5],util:[2,4,5,12],warmup:13,welcom:0}})