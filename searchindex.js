Search.setIndex({"docnames": ["index", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "filenames": ["index.rst", "torchrec.datasets.rst", "torchrec.datasets.scripts.rst", "torchrec.distributed.rst", "torchrec.distributed.planner.rst", "torchrec.distributed.sharding.rst", "torchrec.fx.rst", "torchrec.inference.rst", "torchrec.models.rst", "torchrec.modules.rst", "torchrec.optim.rst", "torchrec.quant.rst", "torchrec.sparse.rst"], "titles": ["Welcome to the TorchRec documentation!", "torchrec.datasets", "torchrec.datasets.scripts", "torchrec.distributed", "torchrec.distributed.planner", "torchrec.distributed.sharding", "torchrec.fx", "torchrec.inference", "torchrec.models", "torchrec.modules", "torchrec.optim", "torchrec.quant", "torchrec.sparse"], "terms": {"i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "pytorch": [0, 1, 3, 9, 12], "domain": 0, "librari": [0, 3, 7], "built": [0, 9], "provid": [0, 3, 4, 7, 8, 9, 11], "common": [0, 1, 9, 12], "sparsiti": 0, "parallel": [0, 1, 3, 5], "primit": [0, 3, 5], "need": [0, 1, 3, 5, 6, 7, 9, 10, 11, 12], "larg": [0, 1], "scale": 0, "recommend": [0, 1, 8], "system": [0, 1, 3, 8], "recsi": [0, 1, 8, 10], "It": [0, 3, 5, 7, 9, 10, 11, 12], "allow": [0, 1, 3, 6, 9, 10], "author": [0, 3, 7], "train": [0, 1, 3, 4, 5, 7, 8, 9, 10, 11], "model": [0, 3, 4, 5, 6, 7, 9, 10, 11], "embed": [0, 4, 5, 8, 9, 11, 12], "shard": [0, 3, 4, 7, 9, 10], "across": [0, 1, 3, 5], "mani": [0, 3, 5], "gpu": [0, 3, 7], "For": [0, 3, 5, 8, 9, 10], "instal": 0, "instruct": 0, "visit": 0, "http": [0, 1, 3, 8, 9, 12], "github": [0, 9], "com": [0, 1, 9], "readm": 0, "In": [0, 3, 9, 10], "thi": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12], "we": [0, 1, 3, 4, 5, 6, 7, 9, 10, 11, 12], "introduc": [0, 10], "primari": [0, 7], "call": [0, 1, 3, 4, 5, 7, 9, 10, 11], "distributedmodelparallel": [0, 3], "dmp": [0, 3], "like": [0, 3, 4, 5, 9, 10], "": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "distributeddataparallel": [0, 3], "wrap": [0, 3, 5, 8, 10], "enabl": [0, 1, 3, 4, 5, 10], "distribut": [0, 1, 7, 10], "sourc": [0, 1, 8, 9], "open": [0, 1], "googl": 0, "colab": 0, "dataset": [0, 8], "criteo": [0, 2, 8], "movielen": 0, "random": [0, 8], "util": [0, 5], "script": [0, 1, 12], "contiguous_preproc_criteo": 0, "npy_preproc_criteo": [0, 1], "collective_util": 0, "comm": 0, "comm_op": 0, "dist_data": 0, "embedding_lookup": 0, "embedding_shard": 0, "embedding_typ": 0, "embeddingbag": [0, 4, 8, 9, 11], "grouped_position_weight": 0, "model_parallel": 0, "quant_embeddingbag": 0, "train_pipelin": [0, 8], "type": [0, 1, 5, 6, 7, 8, 9, 11, 12], "planner": [0, 3], "constant": [0, 10], "enumer": [0, 3, 9, 10], "partition": 0, "perf_model": 0, "propos": [0, 8], "shard_estim": 0, "stat": 0, "storage_reserv": 0, "cw_shard": 0, "dp_shard": 0, "rw_shard": 0, "tw_shard": 0, "twcw_shard": 0, "twrw_shard": 0, "fx": [0, 7], "tracer": [0, 3], "modul": [0, 3, 4, 5], "infer": [0, 3, 4, 5, 11], "model_packag": 0, "deepfm": 0, "dlrm": [0, 7], "activ": [0, 11], "crossnet": [0, 8], "embedding_config": [0, 3, 11], "embedding_modul": 0, "feature_processor": [0, 3, 5], "lazy_extens": 0, "mlp": [0, 8], "optim": [0, 3, 4], "clip": 0, "fuse": [0, 3, 9], "kei": [0, 1, 3, 5, 7, 8, 9, 11, 12], "warmup": 0, "quant": [0, 3], "spars": [0, 1, 2, 3, 5, 8, 9, 11], "jagged_tensor": [0, 1, 3], "index": [0, 12], "search": 0, "page": 0, "contain": [1, 3, 7, 9, 10, 11], "two": [1, 3, 4, 5, 8, 9], "popular": [1, 8], "reci": 1, "kaggl": 1, "displai": 1, "advertis": 1, "20m": 1, "addition": 1, "randomdataset": 1, "which": [1, 3, 4, 5, 7, 9, 10, 12], "us": [1, 3, 4, 6, 7, 8, 9, 10, 11, 12], "gener": [1, 3, 4, 6, 7, 8, 9, 10, 12], "data": [1, 3, 4, 5, 6, 8, 9, 11, 12], "same": [1, 3, 4, 5, 7, 8, 9, 11, 12], "format": [1, 2, 7], "abov": [1, 9, 12], "lastli": 1, "pre": [1, 9, 10], "process": [1, 2, 3, 4, 5, 8, 9, 11], "load": [1, 4, 10], "etc": [1, 3, 7, 10, 12], "exampl": [1, 3, 4, 5, 7, 8, 9, 10, 11, 12], "from": [1, 3, 5, 6, 7, 8, 9, 10, 11, 12], "import": [1, 9, 11], "criteo_kaggl": 1, "datapip": 1, "criteo_terabyt": 1, "home": 1, "day_0": 1, "tsv": [1, 2], "day_1": 1, "dp": [1, 4], "iter": [1, 3, 4, 9, 10], "batcher": 1, "100": [1, 8, 9], "collat": 1, "batch": [1, 3, 4, 5, 7, 8, 9, 11, 12], "next": [1, 4], "class": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "binarycriteoutil": 1, "base": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "object": [1, 3, 4, 7, 9, 10, 11], "function": [1, 2, 3, 4, 5, 6, 7, 9, 10], "preprocess": [1, 2], "save": [1, 2, 3, 9, 10], "partit": [1, 4, 5], "binari": [1, 2], "numpi": 1, "static": [1, 3, 10, 12], "get_file_idx_to_row_rang": 1, "length": [1, 3, 4, 5, 8, 9, 11, 12], "list": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "int": [1, 3, 4, 5, 6, 8, 9, 10, 11, 12], "rank": [1, 3, 4, 5, 8, 9, 10], "world_siz": [1, 3, 4, 5], "dict": [1, 3, 4, 5, 6, 7, 9, 10, 11, 12], "tupl": [1, 3, 4, 6, 7, 8, 9, 10, 11], "given": [1, 3, 4, 5, 6, 9], "number": [1, 3, 4, 5, 8, 9, 12], "row": [1, 3, 5], "file": [1, 2, 3], "return": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "portion": 1, "those": [1, 8, 9], "repres": [1, 3, 4, 7, 8, 9, 11, 12], "rang": 1, "all": [1, 3, 4, 5, 7, 8, 9, 10], "indic": [1, 3, 5, 7, 9, 10, 11, 12], "ar": [1, 3, 4, 5, 7, 8, 9, 10, 11, 12], "inclus": 1, "should": [1, 3, 7, 8, 9, 10, 12], "handl": [1, 3, 5, 6, 7, 9], "each": [1, 3, 4, 5, 8, 9, 11, 12], "assign": [1, 12], "The": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "determin": [1, 3, 4], "wai": [1, 4], "deal": 1, "continu": 1, "reduc": [1, 3, 5, 9, 11], "amount": 1, "read": 1, "while": [1, 3, 6, 7, 9], "avoid": [1, 3, 7, 9, 10, 11], "seek": 1, "paramet": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "A": [1, 3, 5, 6, 7, 10, 12], "count": [1, 9], "world": [1, 3, 5], "size": [1, 3, 4, 5, 8, 9, 11, 12], "map": [1, 3, 9, 10, 11], "output": [1, 3, 4, 5, 7, 8, 9, 11], "get_shape_from_npi": 1, "path": [1, 3, 4, 7], "str": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "path_manager_kei": 1, "shape": [1, 3, 5, 8, 9, 12], "an": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "npy": [1, 2], "onli": [1, 3, 4, 5, 9], "its": [1, 3, 4, 5, 9, 10], "header": 1, "input": [1, 3, 4, 5, 6, 7, 8, 9, 11, 12], "manag": 1, "differ": [1, 3, 5, 9, 10, 12], "filesystem": 1, "load_npy_rang": 1, "fname": 1, "start_row": 1, "num_row": 1, "mmap_mod": 1, "bool": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "fals": [1, 3, 4, 5, 7, 9, 10, 11, 12], "ndarrai": 1, "part": [1, 3, 4, 5, 9, 10], "note": [1, 3, 5, 9, 12], "assum": [1, 3, 5, 7, 8, 10], "arrai": 1, "ndim": 1, "2": [1, 3, 4, 5, 8, 9, 10, 11, 12], "string": [1, 4, 7, 9], "start": [1, 3, 12], "get": [1, 3, 4, 5], "desir": 1, "suppli": 1, "np": 1, "shuffl": [1, 5], "input_dir_labels_and_dens": 1, "input_dir_spars": 1, "output_dir_shuffl": 1, "rows_per_dai": 1, "output_dir_full_set": 1, "option": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "none": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "dai": 1, "24": 1, "int_column": 1, "13": 1, "sparse_column": 1, "26": 1, "random_se": 1, "0": [1, 3, 4, 5, 8, 9, 10, 11, 12], "expect": [1, 2, 4, 8, 9], "split": [1, 3, 4, 5, 7, 12], "dens": [1, 3, 8, 9, 12], "label": [1, 8], "must": [1, 3, 4, 7, 8, 9], "day_x_dens": 1, "day_x_spars": 1, "day_x_label": 1, "reconstruct": 1, "back": 1, "separ": [1, 2, 3], "first": [1, 3, 4, 5, 8, 9, 10, 12], "1": [1, 3, 4, 5, 8, 9, 10, 11, 12], "set": [1, 3, 7, 9, 10, 11], "final": [1, 3, 4, 5, 8, 9, 11, 12], "remain": 1, "untouch": 1, "valid": [1, 4, 12], "directori": 1, "full": [1, 9, 10, 12], "column": [1, 4, 5], "featur": [1, 2, 3, 4, 5, 8, 9, 11, 12], "total": [1, 3, 4, 5], "seed": 1, "oper": [1, 3, 5, 6, 9, 12], "sparse_to_contigu": 1, "in_fil": 1, "output_dir": 1, "frequency_threshold": 1, "3": [1, 3, 4, 5, 8, 9, 10, 11, 12], "output_file_suffix": 1, "_contig_freq": 1, "convert": [1, 3, 6, 7], "have": [1, 3, 4, 5, 8, 9, 10, 12], "contigu": [1, 2], "integ": 1, "store": [1, 3, 4, 5], "togeth": [1, 3, 9], "becaus": [1, 9, 10], "can": [1, 3, 4, 7, 8, 9, 10, 12], "match": [1, 3, 4, 7, 8, 9], "id": [1, 3, 4, 5, 9], "between": [1, 3, 4, 7, 8, 9, 12], "henc": 1, "thei": [1, 3], "transform": [1, 3, 7, 9], "also": [1, 3, 7, 8, 9, 10, 11], "uniqu": 1, "appear": [1, 3], "less": 1, "than": [1, 10], "time": [1, 3, 4, 7], "remap": 1, "valu": [1, 3, 4, 5, 6, 8, 9, 10, 11, 12], "frequenchy_threshold": 1, "day_0_spars": 1, "col_0": 1, "col_1": 1, "abc": [1, 3, 4, 7, 9, 10], "xyz": 1, "iop": 1, "day_1_spars": 1, "tuv": 1, "lkj": 1, "day_0_sparse_contig": 1, "day_1_sparse_contig": 1, "out_dir": 1, "occur": 1, "frequenc": 1, "tsv_to_npi": 1, "out_dense_fil": 1, "out_sparse_fil": 1, "out_labels_fil": 1, "one": [1, 3, 5, 7, 8, 9, 10], "three": 1, "float32": [1, 3, 7, 11], "int32": 1, "criteoiterdatapip": 1, "row_mapp": 1, "callabl": [1, 3, 5, 6, 9, 10], "ani": [1, 3, 4, 5, 6, 7, 9, 10, 11, 12], "_default_row_mapp": 1, "open_kw": 1, "iterdatapip": 1, "stream": [1, 3, 12], "either": [1, 3, 9], "1tb": 1, "click": 1, "log": [1, 4], "ailab": 1, "download": 1, "www": 1, "c": [1, 3, 5, 7, 12], "ad": [1, 3, 7, 9, 10, 11], "challeng": 1, "local": [1, 3, 5], "constitut": 1, "appli": [1, 3, 5, 8, 9], "line": [1, 2], "pass": [1, 3, 7, 9, 10, 11, 12], "underli": 1, "invoc": 1, "iopath": 1, "file_io": 1, "pathmanag": 1, "inmemorybinarycriteoiterdatapip": [1, 2], "dense_path": 1, "sparse_path": 1, "labels_path": 1, "batch_siz": [1, 3, 4, 5, 9], "shuffle_batch": 1, "hash": [1, 5], "iterabledataset": 1, "design": [1, 3, 7, 9, 11], "over": [1, 3, 5, 8, 9], "version": [1, 3, 9, 11], "entir": [1, 5], "memori": [1, 3, 4, 10], "prevent": 1, "disk": 1, "speed": [1, 11], "affect": 1, "throughout": [1, 8], "respons": [1, 3], "py": [1, 7], "whether": [1, 3, 4, 5, 6, 9, 11], "max": [1, 10], "categor": 1, "cat_feature_count": 1, "templat": 1, "1tb_binari": 1, "day_": 1, "_": 1, "1024": 1, "torch": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "get_rank": 1, "get_world_s": [1, 7], "root": [1, 3, 6], "test": [1, 9], "train_datapip": 1, "txt": 1, "test_datapip": 1, "movielens_20m": 1, "include_movies_data": 1, "param": [1, 3, 10], "true": [1, 3, 4, 7, 9, 10, 11], "add": [1, 3, 6, 9, 10], "movi": 1, "ml": 1, "20": [1, 8, 9], "movielens_25m": 1, "25m": 1, "25": 1, "randomrecdataset": 1, "hash_siz": 1, "ids_per_featur": 1, "num_dens": 1, "50": 1, "manual_se": 1, "num_batch": 1, "num_generated_batch": 1, "10": [1, 8, 9, 11, 12], "current": [1, 3, 4, 7, 9, 11], "produc": [1, 3], "unweight": 1, "todo": 1, "weight": [1, 3, 4, 5, 7, 8, 9, 10, 11, 12], "name": [1, 3, 4, 7, 8, 9, 10, 11, 12], "taken": [1, 4], "modulo": 1, "per": [1, 3, 4, 5, 9, 12], "correspond": [1, 3, 4, 5, 7, 9, 11, 12], "argument": [1, 3, 6, 7, 9, 11], "ignor": [1, 3, 7, 9], "determinist": 1, "behavior": [1, 3, 6, 10], "num": 1, "befor": [1, 3, 5, 9, 10], "rais": [1, 3, 4], "stopiter": 1, "cach": [1, 4], "If": [1, 3, 4, 7, 9, 10, 11, 12], "num_gener": 1, "cycl": 1, "neg": 1, "fly": 1, "feat1": 1, "feat2": 1, "16": [1, 9], "100_000": 1, "dense_featur": [1, 8, 9], "tensor": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "sparse_featur": [1, 3, 5, 8], "keyedjaggedtensor": [1, 3, 5, 8, 9, 11, 12], "pipelin": [1, 3, 9, 12], "pin_memori": [1, 12], "record_stream": [1, 3, 12], "see": [1, 3, 4, 5, 6, 9, 12], "org": [1, 3, 8, 12], "doc": [1, 3, 12], "stabl": [1, 3, 12], "html": [1, 3, 12], "devic": [1, 3, 4, 5, 6, 7, 8, 9, 11, 12], "non_block": [1, 12], "pleas": [1, 3, 7, 9, 11, 12], "awar": [1, 3, 12], "accoard": [1, 12], "might": [1, 4, 12], "self": [1, 3, 4, 9, 12], "copi": [1, 3, 5, 7, 9, 10, 11, 12], "so": [1, 3, 8, 9, 10, 12], "rememb": [1, 3, 12], "new_devic": [1, 12], "limit": [1, 9], "loadfil": 1, "mode": [1, 3, 4], "b": [1, 3, 5, 8, 9, 11, 12], "iobas": 1, "adapt": [1, 9], "loadfilesfromdisk": 1, "merg": [1, 3, 5], "replac": [1, 10], "someth": 1, "core": 1, "lib": 1, "parallelreadconcat": 1, "dp_selector": 1, "sequenc": [1, 3, 5], "_default_dp_selector": 1, "concaten": [1, 3, 5, 8, 9, 12], "multipl": [1, 3, 4, 8, 9, 10], "when": [1, 3, 6, 9, 10], "dataload": [1, 3], "subset": [1, 4], "worker": [1, 3], "instanc": [1, 3, 6, 7, 9], "would": [1, 3, 5], "f": [1, 3, 5, 8, 9, 11], "shard_": 1, "idx": [1, 3], "4": [1, 3, 4, 5, 8, 9, 11, 12], "num_work": 1, "readlinesfromcsv": 1, "skip_first_lin": 1, "kw": 1, "idx_split_train_v": 1, "train_perc": 1, "float": [1, 3, 4, 6, 9, 10, 12], "decimal_plac": 1, "key_fn": 1, "_default_key_fn": 1, "rand_split_train_v": 1, "via": [1, 3], "uniform": [1, 4], "sampl": [1, 4, 9], "disjoint": 1, "val": [1, 3], "specifi": [1, 3, 4, 5, 6, 8, 9, 10], "target": [1, 3, 8], "proport": 1, "includ": [1, 3, 4, 7, 9, 11, 12], "actual": [1, 3, 5, 7, 9], "guarante": [1, 3, 6, 10], "exactli": [1, 3], "membership": 1, "consist": [1, 3], "val_datapip": 1, "75": 1, "train_batch": 1, "val_batch": 1, "safe_cast": 1, "t": [1, 3, 4, 5, 6, 7, 9, 10], "dest_typ": 1, "default": [1, 3, 6, 7, 8, 9, 10, 11, 12], "train_filt": 1, "val_filt": 1, "main": 2, "argv": 2, "result": [2, 3, 4, 5, 7, 9, 11], "command": 2, "arg": [2, 3, 7, 9, 11, 12], "parse_arg": 2, "namespac": [2, 3, 12], "raw": [2, 9], "necessari": [3, 4], "These": [3, 7, 9], "through": [3, 6, 10], "collect": [3, 5, 8, 9, 10, 11], "scatter": [3, 5], "wrapper": [3, 10], "kjt": [3, 4, 5, 8, 9, 11, 12], "variou": [3, 9], "implement": [3, 5, 7, 8, 9, 10, 12], "shardedembeddingbag": 3, "nn": [3, 4, 6, 8, 9], "shardedembeddingbagcollect": 3, "embeddingbagcollect": [3, 8, 9, 11], "sharder": [3, 4], "defin": [3, 7, 8, 9], "support": [3, 4, 5, 6, 9], "comput": [3, 4, 7, 8, 9, 11], "kernel": [3, 4, 9], "cpu": [3, 4], "mai": [3, 12], "tabl": [3, 4, 5, 8, 9, 11], "fusion": [3, 9], "trainpipelinesparsedist": 3, "overlap": 3, "transfer": 3, "inter": 3, "commun": [3, 5], "input_dist": [3, 9], "forward": [3, 5, 7, 8, 9, 11], "backward": [3, 6, 10], "increas": 3, "perform": [3, 4, 5, 7, 9, 10, 11], "quantiz": [3, 5, 11], "precis": [3, 11], "construct": [3, 6, 9, 12], "control": [3, 6], "flow": [3, 6], "invoke_on_rank_and_broadcast_result": 3, "pg": [3, 4, 5], "processgroup": [3, 4, 5], "func": 3, "kwarg": [3, 9, 12], "invok": 3, "broadcast": [3, 4], "member": [3, 9], "within": [3, 4, 5, 7, 8, 9], "group": [3, 4, 5, 9, 10, 12], "allocate_id": 3, "is_lead": 3, "leader_rank": 3, "check": [3, 4, 9, 10], "processs": 3, "leader": 3, "dist": [3, 5], "being": [3, 7, 9, 11], "impli": 3, "e": [3, 5, 6, 7, 8, 9, 10, 11], "g": [3, 7, 8, 9, 10, 11], "singl": [3, 4, 5, 9, 10], "program": 3, "definit": [3, 7], "caller": 3, "overrid": [3, 7], "context": 3, "specif": [3, 4, 7, 10], "run_on_lead": 3, "get_group_rank": 3, "avail": [3, 4, 5], "group_rank": 3, "environ": [3, 7], "varibl": 3, "get_num_group": 3, "elast": 3, "run": [3, 7, 9, 10, 11], "get_local_rank": 3, "usual": [3, 9], "node": [3, 6], "get_local_s": 3, "equival": 3, "max_nnod": 3, "intra_and_cross_node_pg": 3, "backend": [3, 5, 7], "nccl": [3, 5], "creat": [3, 6, 7, 9, 10, 11, 12], "sub": 3, "intra": 3, "cross": [3, 8, 9], "all2alldenseinfo": 3, "output_split": [3, 5], "input_shap": 3, "input_split": [3, 5], "attribut": [3, 4, 10], "alltoall_dens": 3, "all2allpooledinfo": 3, "batch_size_per_rank": [3, 5], "dim_sum_per_rank": [3, 5], "dim_sum_per_rank_tensor": 3, "cumsum_dim_sum_per_rank_tensor": 3, "codec": [3, 5], "quantizedcommcodec": [3, 5], "alltoall_pool": [3, 5], "sum": [3, 5, 9], "dimens": [3, 4, 5, 8, 9, 11, 12], "fast": 3, "_recat_pooled_embedding_grad_out": 3, "cumul": [3, 12], "b_local": 3, "all2allsequenceinfo": 3, "embedding_dim": [3, 5, 8, 9, 11], "lengths_after_sparse_data_all2al": 3, "forward_recat_tensor": 3, "backward_recat_tensor": 3, "permuted_lengths_after_sparse_data_all2al": 3, "alltoall_sequ": 3, "after": [3, 4, 5, 9], "alltoal": [3, 5], "recat": [3, 5], "lengths_sparse_before_features_all2al": 3, "all2allvinfo": 3, "dims_sum_per_rank": 3, "b_global": 3, "b_local_list": 3, "d_local_list": 3, "input_split_s": 3, "factori": [3, 4, 9], "output_split_s": 3, "alltoallv": 3, "global": [3, 5], "my": 3, "how": [3, 4, 5, 7, 10], "do": [3, 9, 10, 12], "all_to_all_singl": 3, "fill": 3, "all2all_pooled_req": 3, "ctx": 3, "unus": 3, "formula": 3, "differenti": 3, "automat": [3, 4], "alia": 3, "vjp": 3, "overridden": [3, 7, 9], "subclass": [3, 7, 9, 10], "accept": [3, 7, 9, 11], "follow": [3, 5, 8, 9, 10, 12], "non": [3, 4, 9, 11], "were": 3, "gradient": [3, 4, 10], "w": [3, 9, 12], "r": [3, 9], "requir": [3, 4, 5, 9, 10], "grad": [3, 10], "you": [3, 5, 6, 12], "just": [3, 4, 8, 9], "retriev": 3, "dure": [3, 10], "ha": [3, 4, 8, 9, 12], "needs_input_grad": 3, "boolean": 3, "myreq": 3, "request": [3, 7, 10], "a2ai": 3, "input_embed": [3, 9], "other": [3, 4, 10], "arbitrari": 3, "directli": [3, 10], "though": 3, "enforc": [3, 7, 9, 11], "compat": [3, 6, 8, 10], "instead": [3, 7, 9, 10], "save_for_backward": 3, "intend": 3, "save_for_forward": 3, "jvp": 3, "all2all_pooled_wait": 3, "grad_output": 3, "dummy_tensor": 3, "all2all_seq_req": 3, "sharded_input_embed": 3, "all2all_seq_req_wait": 3, "sharded_grad_output": 3, "all2allv_req": 3, "all2allv_wait": 3, "allgatherbaseinfo": 3, "input_s": 3, "all_gatther_base_pool": 3, "allgatherbase_req": 3, "agi": 3, "allgatherbase_wait": 3, "reducescatterbaseinfo": 3, "reduce_scatter_base_pool": 3, "flatten": [3, 5, 9], "reducescatterbase_req": 3, "rsi": 3, "reducescatterbase_wait": 3, "reducescatterinfo": 3, "reduce_scatter_pool": 3, "reducescattervinfo": 3, "equal_split": 3, "total_input_s": 3, "reduce_scatter_v_pool": 3, "along": [3, 5, 8, 10, 12], "dim0": [3, 5], "reducescatterv_req": 3, "reducescatterv_wait": 3, "reducescatter_req": 3, "reducescatter_wait": 3, "await": [3, 5, 6], "all_gather_base_pool": 3, "gather": [3, 5], "form": [3, 9, 11], "pool": [3, 4, 5, 8, 9, 11, 12], "divid": 3, "work": [3, 4, 7, 9], "async": [3, 5], "wait": [3, 5], "later": [3, 9], "experiment": 3, "subject": 3, "chang": [3, 9, 10], "a2a_pooled_embs_tensor": 3, "Then": 3, "receiv": [3, 10], "Its": 3, "x": [3, 5, 8, 9, 11], "d_local_sum": 3, "where": [3, 5, 8, 9, 11], "a2a_sequence_embs_tensor": 3, "l_i": 3, "d": [3, 8, 9, 11], "doe": [3, 8, 9, 10], "mix": 3, "out_split": 3, "per_rank_split_length": 3, "assumpt": 3, "emb": 3, "chunk": [3, 5], "v": [3, 5, 9, 12], "unevenli": 3, "accord": [3, 4, 5, 7, 8, 10], "set_gradient_divis": 3, "embeddingsalltoon": [3, 5], "cat_dim": [3, 5, 12], "buffer": [3, 5, 7, 9, 11], "alloc": [3, 5, 7], "topologi": [3, 4, 5], "alltoon": [3, 5], "kjtalltoal": [3, 5], "stagger": [3, 5], "variable_batch_s": [3, 5], "redistribut": [3, 5], "transmit": [3, 5], "correct": [3, 5], "space": [3, 4, 5, 8], "len": [3, 5, 8], "send": [3, 5], "order": [3, 5, 7, 9, 11], "destin": [3, 5, 7, 9, 11], "_recat": [3, 5], "more": [3, 4, 5], "detail": [3, 4, 5, 9], "variabl": [3, 5, 9, 11, 12], "kjta2a": [3, 5], "rank0_input": [3, 5], "hold": [3, 5, 10, 12], "v0": [3, 5, 12], "v1": [3, 5, 9, 12], "v2": [3, 5, 8, 9, 12], "rank1_input": [3, 5], "v3": [3, 5, 12], "v4": [3, 5, 12], "rank0_output": [3, 5], "5": [3, 5, 8, 9, 11, 12], "rank1_output": [3, 5], "kjtalltoallindicesawait": [3, 5], "relev": [3, 4, 5], "issu": [3, 5, 9], "second": [3, 4, 5, 8, 12], "in_lengths_per_work": [3, 5], "out_lengths_per_work": [3, 5], "all2al": [3, 5], "reorder": [3, 5], "kjtalltoalllengthsawait": [3, 5], "instanti": [3, 5], "kjtonetoal": [3, 5], "onetoal": [3, 5], "essenti": [3, 5], "p2p": [3, 5], "keyjaggedtensor": [3, 5], "them": [3, 5, 7, 8, 9, 10], "slice": [3, 5, 6, 12], "pooledembeddingsallgath": [3, 5], "layout": [3, 5, 6], "happen": [3, 5], "init_distribut": [3, 5], "new_group": [3, 5], "randn": [3, 5, 8, 9], "m": [3, 5, 9], "local_emb": [3, 5], "pooledembeddingsawait": [3, 5], "num_bucket": [3, 5], "pooledembeddingsalltoal": [3, 5], "callback": [3, 5], "a2a": [3, 5], "t0": [3, 5], "rand": [3, 5, 8], "6": [3, 5, 8, 9, 11, 12], "t1": [3, 5, 8, 9, 11], "print": [3, 5, 9, 11], "properti": [3, 4, 5, 7, 8, 10], "tensor_await": [3, 5], "pooledembeddingsreducescatt": [3, 5], "wise": [3, 4, 5, 9], "twrw": [3, 4, 5], "unequ": [3, 5], "bucket": [3, 5], "seqembeddingsalltoon": [3, 5], "concat": [3, 5, 9, 12], "sequenceembeddingsalltoal": [3, 5], "features_per_rank": [3, 5], "sharding_ctx": [3, 5], "sequenceshardingcontext": [3, 5], "lengths_after_input_dist": [3, 5], "unbucketize_permute_tensor": [3, 5], "sequenceembeddingsawait": [3, 5], "permut": [3, 5, 12], "embeddingcollectionawait": 3, "lazyawait": 3, "jaggedtensor": [3, 9, 11, 12], "embeddingcollectioncontext": 3, "sharding_context": 3, "sequence_shard": 3, "shardedmodulecontext": 3, "embeddingcollectionshard": 3, "fused_param": [3, 5], "qcomm_codecs_registri": [3, 5], "baseembeddingshard": 3, "embeddingcollect": [3, 9, 11], "module_typ": 3, "parametershard": 3, "env": [3, 5], "shardingenv": [3, 5], "shardedembeddingcollect": 3, "locat": 3, "replic": [3, 5], "fulli": [3, 4, 10], "qualifi": 3, "spec": 3, "shardedmodul": 3, "shardable_paramet": 3, "sharding_typ": [3, 4], "compute_device_typ": 3, "shardingtyp": [3, 4], "well": [3, 4, 9], "known": [3, 4], "table_name_to_parameter_shard": 3, "sparsefeatureslist": [3, 5], "fusedoptimizermodul": [3, 10], "public": [3, 9], "api": [3, 6, 9], "manual": [3, 8, 10], "dist_input": 3, "compute_and_output_dist": 3, "case": [3, 9, 10, 12], "make": [3, 9, 10], "sens": [3, 9, 10], "method": [3, 6, 7, 9], "initi": [3, 9, 10], "distibut": 3, "soon": 3, "complet": [3, 4], "create_context": 3, "fused_optim": [3, 10], "keyedoptim": [3, 10], "lengths_dist": 3, "sparsefeatureslistindicesawait": 3, "load_state_dict": [3, 10], "state_dict": [3, 7, 9, 10, 11], "ordereddict": [3, 7, 9, 11], "strict": [3, 10], "_incompatiblekei": 3, "descend": 3, "persist": [3, 7, 9, 11], "strictli": 3, "missing_kei": 3, "miss": 3, "unexpected_kei": 3, "unexpect": 3, "namedtupl": 3, "field": [3, 9, 10], "regist": [3, 7, 9], "exist": [3, 5, 7], "runtimeerror": 3, "named_buff": [3, 9], "prefix": [3, 7, 9, 11], "recurs": [3, 9], "remove_dupl": 3, "yield": [3, 9], "both": [3, 7, 8, 9, 10, 11], "itself": [3, 8, 9], "prepend": [3, 9], "submodul": [3, 9, 10], "otherwis": [3, 7, 9, 10, 11, 12], "direct": [3, 9], "xdoctest": [3, 7, 9, 11], "skip": [3, 7, 9, 10, 11], "undefin": [3, 7, 9, 11], "var": [3, 7, 9, 11], "buf": [3, 9], "running_var": [3, 9], "named_modul": 3, "memo": 3, "network": [3, 4, 9, 10], "alreadi": [3, 5, 7, 10], "remov": [3, 6], "duplic": [3, 10], "onc": [3, 9], "l": [3, 9, 11], "linear": [3, 4, 9, 10], "net": [3, 8, 9], "sequenti": [3, 4, 9], "in_featur": [3, 8, 9], "out_featur": [3, 9], "bia": [3, 7, 9, 11], "named_paramet": 3, "output_dist": 3, "sharded_parameter_nam": 3, "sparse_grad_parameter_nam": [3, 9, 10], "keep_var": [3, 7, 9, 11], "dictionari": [3, 7, 9, 11], "refer": [3, 7, 9, 11, 12], "whole": [3, 7, 9, 11], "state": [3, 7, 9, 10, 11], "averag": [3, 4, 7, 9, 11], "shallow": [3, 7, 9, 11], "posit": [3, 5, 7, 9, 11], "howev": [3, 7, 9, 10, 11], "deprec": [3, 7, 9, 11], "keyword": [3, 7, 9, 11], "futur": [3, 7, 9, 11], "releas": [3, 7, 9, 11], "end": [3, 4, 7, 9, 11], "user": [3, 4, 7, 9, 10, 11], "updat": [3, 4, 7, 9, 10, 11], "compos": [3, 7, 9, 11], "detach": [3, 7, 9, 11], "autograd": [3, 7, 9, 11], "create_embedding_shard": 3, "sharding_info": [3, 5], "embeddingshardinginfo": [3, 5], "embeddingshard": [3, 5], "sparsefeatur": [3, 5], "create_sharding_infos_by_shard": 3, "embeddingcollectioninterfac": [3, 9, 11], "groupedembeddingslookup": 3, "grouped_config": 3, "groupedembeddingconfig": 3, "baseembeddinglookup": [3, 5], "everi": [3, 4, 7, 9], "although": [3, 7, 9], "recip": [3, 7, 9], "afterward": [3, 7, 9], "sinc": [3, 7, 9], "former": [3, 7, 9], "take": [3, 4, 7, 9, 10], "care": [3, 7, 9], "hook": [3, 7, 9], "latter": [3, 7, 9], "silent": [3, 7, 9], "union": [3, 4, 6, 7, 9, 10], "shardedtensor": [3, 10], "groupedpooledembeddingslookup": 3, "grouped_score_config": 3, "basegroupedfeatureprocessor": [3, 5, 9], "infergroupedembeddingslookup": 3, "grouped_configs_per_rank": 3, "infergroupedlookupmixin": 3, "infergroupedpooledembeddingslookup": 3, "grouped_score_configs_per_rank": 3, "metainfergroupedembeddingslookup": 3, "meta": 3, "lookup": [3, 4, 8, 9, 11], "tbe": 3, "op": [3, 5, 10, 11], "metainfergroupedpooledembeddingslookup": 3, "bag": [3, 5, 8], "baseembeddingdist": [3, 5], "embeddinglookup": 3, "abstract": [3, 4, 7, 9, 10], "basesparsefeaturesdist": [3, 5], "featureshardingmixin": 3, "table_wis": 3, "create_input_dist": [3, 5], "create_lookup": [3, 5], "create_output_dist": [3, 5], "embedding_nam": [3, 5, 9], "embedding_names_per_rank": [3, 5], "embedding_shard_metadata": [3, 5], "shardmetadata": [3, 5], "embeddingtableconfig": [3, 9], "param_shard": 3, "nonetyp": [3, 9], "listofsparsefeatureslistawait": 3, "listofsparsefeatureslist": 3, "sparsefeaturesalltoal": 3, "id_list_features_per_rank": [3, 5], "id_score_list_features_per_rank": [3, 5], "score": [3, 4, 5], "sfa2a": 3, "id_list_featur": 3, "id_score_list_featur": 3, "sparsefeaturesindicesawait": 3, "id_list_features_await": 3, "id_score_list_features_await": 3, "sparsefeatureslengthsawait": 3, "trigger": 3, "again": 3, "sparsefeatureslistawait": 3, "layer": [3, 8, 9, 10], "sparsefeaturesonetoal": 3, "bucketize_kjt_before_all2al": 3, "block_siz": 3, "output_permut": 3, "bucketize_po": 3, "readjust": 3, "unbucket": 3, "group_tabl": 3, "tables_per_rank": 3, "shardedembeddingt": 3, "datatyp": [3, 9, 11, 12], "poolingtyp": [3, 9], "embeddingcomputekernel": 3, "unscor": 3, "interfac": [3, 7, 9], "reli": [3, 7, 9, 11], "moduleshard": [3, 4], "compute_kernel": [3, 4], "storage_usag": 3, "resourc": 3, "usag": [3, 4, 7], "processor": [3, 4, 5, 9], "basequantembeddingshard": 3, "embeddingattribut": 3, "enum": [3, 4, 9, 10], "fused_uvm": 3, "fused_uvm_cach": 3, "quant_uvm": 3, "quant_uvm_cach": 3, "data_typ": [3, 9, 11], "is_weight": [3, 4, 9, 11, 12], "has_feature_processor": [3, 4, 5, 9], "embedding_t": 3, "dim_sum": 3, "feature_hash_s": 3, "feature_nam": [3, 8, 9, 11], "num_featur": [3, 8, 9], "multistream": 3, "optimtyp": 3, "adagrad": [3, 10], "adam": [3, 10], "lamb": 3, "lars_sgd": 3, "partial_rowwise_adam": 3, "partial_rowwise_lamb": 3, "rowwise_adagrad": 3, "sgd": 3, "shampoo": 3, "shardedconfig": 3, "local_row": [3, 4], "local_col": [3, 4], "num_embed": [3, 8, 9, 11], "fp32": [3, 9], "weight_init_max": [3, 9], "weight_init_min": [3, 9], "need_po": [3, 5, 9], "local_metadata": 3, "_shard": 3, "metadata": [3, 7], "global_metadata": 3, "sharded_tensor": 3, "shardedtensormetadata": 3, "shardedmetaconfig": 3, "compute_kernel_to_embedding_loc": 3, "embeddingloc": 3, "embeddingawait": 3, "embeddingbagcollectionawait": 3, "keyedtensor": [3, 8, 9, 11, 12], "embeddingbagcollectionshard": 3, "embeddingbagshard": 3, "offset": [3, 4, 8, 9, 11, 12], "per_sample_weight": 3, "embeddingbagcollectioninterfac": [3, 9, 11], "create_embedding_bag_shard": 3, "permute_embed": [3, 5], "replace_placement_with_meta_devic": 3, "placement": [3, 4], "could": 3, "unmatch": 3, "some": [3, 8], "scenario": 3, "cuda": [3, 7], "embeddingshardingplann": [3, 4], "groupedpositionweightedmodul": 3, "max_feature_length": [3, 9], "dataparallelwrapp": 3, "custom": [3, 6, 9], "defaultdataparallelwrapp": 3, "unshard": [3, 4, 9], "plan": [3, 4, 9], "shardingplan": [3, 4], "init_data_parallel": 3, "init_paramet": 3, "data_parallel_wrapp": 3, "entri": 3, "point": 3, "collective_plan": [3, 4], "lazi": [3, 9, 10], "delai": 3, "until": 3, "still": [3, 12], "no_grad": [3, 9], "def": [3, 7, 9], "init_weight": [3, 9], "isinst": 3, "fill_": [3, 9], "elif": 3, "init": 3, "kaiming_normal_": 3, "mymodel": 3, "bare_named_paramet": 3, "new": 3, "origin": [3, 8], "tor": 3, "safe": 3, "access": [3, 10, 12], "ddp": 3, "fsdp": 3, "get_default_shard": 3, "get_modul": 3, "unwrap": 3, "get_unwrapped_modul": 3, "quantembeddingbagcollectionshard": 3, "shardedquantembeddingbagcollect": 3, "create_infer_embedding_bag_shard": 3, "arginfo": 3, "input_attr": 3, "is_getitem": 3, "pipelinedforward": 3, "distin": 3, "distout": 3, "out": [3, 9], "trainpipelinecontext": 3, "dist_stream": 3, "leaf_modul": 3, "graph": [3, 6], "is_leaf_modul": 3, "module_qualified_nam": 3, "leaf": 3, "atom": 3, "unit": [3, 9], "ir": 3, "referenc": 3, "call_modul": 3, "By": 3, "standard": 3, "trace": [3, 6, 7], "constitu": 3, "record": [3, 6], "unless": [3, 10], "queri": [3, 4], "about": 3, "hierarchi": 3, "foo": 3, "bar": 3, "baz": 3, "here": [3, 8], "proxy_buffer_attribut": 3, "trainpipelin": 3, "kwd": 3, "progress": [3, 10], "dataloader_it": 3, "trainpipelinebas": 3, "stage": [3, 10], "_memcpy_stream": 3, "move": 3, "host": [3, 4, 5], "input_dist_request": 3, "module_context": 3, "feature_processor_forward": 3, "help": 3, "hide": 3, "latenc": 3, "preserv": [3, 9], "data_dist": 3, "memcpi": 3, "done": [3, 4, 10], "top": [3, 9], "level": [3, 5], "To": [3, 9], "consid": [3, 4], "depend": [3, 4, 7, 9], "getattr": 3, "symbol": [3, 6], "traceabl": 3, "except": [3, 4, 9], "commop": 3, "pooled_embeddings_all_to_al": 3, "pooled_embeddings_reduce_scatt": 3, "sequence_embeddings_all_to_al": 3, "computekernel": 3, "emptycontext": 3, "id_list_feature_nam": [3, 5], "id_list_feature_names_per_rank": [3, 5], "id_score_list_feature_nam": [3, 5], "id_score_list_feature_names_per_rank": [3, 5], "genericmeta": 3, "expos": [3, 10], "concret": 3, "achiev": 3, "mean": [3, 9], "late": 3, "possibl": [3, 4], "__torch_function__": 3, "below": 3, "doesn": [3, 9, 10], "python": [3, 6, 7, 8], "magic": 3, "__getattr__": 3, "caveat": 3, "arbitari": 3, "mechan": [3, 9], "ensur": [3, 9], "perfect": 3, "quickli": 3, "long": [3, 9], "lazynowait": 3, "modulecopymixin": 3, "mixin": 3, "classmethod": [3, 7, 11], "moduleshardingmixin": 3, "scheme": 3, "noopquantizedcommcodec": 3, "No": [3, 5], "decod": 3, "input_grad": 3, "encod": 3, "input_tensor": 3, "quantized_dtyp": 3, "dtype": [3, 6, 7, 9, 11], "nowait": [3, 6], "obj": 3, "sharding_spec": 3, "shardingspec": 3, "describ": 3, "place": [3, 4, 5, 10], "column_wis": 3, "seen": [3, 6], "individu": [3, 8], "table_row_wis": 3, "row_wis": 3, "data_parallel": [3, 4], "parameterstorag": 3, "physic": 3, "constraint": [3, 4], "shardingplann": [3, 4], "ddr": [3, 4], "hbm": [3, 4], "pooled_all_to_al": 3, "reduce_scatt": 3, "quantized_tensor": 3, "quantized_comm_codec": 3, "collective_cal": 3, "output_tensor": 3, "assert_clos": 3, "respect": [3, 8, 9], "sequence_all_to_al": 3, "compin": 3, "vise": [3, 10], "versa": [3, 10], "execut": [3, 4, 7, 11], "step": [3, 10], "practic": 3, "from_loc": 3, "typic": [3, 4, 9, 10, 12], "from_process_group": 3, "represent": [3, 4, 6, 12], "get_plan_for_modul": 3, "module_path": 3, "re": [3, 10], "stabil": 3, "table_column_wis": 3, "scope": 3, "add_prefix_to_state_dict": 3, "filter": [3, 9], "append_prefix": 3, "append": 3, "filter_state_dict": 3, "strip": 3, "begin": [3, 10], "get_unsharded_module_nam": 3, "don": [3, 7, 9], "merge_fused_param": 3, "param_fused_param": 3, "configur": 3, "cache_precis": 3, "preset": 3, "table_level_fused_param": 3, "precid": 3, "grouped_fused_param": 3, "null": 3, "optimizer_type_to_emb_opt_typ": 3, "optimizer_class": 3, "emboptimtyp": 3, "sharded_model_copi": 3, "m_cpu": 3, "deepcopi": 3, "build": 4, "estim": 4, "perf": 4, "storag": [4, 12], "peak": 4, "elimin": 4, "oom": 4, "customiz": 4, "select": [4, 5, 12], "kernel_bw_lookup": 4, "compute_devic": 4, "caching_ratio": 4, "calcul": 4, "bandwidth": 4, "ratio": 4, "uvm": 4, "embeddingenumer": 4, "parameterconstraint": 4, "shardestim": 4, "shardingopt": 4, "popul": [4, 9], "calculate_shard_sizes_and_offset": 4, "local_world_s": 4, "col_wise_shard_dim": 4, "coordin": 4, "valueerror": 4, "get_partition_by_typ": 4, "partitionbytyp": 4, "greedyperfpartition": 4, "greedi": 4, "storage_constraint": 4, "partition_bi": 4, "sharding_opt": 4, "strategi": 4, "docstr": [4, 12], "partition_by_devic": 4, "clariti": 4, "shardingoptiongroup": 4, "storage_sum": 4, "noopperfmodel": 4, "perfmodel": 4, "rate": [4, 10], "storagereserv": 4, "performance_model": 4, "debug": 4, "shardabl": 4, "greedypropos": 4, "use_depth": 4, "fashion": [4, 5], "sort": 4, "On": [4, 9], "find": 4, "largest": 4, "tri": [4, 10], "feedback": 4, "perf_rat": 4, "search_spac": 4, "gridsearchpropos": 4, "max_propos": 4, "10000": 4, "uniformpropos": 4, "proposers_to_proposals_list": 4, "proposers_list": 4, "static_feedback": 4, "independ": 4, "embeddingperfestim": 4, "is_infer": 4, "wall": 4, "sharder_map": 4, "embeddingstorageestim": 4, "calculate_shard_storag": 4, "shard_siz": 4, "input_length": 4, "num_pool": 4, "is_pool": 4, "compris": 4, "synonym": 4, "factor": [4, 9], "ie": [4, 5, 12], "unpool": 4, "perf_func_emb_wall_tim": 4, "input_data_type_s": 4, "output_data_type_s": 4, "bw_intra_host": 4, "bw_inter_host": 4, "attempt": 4, "rel": 4, "tw": 4, "rw": [4, 5], "cw": 4, "thread": 4, "machin": [4, 9], "ebc": [4, 8, 9, 11], "signifi": 4, "embeddingstat": 4, "sharding_plan": 4, "num_propos": 4, "num_plan": 4, "run_tim": 4, "best_plan": 4, "tabular": 4, "view": 4, "chosen": [4, 9], "reserv": 4, "evalu": [4, 9], "successfulli": 4, "fixedpercentagereserv": 4, "percentag": 4, "heuristicalstoragereserv": 4, "heurist": 4, "nonshard": 4, "extra": 4, "act": 4, "margin": 4, "error": [4, 9], "beyond": 4, "inferencestoragereserv": 4, "devicehardwar": 4, "512": 4, "descript": 4, "min_partit": 4, "pooling_factor": 4, "around": 4, "todai": 4, "bldm": 4, "plannererror": 4, "prospos": 4, "paritit": 4, "much": [4, 10], "upstream_modul": 4, "downstream_modul": 4, "One": [4, 9], "fqn": 4, "num_input": 4, "num_shard": 4, "total_storag": 4, "statist": 4, "relat": 4, "capac": 4, "hardwar": 4, "fits_in": 4, "hbm_cap": 4, "ddr_cap": 4, "137438953472": 4, "intra_host_bw": 4, "644245094": 4, "inter_host_bw": 4, "13421772": 4, "8": [4, 8, 9, 11, 12], "bytes_to_gb": 4, "num_byt": 4, "bytes_to_mb": 4, "gb_to_byt": 4, "gb": 4, "prod": 4, "sharder_nam": 4, "basecwembeddingshard": 5, "basetwembeddingshard": 5, "cwpooledembeddingshard": 5, "basedpembeddingshard": 5, "dppooledembeddingdist": 5, "dppooledembeddingshard": 5, "dpsparsefeaturesdist": 5, "baserwembeddingshard": 5, "rwpooledembeddingdist": 5, "rwpooledembeddingshard": 5, "evenli": 5, "rwsparsefeaturesdist": 5, "num_id_list_featur": 5, "num_id_score_list_featur": 5, "id_list_feature_hash_s": 5, "id_score_list_feature_hash_s": 5, "is_sequ": 5, "intra_pg": 5, "infertwembeddingshard": 5, "infertwpooledembeddingdist": 5, "infertwsparsefeaturesdist": 5, "twpooledembeddingdist": 5, "twpooledembeddingshard": 5, "twsparsefeaturesdist": 5, "twcwpooledembeddingshard": 5, "basetwrwembeddingshard": 5, "twrwpooledembeddingdist": 5, "cross_pg": 5, "dim_sum_per_nod": 5, "twrwpooledembeddingshard": 5, "twrwsparsefeaturesdist": 5, "look": 5, "document": [6, 8], "lower": [6, 7, 10, 11], "torchscript": 6, "create_arg": 6, "complex": 6, "memory_format": 6, "prepar": [6, 9], "addit": [6, 7, 8, 9, 10, 12], "emit": 6, "appropri": 6, "concrete_arg": 6, "is_fx_trac": 6, "symbolic_trac": 6, "graphmodul": 6, "partial": 6, "special": [6, 9, 10], "your": 6, "structur": 6, "deploi": 7, "packag": 7, "predictmodul": 7, "predictfactori": 7, "contract": 7, "serv": 7, "predictfactorypackag": 7, "batchingqueu": 7, "config": [7, 8], "gpuexecutor": 7, "insid": 7, "dlrm_packag": 7, "demonstr": 7, "export": 7, "dlrm_predict": 7, "show": 7, "save_predict_factori": 7, "predict_factori": 7, "binaryio": 7, "extra_fil": 7, "byte": 7, "loader_cod": 7, "nimport": 7, "n": [7, 8, 9, 12], "nmodule_factori": 7, "set_extern_modul": 7, "decor": 7, "similar": [7, 8], "abstractmethod": 7, "metaclass": 7, "abcmeta": [7, 12], "abstractclassmethod": 7, "my_abstract_classmethod": 7, "cl": 7, "set_mocked_modul": 7, "load_config_text": 7, "load_pickle_config": 7, "clazz": 7, "batchingmetadata": 7, "pin": 7, "kept": 7, "sync": [7, 12], "learn": [7, 8, 9, 10], "batching_metadata": 7, "infom": 7, "batching_metadata_json": 7, "serial": 7, "json": 7, "eas": [7, 9], "pars": 7, "create_predict_modul": 7, "transformmodul": 7, "transform_state_dict": 7, "init_process_group": 7, "wa": 7, "qualname_metadata": 7, "qualnamemetadata": 7, "qualnam": 7, "inform": [7, 12], "result_metadata": 7, "run_weights_dependent_transform": 7, "predict_modul": 7, "predict": 7, "run_weights_independent_tranform": 7, "predict_forward": 7, "current_devic": 7, "need_preproc": 7, "quantize_dens": 7, "additional_embedding_module_typ": 7, "quantize_embed": 7, "inplac": [7, 11], "additional_qconfig_spec_kei": 7, "additional_map": 7, "output_dtyp": [7, 11], "quantize_featur": 7, "architectur": [8, 9], "deep": [8, 9], "overal": 8, "sparsearch": 8, "densearch": 8, "interactionarch": 8, "overarch": 8, "found": 8, "notat": 8, "embedding_dimens": 8, "hidden_layer_s": 8, "deepfmnn": 8, "dimension": 8, "hidden": [8, 9], "dense_arch": 8, "dense_embed": 8, "fminteractionarch": 8, "fm_in_featur": 8, "sparse_feature_nam": 8, "deep_fm_dimens": 8, "interact": [8, 9], "extern": 8, "paper": [8, 9], "arxiv": 8, "pdf": 8, "1703": 8, "04247": 8, "cat": 8, "dense_modul": [8, 9], "di": 8, "arch": 8, "f1": [8, 9, 11], "f2": [8, 9, 11], "fm_inter_arch": 8, "length_per_kei": [8, 12], "cat_fm_output": 8, "simpl": 8, "over_arch": 8, "logit": 8, "simpledeepfmnn": 8, "num_dense_featur": 8, "embedding_bag_collect": 8, "basic": 8, "relationship": 8, "project": 8, "among": 8, "deep_fm": 8, "embeddingbagconfig": [8, 9, 11], "eb1_config": [8, 11], "f3": 8, "eb2_config": [8, 11], "t2": [8, 9, 11], "sparse_nn": 8, "over_embedding_dim": 8, "9": 8, "from_offsets_sync": [8, 9, 11, 12], "7": [8, 9, 11, 12], "sparse_arch": 8, "dense_in_featur": 8, "dense_arch_layer_s": 8, "over_arch_layer_s": 8, "dense_devic": 8, "person": 8, "ab": 8, "1906": 8, "00091": 8, "pairwis": 8, "dlrmtrain": 8, "dlrm_modul": 8, "dlrm_project": 8, "dlrm_dcn": 8, "ebc_config": 8, "dlrm_model": 8, "loss": [8, 10], "dcn_num_lay": 8, "dcn_low_rank_dim": 8, "dcn": [8, 9], "modifi": [8, 10], "deepcrossnet": 8, "2008": 8, "13535": 8, "low": [8, 9], "approxim": 8, "interaction_branch1_layer_s": 8, "interaction_branch2_layer_s": 8, "branch": 8, "layer_s": [8, 9], "15": 8, "num_sparse_featur": 8, "dot": [8, 9], "product": 8, "pair": 8, "inter_arch": 8, "choos": 8, "concat_dens": 8, "interactiondcnarch": 8, "matrix": [8, 9], "lowrankcrossnet": [8, 9], "dnc_low_rank_dim": 8, "interactionprojectionarch": 8, "interaction_branch1": 8, "interaction_branch2": 8, "y": [8, 9], "z": 8, "bx": 8, "f1xd": 8, "dxf2": 8, "last": [8, 9, 12], "i1": 8, "i2": 8, "sparse_embed": 8, "k": [8, 9], "math": 8, "comb": 8, "extens": 9, "establish": 9, "pattern": 9, "swishlayernorm": 9, "positionweightedmodul": 9, "lazymoduleextensionmixin": 9, "embeddingtow": 9, "embeddingtowercollect": 9, "logic": 9, "tower": 9, "input_dim": 9, "swish": 9, "normal": 9, "sigmoid": 9, "layernorm": 9, "d1": 9, "d2": 9, "d3": 9, "sln": 9, "num_lay": 9, "stack": 9, "effect": 9, "learnabl": 9, "polynom": 9, "nxn": 9, "cover": 9, "bit": 9, "x_": 9, "x_0": 9, "w_l": 9, "x_l": 9, "b_l": 9, "squar": 9, "element": 9, "low_rank": 9, "highli": 9, "effici": 9, "matric": 9, "simplifi": 9, "v_l": 9, "vector": 9, "smartli": 9, "accuraci": 9, "setup": 9, "alwai": [9, 12], "lowrankmixturecrossnet": 9, "num_expert": 9, "relu": 9, "mixtur": 9, "expert": 9, "compar": 9, "leverag": 9, "subspac": 9, "combin": [9, 10], "gate": 9, "moe": 9, "expert_i": 9, "k_": 9, "u_": 9, "li": 9, "c_": 9, "v_": 9, "vectorcrossnet": 9, "keep": 9, "nx1": 9, "thu": [9, 10], "further": [9, 12], "cost": 9, "cut": 9, "off": 9, "implent": 9, "framework": 9, "factorizationmachin": 9, "fm": 9, "publish": 9, "compon": 9, "high": 9, "learnt": 9, "share": 9, "flexibl": 9, "90": 9, "30": 9, "40": 9, "equal": 9, "fb": 9, "lazymlp": 9, "output_dim": 9, "64": 9, "32": 9, "192": 9, "deep_fm_output": 9, "common_spars": 9, "specialized_spars": 9, "embedding_featur": 9, "raw_embedding_featur": 9, "nativ": 9, "trained_embed": 9, "native_embed": 9, "ident": 9, "mention": 9, "2nd": 9, "baseembeddingconfig": 9, "get_weight_init_max": 9, "get_weight_init_min": 9, "our": 9, "certain": [9, 10], "retrict": 9, "fp16": 9, "int2": 9, "int4": 9, "int8": 9, "embeddingconfig": [9, 11], "data_type_to_dtyp": 9, "data_type_to_sparse_typ": 9, "sparsetyp": 9, "dtype_to_data_typ": 9, "pooling_type_to_pooling_mod": 9, "pooling_typ": 9, "poolingmod": 9, "pooling_type_to_str": 9, "jag": [9, 11, 12], "table_0": [9, 11], "table_1": [9, 11], "pooled_embed": 9, "8899": 9, "1342": 9, "9060": 9, "0905": 9, "2814": 9, "9369": 9, "7783": 9, "0000": 9, "1598": 9, "0695": 9, "3265": 9, "1011": 9, "4256": 9, "1846": 9, "1648": 9, "0893": 9, "3590": 9, "9784": 9, "7681": 9, "grad_fn": [9, 11], "catbackward0": 9, "offset_per_kei": [9, 12], "embedding_bag_config": [9, 11], "need_indic": [9, 11], "e1_config": [9, 11], "e2_config": [9, 11], "ec": [9, 11], "feature_embed": [9, 11], "2050": [9, 11], "5478": [9, 11], "6054": [9, 11], "7352": [9, 11], "3210": [9, 11], "0399": [9, 11], "1279": [9, 11], "1756": [9, 11], "4130": [9, 11], "7519": [9, 11], "4341": [9, 11], "0499": [9, 11], "9329": [9, 11], "0697": [9, 11], "8095": [9, 11], "embeddingbackward": [9, 11], "embedding_names_by_t": [9, 11], "get_embedding_names_by_t": 9, "basefeatureprocessor": 9, "max_length": 9, "truncat": 9, "maximum": 9, "positionweightedprocessor": 9, "feature_length": 9, "feature0": [9, 12], "feature1": [9, 12], "feature2": 9, "from_lengths_sync": [9, 12], "pw": 9, "featureprocessorcollect": 9, "feature_processor_modul": 9, "positionweightedfeatureprocessor": 9, "fp_featur": 9, "non_fp_featur": 9, "non_fp": 9, "feature_process": 9, "come": 9, "And": 9, "lazymodulemixin": 9, "temporari": 9, "term": 9, "upstream": 9, "59923": 9, "testlazymoduleextensionmixin": 9, "_infer_paramet": 9, "code": 9, "pariti": 9, "_call_impl": 9, "fn": 9, "children": 9, "uniniti": 9, "dummi": [9, 10], "lazylinear": 9, "fail": 9, "hasn": 9, "been": 9, "yet": 9, "now": 9, "lazy_appli": 9, "attach": 9, "right": 9, "numer": 9, "inherit": 9, "immedi": 9, "seq": 9, "in_siz": 9, "perceptron": 9, "multi": 9, "out_siz": 9, "swish_layernorm": 9, "won": 9, "constructor": 9, "mlp_modul": 9, "assert": 9, "o": 9, "channel": 9, "check_module_output_dimens": 9, "verifi": 9, "modulelist": 9, "construct_modulelist_from_single_modul": 9, "nest": 9, "reiniti": 9, "convert_list_of_modules_to_modulelist": 9, "extract_module_or_tensor_cal": 9, "module_or_cal": 9, "get_module_output_dimens": 9, "init_mlp_weights_xavier_uniform": 9, "meaning": 10, "prohibit": 10, "empti": [10, 12], "sever": 10, "combinedoptim": 10, "optimizerwrapp": 10, "rowwis": 10, "gradientclip": 10, "norm": 10, "gradientclippingoptim": 10, "max_gradi": 10, "closur": 10, "reevalu": 10, "most": 10, "fusedoptim": 10, "param_group": 10, "zero_grad": 10, "set_to_non": 10, "zero": [10, 12], "footprint": 10, "modestli": 10, "improv": 10, "behav": 10, "did": 10, "altogeth": 10, "meant": 10, "post_load_state_dict": 10, "prepend_opt_kei": 10, "opt_kei": 10, "save_param_group": 10, "stricter": 10, "old": 10, "switch": 10, "flag": 10, "reason": 10, "present": 10, "identifi": 10, "littl": 10, "add_param_group": 10, "fine": 10, "tune": 10, "frozen": 10, "made": 10, "trainabl": 10, "what": 10, "init_st": 10, "u": 10, "checkpoint": 10, "usabl": 10, "sure": 10, "sd": 10, "load_checkpoint": 10, "advanc": 10, "keyedoptimizerwrapp": 10, "optim_factori": 10, "conveni": 10, "warmupoptim": 10, "warmupstag": 10, "lr": 10, "lr_param": 10, "param_nam": 10, "__warmup": 10, "adjust": 10, "schedul": 10, "go": 10, "fake": 10, "warmuppolici": 10, "invsqrt": 10, "inv_sqrt": 10, "poli": 10, "polici": 10, "max_it": 10, "lr_scale": 10, "decay_it": 10, "fbgemm": 11, "up": 11, "trec_quant": 11, "trec": 11, "qconfig": 11, "placeholderobserv": 11, "with_arg": 11, "qint8": 11, "quantize_dynam": 11, "qconfig_spec": 11, "table_name_to_quantized_weight": 11, "qebc": 11, "quantembeddingbagcollect": 11, "from_float": 11, "quantized_embed": 11, "quantize_state_dict": 11, "whose": 12, "dimes": 12, "jit": 12, "abl": 12, "NOT": 12, "expens": 12, "from_dens": 12, "2d": 12, "11": 12, "12": 12, "j1": 12, "from_dense_length": 12, "lengths_or_non": 12, "offsets_or_non": 12, "to_dens": 12, "reprensent": 12, "jt": 12, "inttensor": 12, "torch_list": 12, "to_padded_dens": 12, "desired_length": 12, "padding_valu": 12, "longest": 12, "pad": 12, "dt": 12, "weights_or_non": 12, "jaggedtensormeta": 12, "proxyableclassmeta": 12, "stride": 12, "index_per_kei": 12, "jt_dict": 12, "dim_1": 12, "v5": 12, "v6": 12, "v7": 12, "dim_0": 12, "dim_2": 12, "w0": 12, "w1": 12, "w2": 12, "w3": 12, "w4": 12, "w5": 12, "w6": 12, "w7": 12, "kjt_list": 12, "empty_lik": 12, "length_per_key_or_non": 12, "offset_per_key_or_non": 12, "indices_tensor": 12, "segment": 12, "to_dict": 12, "key_dim": 12, "kt": 12, "tensor_list": 12, "from_tensor_list": 12, "regroup": 12, "keyed_tensor": 12, "regroup_as_dict": 12}, "objects": {"torchrec": [[1, 0, 0, "-", "datasets"], [3, 0, 0, "-", "distributed"], [6, 0, 0, "module-0", "fx"], [7, 0, 0, "module-0", "inference"], [8, 0, 0, "module-0", "models"], [9, 0, 0, "module-0", "modules"], [10, 0, 0, "module-0", "optim"], [11, 0, 0, "module-0", "quant"], [12, 0, 0, "module-0", "sparse"]], "torchrec.datasets": [[1, 0, 0, "-", "criteo"], [1, 0, 0, "-", "movielens"], [1, 0, 0, "-", "random"], [2, 0, 0, "-", "scripts"], [1, 0, 0, "-", "utils"]], "torchrec.datasets.criteo": [[1, 1, 1, "", "BinaryCriteoUtils"], [1, 1, 1, "", "CriteoIterDataPipe"], [1, 1, 1, "", "InMemoryBinaryCriteoIterDataPipe"], [1, 3, 1, "", "criteo_kaggle"], [1, 3, 1, "", "criteo_terabyte"]], "torchrec.datasets.criteo.BinaryCriteoUtils": [[1, 2, 1, "", "get_file_idx_to_row_range"], [1, 2, 1, "", "get_shape_from_npy"], [1, 2, 1, "", "load_npy_range"], [1, 2, 1, "", "shuffle"], [1, 2, 1, "", "sparse_to_contiguous"], [1, 2, 1, "", "tsv_to_npys"]], "torchrec.datasets.movielens": [[1, 3, 1, "", "movielens_20m"], [1, 3, 1, "", "movielens_25m"]], "torchrec.datasets.random": [[1, 1, 1, "", "RandomRecDataset"]], "torchrec.datasets.scripts": [[2, 0, 0, "-", "contiguous_preproc_criteo"], [2, 0, 0, "-", "npy_preproc_criteo"]], "torchrec.datasets.scripts.contiguous_preproc_criteo": [[2, 3, 1, "", "main"], [2, 3, 1, "", "parse_args"]], "torchrec.datasets.scripts.npy_preproc_criteo": [[2, 3, 1, "", "main"], [2, 3, 1, "", "parse_args"]], "torchrec.datasets.utils": [[1, 1, 1, "", "Batch"], [1, 1, 1, "", "Limit"], [1, 1, 1, "", "LoadFiles"], [1, 1, 1, "", "ParallelReadConcat"], [1, 1, 1, "", "ReadLinesFromCSV"], [1, 3, 1, "", "idx_split_train_val"], [1, 3, 1, "", "rand_split_train_val"], [1, 3, 1, "", "safe_cast"], [1, 3, 1, "", "train_filter"], [1, 3, 1, "", "val_filter"]], "torchrec.datasets.utils.Batch": [[1, 4, 1, "", "dense_features"], [1, 4, 1, "", "labels"], [1, 2, 1, "", "pin_memory"], [1, 2, 1, "", "record_stream"], [1, 4, 1, "", "sparse_features"], [1, 2, 1, "", "to"]], "torchrec.distributed": [[3, 0, 0, "-", "collective_utils"], [3, 0, 0, "-", "comm"], [3, 0, 0, "-", "comm_ops"], [5, 0, 0, "-", "dist_data"], [3, 0, 0, "-", "embedding"], [3, 0, 0, "-", "embedding_lookup"], [3, 0, 0, "-", "embedding_sharding"], [3, 0, 0, "-", "embedding_types"], [3, 0, 0, "-", "embeddingbag"], [3, 0, 0, "-", "grouped_position_weighted"], [3, 0, 0, "-", "model_parallel"], [4, 0, 0, "-", "planner"], [3, 0, 0, "-", "quant_embeddingbag"], [5, 0, 0, "-", "sharding"], [3, 0, 0, "-", "train_pipeline"], [3, 0, 0, "-", "types"], [3, 0, 0, "-", "utils"]], "torchrec.distributed.collective_utils": [[3, 3, 1, "", "invoke_on_rank_and_broadcast_result"], [3, 3, 1, "", "is_leader"], [3, 3, 1, "", "run_on_leader"]], "torchrec.distributed.comm": [[3, 3, 1, "", "get_group_rank"], [3, 3, 1, "", "get_local_rank"], [3, 3, 1, "", "get_local_size"], [3, 3, 1, "", "get_num_groups"], [3, 3, 1, "", "intra_and_cross_node_pg"]], "torchrec.distributed.comm_ops": [[3, 1, 1, "", "All2AllDenseInfo"], [3, 1, 1, "", "All2AllPooledInfo"], [3, 1, 1, "", "All2AllSequenceInfo"], [3, 1, 1, "", "All2AllVInfo"], [3, 1, 1, "", "All2All_Pooled_Req"], [3, 1, 1, "", "All2All_Pooled_Wait"], [3, 1, 1, "", "All2All_Seq_Req"], [3, 1, 1, "", "All2All_Seq_Req_Wait"], [3, 1, 1, "", "All2Allv_Req"], [3, 1, 1, "", "All2Allv_Wait"], [3, 1, 1, "", "AllGatherBaseInfo"], [3, 1, 1, "", "AllGatherBase_Req"], [3, 1, 1, "", "AllGatherBase_Wait"], [3, 1, 1, "", "ReduceScatterBaseInfo"], [3, 1, 1, "", "ReduceScatterBase_Req"], [3, 1, 1, "", "ReduceScatterBase_Wait"], [3, 1, 1, "", "ReduceScatterInfo"], [3, 1, 1, "", "ReduceScatterVInfo"], [3, 1, 1, "", "ReduceScatterV_Req"], [3, 1, 1, "", "ReduceScatterV_Wait"], [3, 1, 1, "", "ReduceScatter_Req"], [3, 1, 1, "", "ReduceScatter_Wait"], [3, 1, 1, "", "Request"], [3, 3, 1, "", "all_gather_base_pooled"], [3, 3, 1, "", "alltoall_pooled"], [3, 3, 1, "", "alltoall_sequence"], [3, 3, 1, "", "alltoallv"], [3, 3, 1, "", "reduce_scatter_base_pooled"], [3, 3, 1, "", "reduce_scatter_pooled"], [3, 3, 1, "", "reduce_scatter_v_pooled"], [3, 3, 1, "", "set_gradient_division"]], "torchrec.distributed.comm_ops.All2AllDenseInfo": [[3, 4, 1, "", "batch_size"], [3, 4, 1, "", "input_shape"], [3, 4, 1, "", "input_splits"], [3, 4, 1, "", "output_splits"]], "torchrec.distributed.comm_ops.All2AllPooledInfo": [[3, 4, 1, "", "B_local"], [3, 4, 1, "id0", "batch_size_per_rank"], [3, 4, 1, "", "codecs"], [3, 4, 1, "id1", "cumsum_dim_sum_per_rank_tensor"], [3, 4, 1, "id2", "dim_sum_per_rank"], [3, 4, 1, "id3", "dim_sum_per_rank_tensor"]], "torchrec.distributed.comm_ops.All2AllSequenceInfo": [[3, 4, 1, "id4", "backward_recat_tensor"], [3, 4, 1, "", "codecs"], [3, 4, 1, "id5", "embedding_dim"], [3, 4, 1, "id6", "forward_recat_tensor"], [3, 4, 1, "id7", "input_splits"], [3, 4, 1, "id8", "lengths_after_sparse_data_all2all"], [3, 4, 1, "", "lengths_sparse_before_features_all2all"], [3, 4, 1, "id9", "output_splits"], [3, 4, 1, "", "permuted_lengths_after_sparse_data_all2all"]], "torchrec.distributed.comm_ops.All2AllVInfo": [[3, 4, 1, "id10", "B_global"], [3, 4, 1, "id11", "B_local"], [3, 4, 1, "id12", "B_local_list"], [3, 4, 1, "id13", "D_local_list"], [3, 4, 1, "", "codecs"], [3, 4, 1, "", "dim_sum_per_rank"], [3, 4, 1, "", "dims_sum_per_rank"], [3, 4, 1, "id14", "input_split_sizes"], [3, 4, 1, "id15", "output_split_sizes"]], "torchrec.distributed.comm_ops.All2All_Pooled_Req": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Pooled_Wait": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2All_Seq_Req_Wait": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Req": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.All2Allv_Wait": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBaseInfo": [[3, 4, 1, "", "codecs"], [3, 4, 1, "id16", "input_size"]], "torchrec.distributed.comm_ops.AllGatherBase_Req": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.AllGatherBase_Wait": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBaseInfo": [[3, 4, 1, "", "codecs"], [3, 4, 1, "id17", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Req": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterBase_Wait": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterInfo": [[3, 4, 1, "", "codecs"], [3, 4, 1, "id18", "input_sizes"]], "torchrec.distributed.comm_ops.ReduceScatterVInfo": [[3, 4, 1, "", "codecs"], [3, 4, 1, "", "equal_splits"], [3, 4, 1, "id19", "input_sizes"], [3, 4, 1, "id20", "input_splits"], [3, 4, 1, "id21", "total_input_size"]], "torchrec.distributed.comm_ops.ReduceScatterV_Req": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatterV_Wait": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Req": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.comm_ops.ReduceScatter_Wait": [[3, 2, 1, "", "backward"], [3, 2, 1, "", "forward"]], "torchrec.distributed.dist_data": [[5, 1, 1, "", "EmbeddingsAllToOne"], [5, 1, 1, "", "KJTAllToAll"], [5, 1, 1, "", "KJTAllToAllIndicesAwaitable"], [5, 1, 1, "", "KJTAllToAllLengthsAwaitable"], [5, 1, 1, "", "KJTOneToAll"], [5, 1, 1, "", "PooledEmbeddingsAllGather"], [5, 1, 1, "", "PooledEmbeddingsAllToAll"], [5, 1, 1, "", "PooledEmbeddingsAwaitable"], [5, 1, 1, "", "PooledEmbeddingsReduceScatter"], [5, 1, 1, "", "SeqEmbeddingsAllToOne"], [5, 1, 1, "", "SequenceEmbeddingsAllToAll"], [5, 1, 1, "", "SequenceEmbeddingsAwaitable"]], "torchrec.distributed.dist_data.EmbeddingsAllToOne": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTAllToAll": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.dist_data.KJTOneToAll": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllGather": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAllToAll": [[5, 5, 1, "", "callbacks"], [5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.dist_data.PooledEmbeddingsAwaitable": [[5, 5, 1, "", "callbacks"]], "torchrec.distributed.dist_data.PooledEmbeddingsReduceScatter": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SeqEmbeddingsAllToOne": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.dist_data.SequenceEmbeddingsAllToAll": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.embedding": [[3, 1, 1, "", "EmbeddingCollectionAwaitable"], [3, 1, 1, "", "EmbeddingCollectionContext"], [3, 1, 1, "", "EmbeddingCollectionSharder"], [3, 1, 1, "", "ShardedEmbeddingCollection"], [3, 3, 1, "", "create_embedding_sharding"], [3, 3, 1, "", "create_sharding_infos_by_sharding"]], "torchrec.distributed.embedding.EmbeddingCollectionContext": [[3, 2, 1, "", "record_stream"], [3, 4, 1, "", "sharding_contexts"]], "torchrec.distributed.embedding.EmbeddingCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 2, 1, "", "shard"], [3, 2, 1, "", "shardable_parameters"], [3, 2, 1, "", "sharding_types"]], "torchrec.distributed.embedding.ShardedEmbeddingCollection": [[3, 2, 1, "", "compute"], [3, 2, 1, "", "compute_and_output_dist"], [3, 2, 1, "", "create_context"], [3, 5, 1, "", "fused_optimizer"], [3, 2, 1, "", "input_dist"], [3, 2, 1, "", "lengths_dist"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_modules"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "output_dist"], [3, 2, 1, "", "sharded_parameter_names"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup": [[3, 1, 1, "", "GroupedEmbeddingsLookup"], [3, 1, 1, "", "GroupedPooledEmbeddingsLookup"], [3, 1, 1, "", "InferGroupedEmbeddingsLookup"], [3, 1, 1, "", "InferGroupedLookupMixin"], [3, 1, 1, "", "InferGroupedPooledEmbeddingsLookup"], [3, 1, 1, "", "MetaInferGroupedEmbeddingsLookup"], [3, 1, 1, "", "MetaInferGroupedPooledEmbeddingsLookup"]], "torchrec.distributed.embedding_lookup.GroupedEmbeddingsLookup": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.GroupedPooledEmbeddingsLookup": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedEmbeddingsLookup": [[3, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.InferGroupedLookupMixin": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "state_dict"]], "torchrec.distributed.embedding_lookup.InferGroupedPooledEmbeddingsLookup": [[3, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedEmbeddingsLookup": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_lookup.MetaInferGroupedPooledEmbeddingsLookup": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding": [[3, 1, 1, "", "BaseEmbeddingDist"], [3, 1, 1, "", "BaseSparseFeaturesDist"], [3, 1, 1, "", "EmbeddingSharding"], [3, 1, 1, "", "EmbeddingShardingInfo"], [3, 1, 1, "", "ListOfSparseFeaturesListAwaitable"], [3, 1, 1, "", "SparseFeaturesAllToAll"], [3, 1, 1, "", "SparseFeaturesIndicesAwaitable"], [3, 1, 1, "", "SparseFeaturesLengthsAwaitable"], [3, 1, 1, "", "SparseFeaturesListAwaitable"], [3, 1, 1, "", "SparseFeaturesListIndicesAwaitable"], [3, 1, 1, "", "SparseFeaturesOneToAll"], [3, 3, 1, "", "bucketize_kjt_before_all2all"], [3, 3, 1, "", "group_tables"]], "torchrec.distributed.embedding_sharding.BaseEmbeddingDist": [[3, 2, 1, "", "forward"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.BaseSparseFeaturesDist": [[3, 2, 1, "", "forward"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.EmbeddingSharding": [[3, 2, 1, "", "create_input_dist"], [3, 2, 1, "", "create_lookup"], [3, 2, 1, "", "create_output_dist"], [3, 2, 1, "", "embedding_dims"], [3, 2, 1, "", "embedding_names"], [3, 2, 1, "", "embedding_names_per_rank"], [3, 2, 1, "", "embedding_shard_metadata"], [3, 5, 1, "", "qcomm_codecs_registry"]], "torchrec.distributed.embedding_sharding.EmbeddingShardingInfo": [[3, 4, 1, "", "embedding_config"], [3, 4, 1, "", "fused_params"], [3, 4, 1, "", "param"], [3, 4, 1, "", "param_sharding"]], "torchrec.distributed.embedding_sharding.SparseFeaturesAllToAll": [[3, 2, 1, "", "forward"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_sharding.SparseFeaturesOneToAll": [[3, 2, 1, "", "forward"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_types": [[3, 1, 1, "", "BaseEmbeddingLookup"], [3, 1, 1, "", "BaseEmbeddingSharder"], [3, 1, 1, "", "BaseGroupedFeatureProcessor"], [3, 1, 1, "", "BaseQuantEmbeddingSharder"], [3, 1, 1, "", "EmbeddingAttributes"], [3, 1, 1, "", "EmbeddingComputeKernel"], [3, 1, 1, "", "GroupedEmbeddingConfig"], [3, 1, 1, "", "ListOfSparseFeaturesList"], [3, 1, 1, "", "OptimType"], [3, 1, 1, "", "ShardedConfig"], [3, 1, 1, "", "ShardedEmbeddingTable"], [3, 1, 1, "", "ShardedMetaConfig"], [3, 1, 1, "", "SparseFeatures"], [3, 1, 1, "", "SparseFeaturesList"], [3, 3, 1, "", "compute_kernel_to_embedding_location"]], "torchrec.distributed.embedding_types.BaseEmbeddingLookup": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseEmbeddingSharder": [[3, 2, 1, "", "compute_kernels"], [3, 5, 1, "", "fused_params"], [3, 2, 1, "", "sharding_types"], [3, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.BaseGroupedFeatureProcessor": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 4, 1, "", "training"]], "torchrec.distributed.embedding_types.BaseQuantEmbeddingSharder": [[3, 2, 1, "", "compute_kernels"], [3, 5, 1, "", "fused_params"], [3, 2, 1, "", "sharding_types"], [3, 2, 1, "", "storage_usage"]], "torchrec.distributed.embedding_types.EmbeddingAttributes": [[3, 4, 1, "", "compute_kernel"]], "torchrec.distributed.embedding_types.EmbeddingComputeKernel": [[3, 4, 1, "", "DENSE"], [3, 4, 1, "", "FUSED"], [3, 4, 1, "", "FUSED_UVM"], [3, 4, 1, "", "FUSED_UVM_CACHING"], [3, 4, 1, "", "QUANT"], [3, 4, 1, "", "QUANT_UVM"], [3, 4, 1, "", "QUANT_UVM_CACHING"]], "torchrec.distributed.embedding_types.GroupedEmbeddingConfig": [[3, 4, 1, "", "compute_kernel"], [3, 4, 1, "", "data_type"], [3, 2, 1, "", "dim_sum"], [3, 2, 1, "", "embedding_dims"], [3, 2, 1, "", "embedding_names"], [3, 2, 1, "", "embedding_shard_metadata"], [3, 4, 1, "", "embedding_tables"], [3, 2, 1, "", "feature_hash_sizes"], [3, 2, 1, "", "feature_names"], [3, 4, 1, "", "fused_params"], [3, 4, 1, "", "has_feature_processor"], [3, 4, 1, "", "is_weighted"], [3, 2, 1, "", "num_features"], [3, 4, 1, "", "pooling"]], "torchrec.distributed.embedding_types.ListOfSparseFeaturesList": [[3, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.OptimType": [[3, 4, 1, "", "ADAGRAD"], [3, 4, 1, "", "ADAM"], [3, 4, 1, "", "LAMB"], [3, 4, 1, "", "LARS_SGD"], [3, 4, 1, "", "PARTIAL_ROWWISE_ADAM"], [3, 4, 1, "", "PARTIAL_ROWWISE_LAMB"], [3, 4, 1, "", "ROWWISE_ADAGRAD"], [3, 4, 1, "", "SGD"], [3, 4, 1, "", "SHAMPOO"]], "torchrec.distributed.embedding_types.ShardedConfig": [[3, 4, 1, "", "local_cols"], [3, 4, 1, "", "local_rows"]], "torchrec.distributed.embedding_types.ShardedEmbeddingTable": [[3, 4, 1, "", "fused_params"]], "torchrec.distributed.embedding_types.ShardedMetaConfig": [[3, 4, 1, "", "global_metadata"], [3, 4, 1, "", "local_metadata"]], "torchrec.distributed.embedding_types.SparseFeatures": [[3, 4, 1, "", "id_list_features"], [3, 4, 1, "", "id_score_list_features"], [3, 2, 1, "", "record_stream"]], "torchrec.distributed.embedding_types.SparseFeaturesList": [[3, 2, 1, "", "record_stream"]], "torchrec.distributed.embeddingbag": [[3, 1, 1, "", "EmbeddingAwaitable"], [3, 1, 1, "", "EmbeddingBagCollectionAwaitable"], [3, 1, 1, "", "EmbeddingBagCollectionSharder"], [3, 1, 1, "", "EmbeddingBagSharder"], [3, 1, 1, "", "ShardedEmbeddingBag"], [3, 1, 1, "", "ShardedEmbeddingBagCollection"], [3, 3, 1, "", "create_embedding_bag_sharding"], [3, 3, 1, "", "create_sharding_infos_by_sharding"], [3, 3, 1, "", "replace_placement_with_meta_device"]], "torchrec.distributed.embeddingbag.EmbeddingBagCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 2, 1, "", "shard"], [3, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.EmbeddingBagSharder": [[3, 5, 1, "", "module_type"], [3, 2, 1, "", "shard"], [3, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBag": [[3, 2, 1, "", "compute"], [3, 5, 1, "", "fused_optimizer"], [3, 2, 1, "", "input_dist"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_modules"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "output_dist"], [3, 2, 1, "", "sharded_parameter_names"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.embeddingbag.ShardedEmbeddingBagCollection": [[3, 2, 1, "", "compute"], [3, 2, 1, "", "compute_and_output_dist"], [3, 5, 1, "", "fused_optimizer"], [3, 2, 1, "", "input_dist"], [3, 2, 1, "", "load_state_dict"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_modules"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "output_dist"], [3, 2, 1, "", "sharded_parameter_names"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.grouped_position_weighted": [[3, 1, 1, "", "GroupedPositionWeightedModule"]], "torchrec.distributed.grouped_position_weighted.GroupedPositionWeightedModule": [[3, 2, 1, "", "forward"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_parameters"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.model_parallel": [[3, 1, 1, "", "DataParallelWrapper"], [3, 1, 1, "", "DefaultDataParallelWrapper"], [3, 1, 1, "", "DistributedModelParallel"], [3, 3, 1, "", "get_default_sharders"], [3, 3, 1, "", "get_module"], [3, 3, 1, "", "get_unwrapped_module"]], "torchrec.distributed.model_parallel.DataParallelWrapper": [[3, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DefaultDataParallelWrapper": [[3, 2, 1, "", "wrap"]], "torchrec.distributed.model_parallel.DistributedModelParallel": [[3, 2, 1, "", "bare_named_parameters"], [3, 2, 1, "", "copy"], [3, 2, 1, "", "forward"], [3, 5, 1, "", "fused_optimizer"], [3, 2, 1, "", "init_data_parallel"], [3, 2, 1, "", "load_state_dict"], [3, 5, 1, "", "module"], [3, 2, 1, "", "named_buffers"], [3, 2, 1, "", "named_parameters"], [3, 5, 1, "", "plan"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 2, 1, "", "state_dict"], [3, 4, 1, "", "training"]], "torchrec.distributed.planner": [[4, 0, 0, "-", "constants"], [4, 0, 0, "-", "enumerators"], [4, 0, 0, "-", "partitioners"], [4, 0, 0, "-", "perf_models"], [4, 0, 0, "-", "planners"], [4, 0, 0, "-", "proposers"], [4, 0, 0, "-", "shard_estimators"], [4, 0, 0, "-", "stats"], [4, 0, 0, "-", "storage_reservations"], [4, 0, 0, "-", "types"], [4, 0, 0, "-", "utils"]], "torchrec.distributed.planner.constants": [[4, 3, 1, "", "kernel_bw_lookup"]], "torchrec.distributed.planner.enumerators": [[4, 1, 1, "", "EmbeddingEnumerator"], [4, 3, 1, "", "calculate_shard_sizes_and_offsets"], [4, 3, 1, "", "get_partition_by_type"]], "torchrec.distributed.planner.enumerators.EmbeddingEnumerator": [[4, 2, 1, "", "enumerate"]], "torchrec.distributed.planner.partitioners": [[4, 1, 1, "", "GreedyPerfPartitioner"], [4, 1, 1, "", "ShardingOptionGroup"]], "torchrec.distributed.planner.partitioners.GreedyPerfPartitioner": [[4, 2, 1, "", "partition"]], "torchrec.distributed.planner.partitioners.ShardingOptionGroup": [[4, 4, 1, "", "sharding_options"], [4, 4, 1, "", "storage_sum"]], "torchrec.distributed.planner.perf_models": [[4, 1, 1, "", "NoopPerfModel"]], "torchrec.distributed.planner.perf_models.NoopPerfModel": [[4, 2, 1, "", "rate"]], "torchrec.distributed.planner.planners": [[4, 1, 1, "", "EmbeddingShardingPlanner"]], "torchrec.distributed.planner.planners.EmbeddingShardingPlanner": [[4, 2, 1, "", "collective_plan"], [4, 2, 1, "", "plan"]], "torchrec.distributed.planner.proposers": [[4, 1, 1, "", "GreedyProposer"], [4, 1, 1, "", "GridSearchProposer"], [4, 1, 1, "", "UniformProposer"], [4, 3, 1, "", "proposers_to_proposals_list"]], "torchrec.distributed.planner.proposers.GreedyProposer": [[4, 2, 1, "", "feedback"], [4, 2, 1, "", "load"], [4, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.GridSearchProposer": [[4, 2, 1, "", "feedback"], [4, 2, 1, "", "load"], [4, 2, 1, "", "propose"]], "torchrec.distributed.planner.proposers.UniformProposer": [[4, 2, 1, "", "feedback"], [4, 2, 1, "", "load"], [4, 2, 1, "", "propose"]], "torchrec.distributed.planner.shard_estimators": [[4, 1, 1, "", "EmbeddingPerfEstimator"], [4, 1, 1, "", "EmbeddingStorageEstimator"], [4, 3, 1, "", "calculate_shard_storages"], [4, 3, 1, "", "perf_func_emb_wall_time"]], "torchrec.distributed.planner.shard_estimators.EmbeddingPerfEstimator": [[4, 2, 1, "", "estimate"]], "torchrec.distributed.planner.shard_estimators.EmbeddingStorageEstimator": [[4, 2, 1, "", "estimate"]], "torchrec.distributed.planner.stats": [[4, 1, 1, "", "EmbeddingStats"]], "torchrec.distributed.planner.stats.EmbeddingStats": [[4, 2, 1, "", "log"]], "torchrec.distributed.planner.storage_reservations": [[4, 1, 1, "", "FixedPercentageReservation"], [4, 1, 1, "", "HeuristicalStorageReservation"], [4, 1, 1, "", "InferenceStorageReservation"]], "torchrec.distributed.planner.storage_reservations.FixedPercentageReservation": [[4, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.HeuristicalStorageReservation": [[4, 2, 1, "", "reserve"]], "torchrec.distributed.planner.storage_reservations.InferenceStorageReservation": [[4, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types": [[4, 1, 1, "", "DeviceHardware"], [4, 1, 1, "", "Enumerator"], [4, 1, 1, "", "ParameterConstraints"], [4, 1, 1, "", "PartitionByType"], [4, 1, 1, "", "Partitioner"], [4, 1, 1, "", "PerfModel"], [4, 6, 1, "", "PlannerError"], [4, 1, 1, "", "Proposer"], [4, 1, 1, "", "Shard"], [4, 1, 1, "", "ShardEstimator"], [4, 1, 1, "", "ShardingOption"], [4, 1, 1, "", "Stats"], [4, 1, 1, "", "Storage"], [4, 1, 1, "", "StorageReservation"], [4, 1, 1, "", "Topology"]], "torchrec.distributed.planner.types.DeviceHardware": [[4, 4, 1, "", "perf"], [4, 4, 1, "", "rank"], [4, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.Enumerator": [[4, 2, 1, "", "enumerate"]], "torchrec.distributed.planner.types.ParameterConstraints": [[4, 4, 1, "", "batch_sizes"], [4, 4, 1, "", "compute_kernels"], [4, 4, 1, "", "is_weighted"], [4, 4, 1, "", "min_partition"], [4, 4, 1, "", "num_poolings"], [4, 4, 1, "", "pooling_factors"], [4, 4, 1, "", "sharding_types"]], "torchrec.distributed.planner.types.PartitionByType": [[4, 4, 1, "", "DEVICE"], [4, 4, 1, "", "HOST"], [4, 4, 1, "", "UNIFORM"]], "torchrec.distributed.planner.types.Partitioner": [[4, 2, 1, "", "partition"]], "torchrec.distributed.planner.types.PerfModel": [[4, 2, 1, "", "rate"]], "torchrec.distributed.planner.types.Proposer": [[4, 2, 1, "", "feedback"], [4, 2, 1, "", "load"], [4, 2, 1, "", "propose"]], "torchrec.distributed.planner.types.Shard": [[4, 4, 1, "", "offset"], [4, 4, 1, "", "perf"], [4, 4, 1, "", "rank"], [4, 4, 1, "", "size"], [4, 4, 1, "", "storage"]], "torchrec.distributed.planner.types.ShardEstimator": [[4, 2, 1, "", "estimate"]], "torchrec.distributed.planner.types.ShardingOption": [[4, 4, 1, "", "batch_size"], [4, 4, 1, "", "compute_kernel"], [4, 4, 1, "", "dependency"], [4, 4, 1, "", "downstream_modules"], [4, 5, 1, "", "fqn"], [4, 4, 1, "", "input_lengths"], [4, 5, 1, "", "is_pooled"], [4, 4, 1, "", "module"], [4, 4, 1, "", "name"], [4, 5, 1, "", "num_inputs"], [4, 5, 1, "", "num_shards"], [4, 4, 1, "", "partition_by"], [4, 5, 1, "", "path"], [4, 4, 1, "", "sharding_type"], [4, 4, 1, "", "shards"], [4, 4, 1, "", "tensor"], [4, 5, 1, "", "total_storage"], [4, 4, 1, "", "upstream_modules"]], "torchrec.distributed.planner.types.Stats": [[4, 2, 1, "", "log"]], "torchrec.distributed.planner.types.Storage": [[4, 4, 1, "", "ddr"], [4, 2, 1, "", "fits_in"], [4, 4, 1, "", "hbm"]], "torchrec.distributed.planner.types.StorageReservation": [[4, 2, 1, "", "reserve"]], "torchrec.distributed.planner.types.Topology": [[4, 5, 1, "", "compute_device"], [4, 5, 1, "", "devices"], [4, 5, 1, "", "inter_host_bw"], [4, 5, 1, "", "intra_host_bw"], [4, 5, 1, "", "local_world_size"], [4, 5, 1, "", "world_size"]], "torchrec.distributed.planner.utils": [[4, 3, 1, "", "bytes_to_gb"], [4, 3, 1, "", "bytes_to_mb"], [4, 3, 1, "", "gb_to_bytes"], [4, 3, 1, "", "prod"], [4, 3, 1, "", "sharder_name"]], "torchrec.distributed.quant_embeddingbag": [[3, 1, 1, "", "QuantEmbeddingBagCollectionSharder"], [3, 1, 1, "", "ShardedQuantEmbeddingBagCollection"], [3, 3, 1, "", "create_infer_embedding_bag_sharding"]], "torchrec.distributed.quant_embeddingbag.QuantEmbeddingBagCollectionSharder": [[3, 5, 1, "", "module_type"], [3, 2, 1, "", "shard"], [3, 2, 1, "", "shardable_parameters"]], "torchrec.distributed.quant_embeddingbag.ShardedQuantEmbeddingBagCollection": [[3, 2, 1, "", "compute"], [3, 2, 1, "", "compute_and_output_dist"], [3, 2, 1, "", "copy"], [3, 2, 1, "", "input_dist"], [3, 2, 1, "", "output_dist"], [3, 5, 1, "", "shardings"], [3, 4, 1, "", "training"]], "torchrec.distributed.sharding": [[5, 0, 0, "-", "cw_sharding"], [5, 0, 0, "-", "dp_sharding"], [5, 0, 0, "-", "rw_sharding"], [5, 0, 0, "-", "tw_sharding"], [5, 0, 0, "-", "twcw_sharding"], [5, 0, 0, "-", "twrw_sharding"]], "torchrec.distributed.sharding.cw_sharding": [[5, 1, 1, "", "BaseCwEmbeddingSharding"], [5, 1, 1, "", "CwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.cw_sharding.BaseCwEmbeddingSharding": [[5, 2, 1, "", "embedding_dims"], [5, 2, 1, "", "embedding_names"]], "torchrec.distributed.sharding.cw_sharding.CwPooledEmbeddingSharding": [[5, 2, 1, "", "create_input_dist"], [5, 2, 1, "", "create_lookup"], [5, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding": [[5, 1, 1, "", "BaseDpEmbeddingSharding"], [5, 1, 1, "", "DpPooledEmbeddingDist"], [5, 1, 1, "", "DpPooledEmbeddingSharding"], [5, 1, 1, "", "DpSparseFeaturesDist"]], "torchrec.distributed.sharding.dp_sharding.BaseDpEmbeddingSharding": [[5, 2, 1, "", "embedding_dims"], [5, 2, 1, "", "embedding_names"], [5, 2, 1, "", "embedding_names_per_rank"], [5, 2, 1, "", "embedding_shard_metadata"], [5, 2, 1, "", "id_list_feature_names"], [5, 2, 1, "", "id_score_list_feature_names"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.dp_sharding.DpPooledEmbeddingSharding": [[5, 2, 1, "", "create_input_dist"], [5, 2, 1, "", "create_lookup"], [5, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.dp_sharding.DpSparseFeaturesDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding": [[5, 1, 1, "", "BaseRwEmbeddingSharding"], [5, 1, 1, "", "RwPooledEmbeddingDist"], [5, 1, 1, "", "RwPooledEmbeddingSharding"], [5, 1, 1, "", "RwSparseFeaturesDist"]], "torchrec.distributed.sharding.rw_sharding.BaseRwEmbeddingSharding": [[5, 2, 1, "", "embedding_dims"], [5, 2, 1, "", "embedding_names"], [5, 2, 1, "", "embedding_names_per_rank"], [5, 2, 1, "", "embedding_shard_metadata"], [5, 2, 1, "", "id_list_feature_names"], [5, 2, 1, "", "id_score_list_feature_names"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.rw_sharding.RwPooledEmbeddingSharding": [[5, 2, 1, "", "create_input_dist"], [5, 2, 1, "", "create_lookup"], [5, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.rw_sharding.RwSparseFeaturesDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding": [[5, 1, 1, "", "BaseTwEmbeddingSharding"], [5, 1, 1, "", "InferTwEmbeddingSharding"], [5, 1, 1, "", "InferTwPooledEmbeddingDist"], [5, 1, 1, "", "InferTwSparseFeaturesDist"], [5, 1, 1, "", "TwPooledEmbeddingDist"], [5, 1, 1, "", "TwPooledEmbeddingSharding"], [5, 1, 1, "", "TwSparseFeaturesDist"]], "torchrec.distributed.sharding.tw_sharding.BaseTwEmbeddingSharding": [[5, 2, 1, "", "embedding_dims"], [5, 2, 1, "", "embedding_names"], [5, 2, 1, "", "embedding_names_per_rank"], [5, 2, 1, "", "embedding_shard_metadata"], [5, 2, 1, "", "id_list_feature_names"], [5, 2, 1, "", "id_list_feature_names_per_rank"], [5, 2, 1, "", "id_list_features_per_rank"], [5, 2, 1, "", "id_score_list_feature_names"], [5, 2, 1, "", "id_score_list_feature_names_per_rank"], [5, 2, 1, "", "id_score_list_features_per_rank"]], "torchrec.distributed.sharding.tw_sharding.InferTwEmbeddingSharding": [[5, 2, 1, "", "create_input_dist"], [5, 2, 1, "", "create_lookup"], [5, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.InferTwPooledEmbeddingDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.InferTwSparseFeaturesDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.tw_sharding.TwPooledEmbeddingSharding": [[5, 2, 1, "", "create_input_dist"], [5, 2, 1, "", "create_lookup"], [5, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.tw_sharding.TwSparseFeaturesDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.twcw_sharding": [[5, 1, 1, "", "TwCwPooledEmbeddingSharding"]], "torchrec.distributed.sharding.twrw_sharding": [[5, 1, 1, "", "BaseTwRwEmbeddingSharding"], [5, 1, 1, "", "TwRwPooledEmbeddingDist"], [5, 1, 1, "", "TwRwPooledEmbeddingSharding"], [5, 1, 1, "", "TwRwSparseFeaturesDist"]], "torchrec.distributed.sharding.twrw_sharding.BaseTwRwEmbeddingSharding": [[5, 2, 1, "", "embedding_dims"], [5, 2, 1, "", "embedding_names"], [5, 2, 1, "", "embedding_names_per_rank"], [5, 2, 1, "", "embedding_shard_metadata"], [5, 2, 1, "", "id_list_feature_names"], [5, 2, 1, "", "id_score_list_feature_names"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.sharding.twrw_sharding.TwRwPooledEmbeddingSharding": [[5, 2, 1, "", "create_input_dist"], [5, 2, 1, "", "create_lookup"], [5, 2, 1, "", "create_output_dist"]], "torchrec.distributed.sharding.twrw_sharding.TwRwSparseFeaturesDist": [[5, 2, 1, "", "forward"], [5, 4, 1, "", "training"]], "torchrec.distributed.train_pipeline": [[3, 1, 1, "", "ArgInfo"], [3, 1, 1, "", "PipelinedForward"], [3, 1, 1, "", "Tracer"], [3, 1, 1, "", "TrainPipeline"], [3, 1, 1, "", "TrainPipelineBase"], [3, 1, 1, "", "TrainPipelineContext"], [3, 1, 1, "", "TrainPipelineSparseDist"]], "torchrec.distributed.train_pipeline.ArgInfo": [[3, 4, 1, "", "input_attrs"], [3, 4, 1, "", "is_getitems"], [3, 4, 1, "", "name"]], "torchrec.distributed.train_pipeline.PipelinedForward": [[3, 5, 1, "", "args"], [3, 5, 1, "", "name"]], "torchrec.distributed.train_pipeline.Tracer": [[3, 4, 1, "", "graph"], [3, 2, 1, "", "is_leaf_module"], [3, 4, 1, "", "proxy_buffer_attributes"]], "torchrec.distributed.train_pipeline.TrainPipeline": [[3, 2, 1, "", "progress"]], "torchrec.distributed.train_pipeline.TrainPipelineBase": [[3, 2, 1, "", "progress"]], "torchrec.distributed.train_pipeline.TrainPipelineContext": [[3, 4, 1, "", "feature_processor_forwards"], [3, 4, 1, "", "input_dist_requests"], [3, 4, 1, "", "module_contexts"]], "torchrec.distributed.train_pipeline.TrainPipelineSparseDist": [[3, 2, 1, "", "progress"]], "torchrec.distributed.types": [[3, 1, 1, "", "Awaitable"], [3, 1, 1, "", "CommOp"], [3, 1, 1, "", "ComputeKernel"], [3, 1, 1, "", "EmptyContext"], [3, 1, 1, "", "FeatureShardingMixIn"], [3, 1, 1, "", "GenericMeta"], [3, 1, 1, "", "LazyAwaitable"], [3, 1, 1, "", "LazyNoWait"], [3, 1, 1, "", "ModuleCopyMixin"], [3, 1, 1, "", "ModuleSharder"], [3, 1, 1, "", "ModuleShardingMixIn"], [3, 1, 1, "", "NoOpQuantizedCommCodec"], [3, 1, 1, "", "NoWait"], [3, 1, 1, "", "ParameterSharding"], [3, 1, 1, "", "ParameterStorage"], [3, 1, 1, "", "QuantizedCommCodec"], [3, 1, 1, "", "QuantizedCommCodecs"], [3, 1, 1, "", "ShardedModule"], [3, 1, 1, "", "ShardedModuleContext"], [3, 1, 1, "", "ShardingEnv"], [3, 1, 1, "", "ShardingPlan"], [3, 1, 1, "", "ShardingPlanner"], [3, 1, 1, "", "ShardingType"], [3, 3, 1, "", "scope"]], "torchrec.distributed.types.Awaitable": [[3, 5, 1, "", "callbacks"], [3, 2, 1, "", "wait"]], "torchrec.distributed.types.CommOp": [[3, 4, 1, "", "POOLED_EMBEDDINGS_ALL_TO_ALL"], [3, 4, 1, "", "POOLED_EMBEDDINGS_REDUCE_SCATTER"], [3, 4, 1, "", "SEQUENCE_EMBEDDINGS_ALL_TO_ALL"]], "torchrec.distributed.types.ComputeKernel": [[3, 4, 1, "", "DEFAULT"]], "torchrec.distributed.types.EmptyContext": [[3, 2, 1, "", "record_stream"]], "torchrec.distributed.types.FeatureShardingMixIn": [[3, 2, 1, "", "id_list_feature_names"], [3, 2, 1, "", "id_list_feature_names_per_rank"], [3, 2, 1, "", "id_list_features_per_rank"], [3, 2, 1, "", "id_score_list_feature_names"], [3, 2, 1, "", "id_score_list_feature_names_per_rank"], [3, 2, 1, "", "id_score_list_features_per_rank"]], "torchrec.distributed.types.ModuleCopyMixin": [[3, 2, 1, "", "copy"]], "torchrec.distributed.types.ModuleSharder": [[3, 2, 1, "", "compute_kernels"], [3, 5, 1, "", "module_type"], [3, 5, 1, "", "qcomm_codecs_registry"], [3, 2, 1, "", "shard"], [3, 2, 1, "", "shardable_parameters"], [3, 2, 1, "", "sharding_types"], [3, 2, 1, "", "storage_usage"]], "torchrec.distributed.types.ModuleShardingMixIn": [[3, 5, 1, "", "shardings"]], "torchrec.distributed.types.NoOpQuantizedCommCodec": [[3, 2, 1, "", "decode"], [3, 2, 1, "", "encode"], [3, 2, 1, "", "quantized_dtype"]], "torchrec.distributed.types.ParameterSharding": [[3, 4, 1, "", "compute_kernel"], [3, 4, 1, "", "ranks"], [3, 4, 1, "", "sharding_spec"], [3, 4, 1, "", "sharding_type"]], "torchrec.distributed.types.ParameterStorage": [[3, 4, 1, "", "DDR"], [3, 4, 1, "", "HBM"]], "torchrec.distributed.types.QuantizedCommCodec": [[3, 2, 1, "", "decode"], [3, 2, 1, "", "encode"], [3, 2, 1, "", "quantized_dtype"]], "torchrec.distributed.types.QuantizedCommCodecs": [[3, 4, 1, "", "backward"], [3, 4, 1, "", "forward"]], "torchrec.distributed.types.ShardedModule": [[3, 2, 1, "", "compute"], [3, 2, 1, "", "compute_and_output_dist"], [3, 2, 1, "", "create_context"], [3, 2, 1, "", "forward"], [3, 2, 1, "", "input_dist"], [3, 2, 1, "", "output_dist"], [3, 5, 1, "", "qcomm_codecs_registry"], [3, 2, 1, "", "sharded_parameter_names"], [3, 2, 1, "", "sparse_grad_parameter_names"], [3, 4, 1, "", "training"]], "torchrec.distributed.types.ShardingEnv": [[3, 2, 1, "", "from_local"], [3, 2, 1, "", "from_process_group"]], "torchrec.distributed.types.ShardingPlan": [[3, 2, 1, "", "get_plan_for_module"], [3, 4, 1, "id22", "plan"]], "torchrec.distributed.types.ShardingPlanner": [[3, 2, 1, "", "collective_plan"], [3, 2, 1, "", "plan"]], "torchrec.distributed.types.ShardingType": [[3, 4, 1, "", "COLUMN_WISE"], [3, 4, 1, "", "DATA_PARALLEL"], [3, 4, 1, "", "ROW_WISE"], [3, 4, 1, "", "TABLE_COLUMN_WISE"], [3, 4, 1, "", "TABLE_ROW_WISE"], [3, 4, 1, "", "TABLE_WISE"]], "torchrec.distributed.utils": [[3, 3, 1, "", "add_prefix_to_state_dict"], [3, 3, 1, "", "append_prefix"], [3, 3, 1, "", "filter_state_dict"], [3, 3, 1, "", "get_unsharded_module_names"], [3, 3, 1, "", "merge_fused_params"], [3, 3, 1, "", "optimizer_type_to_emb_opt_type"], [3, 1, 1, "", "sharded_model_copy"]], "torchrec.fx": [[6, 0, 0, "-", "tracer"]], "torchrec.fx.tracer": [[6, 1, 1, "", "Tracer"], [6, 3, 1, "", "is_fx_tracing"], [6, 3, 1, "", "symbolic_trace"]], "torchrec.fx.tracer.Tracer": [[6, 2, 1, "", "create_arg"], [6, 4, 1, "", "graph"], [6, 2, 1, "", "trace"]], "torchrec.inference": [[7, 0, 0, "-", "model_packager"], [7, 0, 0, "-", "modules"]], "torchrec.inference.model_packager": [[7, 1, 1, "", "PredictFactoryPackager"], [7, 3, 1, "", "load_config_text"], [7, 3, 1, "", "load_pickle_config"]], "torchrec.inference.model_packager.PredictFactoryPackager": [[7, 2, 1, "", "save_predict_factory"], [7, 2, 1, "", "set_extern_modules"], [7, 2, 1, "", "set_mocked_modules"]], "torchrec.inference.modules": [[7, 1, 1, "", "BatchingMetadata"], [7, 1, 1, "", "PredictFactory"], [7, 1, 1, "", "PredictModule"], [7, 1, 1, "", "QualNameMetadata"], [7, 3, 1, "", "quantize_dense"], [7, 3, 1, "", "quantize_embeddings"], [7, 3, 1, "", "quantize_feature"]], "torchrec.inference.modules.BatchingMetadata": [[7, 4, 1, "", "device"], [7, 4, 1, "", "pinned"], [7, 4, 1, "", "type"]], "torchrec.inference.modules.PredictFactory": [[7, 2, 1, "", "batching_metadata"], [7, 2, 1, "", "batching_metadata_json"], [7, 2, 1, "", "create_predict_module"], [7, 2, 1, "", "qualname_metadata"], [7, 2, 1, "", "result_metadata"], [7, 2, 1, "", "run_weights_dependent_transformations"], [7, 2, 1, "", "run_weights_independent_tranformations"]], "torchrec.inference.modules.PredictModule": [[7, 2, 1, "", "forward"], [7, 2, 1, "", "predict_forward"], [7, 5, 1, "", "predict_module"], [7, 2, 1, "", "state_dict"], [7, 4, 1, "", "training"]], "torchrec.inference.modules.QualNameMetadata": [[7, 4, 1, "", "need_preproc"]], "torchrec.models": [[8, 0, 0, "-", "deepfm"], [8, 0, 0, "-", "dlrm"]], "torchrec.models.deepfm": [[8, 1, 1, "", "DenseArch"], [8, 1, 1, "", "FMInteractionArch"], [8, 1, 1, "", "OverArch"], [8, 1, 1, "", "SimpleDeepFMNN"], [8, 1, 1, "", "SparseArch"]], "torchrec.models.deepfm.DenseArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.deepfm.FMInteractionArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.deepfm.OverArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.deepfm.SimpleDeepFMNN": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.deepfm.SparseArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm": [[8, 1, 1, "", "DLRM"], [8, 1, 1, "", "DLRMTrain"], [8, 1, 1, "", "DLRM_DCN"], [8, 1, 1, "", "DLRM_Projection"], [8, 1, 1, "", "DenseArch"], [8, 1, 1, "", "InteractionArch"], [8, 1, 1, "", "InteractionDCNArch"], [8, 1, 1, "", "InteractionProjectionArch"], [8, 1, 1, "", "OverArch"], [8, 1, 1, "", "SparseArch"], [8, 3, 1, "", "choose"]], "torchrec.models.dlrm.DLRM": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRMTrain": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_DCN": [[8, 4, 1, "", "sparse_arch"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.DLRM_Projection": [[8, 4, 1, "", "sparse_arch"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.DenseArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionDCNArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.InteractionProjectionArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.OverArch": [[8, 2, 1, "", "forward"], [8, 4, 1, "", "training"]], "torchrec.models.dlrm.SparseArch": [[8, 2, 1, "", "forward"], [8, 5, 1, "", "sparse_feature_names"], [8, 4, 1, "", "training"]], "torchrec.modules": [[9, 0, 0, "-", "activation"], [9, 0, 0, "-", "crossnet"], [9, 0, 0, "-", "deepfm"], [9, 0, 0, "-", "embedding_configs"], [9, 0, 0, "-", "embedding_modules"], [9, 0, 0, "-", "feature_processor"], [9, 0, 0, "-", "lazy_extension"], [9, 0, 0, "-", "mlp"], [9, 0, 0, "-", "utils"]], "torchrec.modules.activation": [[9, 1, 1, "", "SwishLayerNorm"]], "torchrec.modules.activation.SwishLayerNorm": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.crossnet": [[9, 1, 1, "", "CrossNet"], [9, 1, 1, "", "LowRankCrossNet"], [9, 1, 1, "", "LowRankMixtureCrossNet"], [9, 1, 1, "", "VectorCrossNet"]], "torchrec.modules.crossnet.CrossNet": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankCrossNet": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.crossnet.LowRankMixtureCrossNet": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.crossnet.VectorCrossNet": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.deepfm": [[9, 1, 1, "", "DeepFM"], [9, 1, 1, "", "FactorizationMachine"]], "torchrec.modules.deepfm.DeepFM": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.deepfm.FactorizationMachine": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.embedding_configs": [[9, 1, 1, "", "BaseEmbeddingConfig"], [9, 1, 1, "", "DataType"], [9, 1, 1, "", "EmbeddingBagConfig"], [9, 1, 1, "", "EmbeddingConfig"], [9, 1, 1, "", "EmbeddingTableConfig"], [9, 1, 1, "", "PoolingType"], [9, 3, 1, "", "data_type_to_dtype"], [9, 3, 1, "", "data_type_to_sparse_type"], [9, 3, 1, "", "dtype_to_data_type"], [9, 3, 1, "", "pooling_type_to_pooling_mode"], [9, 3, 1, "", "pooling_type_to_str"]], "torchrec.modules.embedding_configs.BaseEmbeddingConfig": [[9, 4, 1, "", "data_type"], [9, 4, 1, "", "embedding_dim"], [9, 4, 1, "", "feature_names"], [9, 2, 1, "", "get_weight_init_max"], [9, 2, 1, "", "get_weight_init_min"], [9, 4, 1, "", "name"], [9, 4, 1, "", "need_pos"], [9, 4, 1, "", "num_embeddings"], [9, 2, 1, "", "num_features"], [9, 4, 1, "", "weight_init_max"], [9, 4, 1, "", "weight_init_min"]], "torchrec.modules.embedding_configs.DataType": [[9, 4, 1, "", "FP16"], [9, 4, 1, "", "FP32"], [9, 4, 1, "", "INT2"], [9, 4, 1, "", "INT4"], [9, 4, 1, "", "INT8"]], "torchrec.modules.embedding_configs.EmbeddingBagConfig": [[9, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.EmbeddingConfig": [[9, 4, 1, "", "embedding_dim"], [9, 4, 1, "", "feature_names"], [9, 4, 1, "", "num_embeddings"]], "torchrec.modules.embedding_configs.EmbeddingTableConfig": [[9, 4, 1, "", "embedding_names"], [9, 4, 1, "", "has_feature_processor"], [9, 4, 1, "", "is_weighted"], [9, 4, 1, "", "pooling"]], "torchrec.modules.embedding_configs.PoolingType": [[9, 4, 1, "", "MEAN"], [9, 4, 1, "", "NONE"], [9, 4, 1, "", "SUM"]], "torchrec.modules.embedding_modules": [[9, 1, 1, "", "EmbeddingBagCollection"], [9, 1, 1, "", "EmbeddingBagCollectionInterface"], [9, 1, 1, "", "EmbeddingCollection"], [9, 1, 1, "", "EmbeddingCollectionInterface"], [9, 3, 1, "", "get_embedding_names_by_table"]], "torchrec.modules.embedding_modules.EmbeddingBagCollection": [[9, 2, 1, "", "embedding_bag_configs"], [9, 2, 1, "", "forward"], [9, 2, 1, "", "is_weighted"], [9, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingBagCollectionInterface": [[9, 2, 1, "", "embedding_bag_configs"], [9, 2, 1, "", "forward"], [9, 2, 1, "", "is_weighted"], [9, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollection": [[9, 2, 1, "", "embedding_configs"], [9, 2, 1, "", "embedding_dim"], [9, 2, 1, "", "embedding_names_by_table"], [9, 2, 1, "", "forward"], [9, 2, 1, "", "need_indices"], [9, 4, 1, "", "training"]], "torchrec.modules.embedding_modules.EmbeddingCollectionInterface": [[9, 2, 1, "", "embedding_configs"], [9, 2, 1, "", "embedding_dim"], [9, 2, 1, "", "embedding_names_by_table"], [9, 2, 1, "", "forward"], [9, 2, 1, "", "need_indices"], [9, 4, 1, "", "training"]], "torchrec.modules.feature_processor": [[9, 1, 1, "", "BaseFeatureProcessor"], [9, 1, 1, "", "BaseGroupedFeatureProcessor"], [9, 1, 1, "", "PositionWeightedModule"], [9, 1, 1, "", "PositionWeightedProcessor"]], "torchrec.modules.feature_processor.BaseFeatureProcessor": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.feature_processor.BaseGroupedFeatureProcessor": [[9, 2, 1, "", "forward"], [9, 2, 1, "", "sparse_grad_parameter_names"], [9, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedModule": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.feature_processor.PositionWeightedProcessor": [[9, 2, 1, "", "forward"], [9, 2, 1, "", "named_buffers"], [9, 2, 1, "", "sparse_grad_parameter_names"], [9, 2, 1, "", "state_dict"], [9, 4, 1, "", "training"]], "torchrec.modules.lazy_extension": [[9, 1, 1, "", "LazyModuleExtensionMixin"], [9, 3, 1, "", "lazy_apply"]], "torchrec.modules.lazy_extension.LazyModuleExtensionMixin": [[9, 2, 1, "", "apply"]], "torchrec.modules.mlp": [[9, 1, 1, "", "MLP"], [9, 1, 1, "", "Perceptron"]], "torchrec.modules.mlp.MLP": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.mlp.Perceptron": [[9, 2, 1, "", "forward"], [9, 4, 1, "", "training"]], "torchrec.modules.utils": [[9, 3, 1, "", "check_module_output_dimension"], [9, 3, 1, "", "construct_modulelist_from_single_module"], [9, 3, 1, "", "convert_list_of_modules_to_modulelist"], [9, 3, 1, "", "extract_module_or_tensor_callable"], [9, 3, 1, "", "get_module_output_dimension"], [9, 3, 1, "", "init_mlp_weights_xavier_uniform"]], "torchrec.optim": [[10, 0, 0, "-", "clipping"], [10, 0, 0, "-", "fused"], [10, 0, 0, "-", "keyed"], [10, 0, 0, "-", "warmup"]], "torchrec.optim.clipping": [[10, 1, 1, "", "GradientClipping"], [10, 1, 1, "", "GradientClippingOptimizer"]], "torchrec.optim.clipping.GradientClipping": [[10, 4, 1, "", "NONE"], [10, 4, 1, "", "NORM"], [10, 4, 1, "", "VALUE"]], "torchrec.optim.clipping.GradientClippingOptimizer": [[10, 2, 1, "", "step"]], "torchrec.optim.fused": [[10, 1, 1, "", "FusedOptimizer"], [10, 1, 1, "", "FusedOptimizerModule"]], "torchrec.optim.fused.FusedOptimizer": [[10, 2, 1, "", "step"], [10, 2, 1, "", "zero_grad"]], "torchrec.optim.fused.FusedOptimizerModule": [[10, 5, 1, "", "fused_optimizer"]], "torchrec.optim.keyed": [[10, 1, 1, "", "CombinedOptimizer"], [10, 1, 1, "", "KeyedOptimizer"], [10, 1, 1, "", "KeyedOptimizerWrapper"], [10, 1, 1, "", "OptimizerWrapper"]], "torchrec.optim.keyed.CombinedOptimizer": [[10, 5, 1, "", "optimizers"], [10, 5, 1, "", "param_groups"], [10, 5, 1, "", "params"], [10, 2, 1, "", "post_load_state_dict"], [10, 2, 1, "", "prepend_opt_key"], [10, 2, 1, "", "save_param_groups"], [10, 5, 1, "", "state"], [10, 2, 1, "", "step"], [10, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.KeyedOptimizer": [[10, 2, 1, "", "add_param_group"], [10, 2, 1, "", "init_state"], [10, 2, 1, "", "load_state_dict"], [10, 2, 1, "", "post_load_state_dict"], [10, 2, 1, "", "save_param_groups"], [10, 2, 1, "", "state_dict"]], "torchrec.optim.keyed.KeyedOptimizerWrapper": [[10, 2, 1, "", "step"], [10, 2, 1, "", "zero_grad"]], "torchrec.optim.keyed.OptimizerWrapper": [[10, 2, 1, "", "add_param_group"], [10, 2, 1, "", "load_state_dict"], [10, 2, 1, "", "post_load_state_dict"], [10, 2, 1, "", "save_param_groups"], [10, 2, 1, "", "state_dict"], [10, 2, 1, "", "step"], [10, 2, 1, "", "zero_grad"]], "torchrec.optim.warmup": [[10, 1, 1, "", "WarmupOptimizer"], [10, 1, 1, "", "WarmupPolicy"], [10, 1, 1, "", "WarmupStage"]], "torchrec.optim.warmup.WarmupOptimizer": [[10, 2, 1, "", "post_load_state_dict"], [10, 2, 1, "", "step"]], "torchrec.optim.warmup.WarmupPolicy": [[10, 4, 1, "", "CONSTANT"], [10, 4, 1, "", "INVSQRT"], [10, 4, 1, "", "LINEAR"], [10, 4, 1, "", "NONE"], [10, 4, 1, "", "POLY"], [10, 4, 1, "", "STEP"]], "torchrec.optim.warmup.WarmupStage": [[10, 4, 1, "", "decay_iters"], [10, 4, 1, "", "lr_scale"], [10, 4, 1, "", "max_iters"], [10, 4, 1, "", "policy"], [10, 4, 1, "", "value"]], "torchrec.quant": [[11, 0, 0, "-", "embedding_modules"]], "torchrec.quant.embedding_modules": [[11, 1, 1, "", "EmbeddingBagCollection"], [11, 1, 1, "", "EmbeddingCollection"], [11, 3, 1, "", "quantize_state_dict"]], "torchrec.quant.embedding_modules.EmbeddingBagCollection": [[11, 2, 1, "", "embedding_bag_configs"], [11, 2, 1, "", "forward"], [11, 2, 1, "", "from_float"], [11, 2, 1, "", "is_weighted"], [11, 2, 1, "", "output_dtype"], [11, 4, 1, "", "training"]], "torchrec.quant.embedding_modules.EmbeddingCollection": [[11, 2, 1, "", "embedding_configs"], [11, 2, 1, "", "embedding_dim"], [11, 2, 1, "", "embedding_names_by_table"], [11, 2, 1, "", "forward"], [11, 2, 1, "", "from_float"], [11, 2, 1, "", "need_indices"], [11, 2, 1, "", "output_dtype"], [11, 2, 1, "", "state_dict"], [11, 4, 1, "", "training"]], "torchrec.sparse": [[12, 0, 0, "-", "jagged_tensor"]], "torchrec.sparse.jagged_tensor": [[12, 1, 1, "", "JaggedTensor"], [12, 1, 1, "", "JaggedTensorMeta"], [12, 1, 1, "", "KeyedJaggedTensor"], [12, 1, 1, "", "KeyedTensor"]], "torchrec.sparse.jagged_tensor.JaggedTensor": [[12, 2, 1, "", "empty"], [12, 2, 1, "", "from_dense"], [12, 2, 1, "", "from_dense_lengths"], [12, 2, 1, "", "lengths"], [12, 2, 1, "", "lengths_or_none"], [12, 2, 1, "", "offsets"], [12, 2, 1, "", "offsets_or_none"], [12, 2, 1, "", "record_stream"], [12, 2, 1, "", "to"], [12, 2, 1, "", "to_dense"], [12, 2, 1, "", "to_padded_dense"], [12, 2, 1, "", "values"], [12, 2, 1, "", "weights"], [12, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedJaggedTensor": [[12, 2, 1, "", "concat"], [12, 2, 1, "", "device"], [12, 2, 1, "", "empty"], [12, 2, 1, "", "empty_like"], [12, 2, 1, "", "from_lengths_sync"], [12, 2, 1, "", "from_offsets_sync"], [12, 2, 1, "", "keys"], [12, 2, 1, "", "length_per_key"], [12, 2, 1, "", "length_per_key_or_none"], [12, 2, 1, "", "lengths"], [12, 2, 1, "", "lengths_or_none"], [12, 2, 1, "", "offset_per_key"], [12, 2, 1, "", "offset_per_key_or_none"], [12, 2, 1, "", "offsets"], [12, 2, 1, "", "offsets_or_none"], [12, 2, 1, "", "permute"], [12, 2, 1, "", "pin_memory"], [12, 2, 1, "", "record_stream"], [12, 2, 1, "", "split"], [12, 2, 1, "", "stride"], [12, 2, 1, "", "sync"], [12, 2, 1, "", "to"], [12, 2, 1, "", "to_dict"], [12, 2, 1, "", "values"], [12, 2, 1, "", "weights"], [12, 2, 1, "", "weights_or_none"]], "torchrec.sparse.jagged_tensor.KeyedTensor": [[12, 2, 1, "", "from_tensor_list"], [12, 2, 1, "", "key_dim"], [12, 2, 1, "", "keys"], [12, 2, 1, "", "length_per_key"], [12, 2, 1, "", "offset_per_key"], [12, 2, 1, "", "record_stream"], [12, 2, 1, "", "regroup"], [12, 2, 1, "", "regroup_as_dict"], [12, 2, 1, "", "to"], [12, 2, 1, "", "to_dict"], [12, 2, 1, "", "values"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute", "5": "py:property", "6": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"], "5": ["py", "property", "Python property"], "6": ["py", "exception", "Python exception"]}, "titleterms": {"welcom": 0, "torchrec": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "document": 0, "tutori": 0, "api": 0, "content": [0, 6, 7, 8, 9, 10, 11, 12], "indic": 0, "tabl": 0, "dataset": [1, 2], "criteo": 1, "movielen": 1, "random": 1, "util": [1, 3, 4, 9], "script": 2, "contiguous_preproc_criteo": 2, "npy_preproc_criteo": 2, "distribut": [3, 4, 5], "collective_util": 3, "comm": 3, "comm_op": 3, "dist_data": [3, 5], "embed": 3, "embedding_lookup": 3, "embedding_shard": 3, "embedding_typ": 3, "embeddingbag": 3, "grouped_position_weight": 3, "model_parallel": 3, "quant_embeddingbag": 3, "train_pipelin": 3, "type": [3, 4], "planner": 4, "constant": 4, "enumer": 4, "partition": 4, "perf_model": 4, "propos": 4, "shard_estim": 4, "stat": 4, "storage_reserv": 4, "shard": 5, "cw_shard": 5, "dp_shard": 5, "rw_shard": 5, "tw_shard": 5, "twcw_shard": 5, "twrw_shard": 5, "fx": 6, "tracer": 6, "modul": [6, 7, 8, 9, 10, 11, 12], "infer": 7, "model_packag": 7, "model": 8, "deepfm": [8, 9], "dlrm": 8, "activ": 9, "crossnet": 9, "embedding_config": 9, "embedding_modul": [9, 11], "feature_processor": 9, "lazy_extens": 9, "mlp": 9, "optim": 10, "clip": 10, "fuse": 10, "kei": 10, "warmup": 10, "quant": 11, "spars": 12, "jagged_tensor": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})